var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);n.prototype=t.prototype,e.prototype=new n},__awaiter=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(i,a){function r(e){try{c(o.next(e))}catch(t){a(t)}}function s(e){try{c(o["throw"](e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(r,s)}c((o=o.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function n(e){return function(t){return o([e,t])}}function o(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,a&&(r=a[2&n[0]?"return":n[0]?"throw":"next"])&&!(r=r.call(a,n[1])).done)return r;switch(a=0,r&&(n=[0,r.value]),n[0]){case 0:case 1:r=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,a=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(r=c.trys,!(r=r.length>0&&r[r.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!r||n[1]>r[0]&&n[1]<r[3])){c.label=n[1];break}if(6===n[0]&&c.label<r[1]){c.label=r[1],r=n;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(n);break}r[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(o){n=[6,o],a=0}finally{i=r=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,a,r,s,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},game;!function(e){var t=function(){function e(){}return e.ServiceEndpoint="https://tk2048-test.herokuapp.com/",e.Endpoint="https://tk2048-test.herokuapp.com/miniGame/",e.Endpoints={photonMasterServer:"192.168.2.202:9090"},e.photonMasterServer="",e}();e.Constants=t,__reflect(t.prototype,"game.Constants")}(game||(game={}));var game;!function(e){var t=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.container.visible=!1},t.prototype.show=function(){this.container.verticalCenter=-700,this.container.visible=!0,egret.Tween.get(this.container).to({verticalCenter:0},500,egret.Ease.backOut)},t.prototype.onCloseButtonClick=function(t){e.prototype.onCloseButtonClick.call(this,t),this.close()},t.prototype.close=function(){this.parent&&this.parent.removeChild(this)},t}(eui.Panel);e.BasePanel=t,__reflect(t.prototype,"game.BasePanel")}(game||(game={}));var game;!function(e){var t=function(t){function n(e){var o=t.call(this,n.NAME,e)||this;return t.prototype.initializeNotifier.call(o,"ApplicationFacade"),console.log("GameScreen initData:"),o.initData(),o.findSeat(),o}return __extends(n,t),n.prototype.initData=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return this.proxy=this.facade().retrieveProxy(e.GameProxy.NAME),this.gameScreen.roomName=this.proxy.roomName,this.gameScreen.isMasterClient=this.proxy.isMasterClient,this.gameScreen.isNormalClient=!this.proxy.isMasterClient,this.updateGameScreen(this.proxy.gameState),[2]})})},n.prototype.listNotificationInterests=function(){return[e.GameProxy.PLAYER_UPDATE,e.GameProxy.SEAT_UPDATE,e.GameProxy.START_JS,e.GameProxy.CHOOSE_JS_END,e.GameProxy.START_GAME,e.GameProxy.FIRST_ONE]},n.prototype.handleNotification=function(t){var n=t.getBody();switch(t.getName()){case e.GameProxy.PLAYER_UPDATE:this.updateGameScreen(n);break;case e.GameProxy.SEAT_UPDATE:this.touxiang(n);break;case e.GameProxy.START_JS:this.startjschoose();break;case e.GameProxy.CHOOSE_JS_END:this.choosejsend(n);break;case e.GameProxy.START_GAME:this.startgame2();break;case e.GameProxy.FIRST_ONE:this.first_one(n)}},n.prototype.updateGameScreen=function(t){var n=this;this.gameScreen.currentPlayers=t.players,this.gameScreen.maxPlayers=t.maxPlayers;var o=this.proxy.gameState.seats.length==t.maxPlayers&&this.proxy.gameState.seats.every(function(e){return void 0!==e.actorNr}),i=!o&&this.proxy.gameState.seats.some(function(e){return e.actorNr==n.proxy.actorNr});switch(t.phase){case e.GamePhase.Preparing:this.gameScreen.isInitial=!i&&!o,this.gameScreen.isWaiting=i,this.gameScreen.isAllReady=o;break;case e.GamePhase.Ready:this.gameScreen.isInitial=!1,this.gameScreen.isWaiting=!1,this.gameScreen.isAllReady=!1;break;case e.GamePhase.Input:this.gameScreen.isInitial=!1,this.gameScreen.isWaiting=!1,this.gameScreen.isAllReady=!1}},Object.defineProperty(n.prototype,"gameScreen",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),n.prototype.findSeat=function(){var e=this;this.gameScreen.btnSeat1.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.findSeat2("1")},this),this.gameScreen.btnSeat2.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.findSeat2("2")},this),this.gameScreen.btnSeat3.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.findSeat2("3")},this),this.gameScreen.btnSeat4.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.findSeat2("4")},this),this.gameScreen.btnSeat5.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.findSeat2("5")},this),this.gameScreen.btnSeat6.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.findSeat2("6")},this),this.gameScreen.btnSeat7.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.findSeat2("7")},this),this.gameScreen.btnSeat8.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.findSeat2("8")},this),this.gameScreen.startjs.addEventListener(egret.TouchEvent.TOUCH_TAP,this.startjschoose2,this),this.gameScreen.btnjs1.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.choosejs("1")},this),this.gameScreen.btnjs2.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.choosejs("2")},this),this.gameScreen.btnjs3.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.choosejs("3")},this),this.gameScreen.btnjs4.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.choosejs("4")},this),this.gameScreen.btnjs5.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.choosejs("5")},this),this.gameScreen.btnjs6.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.choosejs("6")},this),this.gameScreen.btnjs7.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.choosejs("7")},this),this.gameScreen.btnjs8.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.choosejs("8")},this),this.gameScreen.startgame.addEventListener(egret.TouchEvent.TOUCH_TAP,this.startgame,this),this.gameScreen.Anim1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.chooseAnim,this),this.gameScreen.Anim2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.chooseAnim,this),this.gameScreen.Anim3.addEventListener(egret.TouchEvent.TOUCH_TAP,this.chooseAnim,this),this.gameScreen.Anim4.addEventListener(egret.TouchEvent.TOUCH_TAP,this.chooseAnim,this),this.gameScreen.shunwei1.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.shunwei("1")},this),this.gameScreen.shunwei2.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.shunwei("2")},this),this.gameScreen.shunwei3.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.shunwei("3")},this),this.gameScreen.shunwei4.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.shunwei("4")},this),this.gameScreen.shunwei5.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.shunwei("5")},this),this.gameScreen.shunwei6.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.shunwei("6")},this),this.gameScreen.shunwei7.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.shunwei("7")},this),this.gameScreen.shunwei8.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.shunwei("8")},this)},n.prototype.findSeat2=function(t){var n=this;if(this.proxy.gameState.seats[t]);else{var o=this.proxy.gameState.seats.findIndex(function(e){return e==n.proxy.loadBalancingClient.myActor()});-1==o||this.sendNotification(e.GameCommand.JOIN_SEAT,"destory"+o),this.sendNotification(e.GameCommand.JOIN_SEAT,t)}},n.prototype.touxiang=function(e){var t=0,n=0,o=0,i=0,a=0,r=0,s=0,c=0,p=0;if(e[1]){var u=this.gameScreen.btnSeat1.getChildAt(2);u.source="resource/assets/seat/color-black.png",u.visible=!0,n=1}else{var u=this.gameScreen.btnSeat1.getChildAt(2);u.visible=!1,n=0}if(e[2]){var u=this.gameScreen.btnSeat2.getChildAt(2);u.source="resource/assets/seat/color-blue.png",u.visible=!0,o=1}else{var u=this.gameScreen.btnSeat2.getChildAt(2);u.visible=!1,o=0}if(e[3]){var u=this.gameScreen.btnSeat3.getChildAt(2);u.source="resource/assets/seat/color-green.png",u.visible=!0,i=1}else{var u=this.gameScreen.btnSeat3.getChildAt(2);u.visible=!1,i=0}if(e[4]){var u=this.gameScreen.btnSeat4.getChildAt(2);u.source="resource/assets/seat/color-orange.png",u.visible=!0,a=1}else{var u=this.gameScreen.btnSeat4.getChildAt(2);u.visible=!1,a=0}if(e[5]){var u=this.gameScreen.btnSeat5.getChildAt(2);u.source="resource/assets/seat/color-purple.png",u.visible=!0,r=1}else{var u=this.gameScreen.btnSeat5.getChildAt(2);u.visible=!1,r=0}if(e[6]){var u=this.gameScreen.btnSeat6.getChildAt(2);u.source="resource/assets/seat/color-red.png",u.visible=!0,s=1}else{var u=this.gameScreen.btnSeat6.getChildAt(2);u.visible=!1,s=0}if(e[7]){var u=this.gameScreen.btnSeat7.getChildAt(2);u.source="resource/assets/seat/color-white.png",u.visible=!0,c=1}else{var u=this.gameScreen.btnSeat7.getChildAt(2);u.visible=!1,c=0}if(e[8]){var u=this.gameScreen.btnSeat8.getChildAt(2);u.source="resource/assets/seat/color-yellow.png",u.visible=!0,p=1}else{var u=this.gameScreen.btnSeat8.getChildAt(2);u.visible=!1,p=0}t=n+o+i+a+r+s+c+p,2==t&&(this.gameScreen.btnSeat1.enabled=!1,this.gameScreen.btnSeat2.enabled=!1,this.gameScreen.btnSeat3.enabled=!1,this.gameScreen.btnSeat4.enabled=!1,this.gameScreen.btnSeat5.enabled=!1,this.gameScreen.btnSeat6.enabled=!1,this.gameScreen.btnSeat7.enabled=!1,this.gameScreen.btnSeat8.enabled=!1,this.proxy.loadBalancingClient.myRoomMasterActorNr()==this.proxy.loadBalancingClient.myActor().actorNr&&(this.gameScreen.startjs.visible=!0))},n.prototype.startjschoose2=function(){this.proxy.loadBalancingClient.sendMessage(e.CustomPhotonEvents.startjs)},n.prototype.startjschoose=function(){this.gameScreen.btnjs1.visible=!0,this.gameScreen.btnjs2.visible=!0,this.gameScreen.btnjs3.visible=!0,this.gameScreen.btnjs4.visible=!0,this.gameScreen.btnjs5.visible=!0,this.gameScreen.btnjs6.visible=!0,this.gameScreen.btnjs7.visible=!0,this.gameScreen.btnjs8.visible=!0,this.gameScreen.startjs.visible=!1},n.prototype.choosejsend=function(e){var t=0;e.forEach(function(e){e&&t++}),2==t&&(this.gameScreen.btnjs1.visible=!1,this.gameScreen.btnjs2.visible=!1,this.gameScreen.btnjs3.visible=!1,this.gameScreen.btnjs4.visible=!1,this.gameScreen.btnjs5.visible=!1,this.gameScreen.btnjs6.visible=!1,this.gameScreen.btnjs7.visible=!1,this.gameScreen.btnjs8.visible=!1,this.proxy.loadBalancingClient.myRoomMasterActorNr()==this.proxy.loadBalancingClient.myActor().actorNr&&(this.gameScreen.startgame.visible=!0))},n.prototype.choosejs=function(t){var n=this,o=this.proxy.gameState.role.findIndex(function(e){return e==n.proxy.loadBalancingClient.myActor()});this.proxy.gameState.role[t]?o.toString()==t?console.log("你已经选择了这个角色"):console.log("有人选了这个角色"):(-1==o||(this.sendNotification(e.GameCommand.CHOOSE_ROLE,"destory"+o),console.log("换角色")),this.sendNotification(e.GameCommand.CHOOSE_ROLE,t))},n.prototype.startgame=function(){this.proxy.loadBalancingClient.sendMessage(e.CustomPhotonEvents.startgame)},n.prototype.startgame2=function(){this.gameScreen.startgame.visible=!1,this.suijishu()},n.prototype.suijishu=function(){if(this.proxy.loadBalancingClient.myRoomMasterActorNr()==this.proxy.loadBalancingClient.myActor().actorNr){Math.ceil(1),Math.floor(8);this.firstone=Math.floor(8*Math.random())+1,this.proxy.gameState.seats[this.firstone]?(console.log(this.firstone),this.proxy.loadBalancingClient.sendMessage(e.CustomPhotonEvents.firstoneNr,this.firstone.toString())):this.suijishu()}},n.prototype.first_one=function(e){var t=+e;this.proxy.gameState.seats[t].isLocal&&(this.gameScreen.Anim1.visible=!0,this.gameScreen.Anim2.visible=!0,this.gameScreen.Anim3.visible=!0,this.gameScreen.Anim4.visible=!0)},n.prototype.chooseAnim=function(){this.gameScreen.Anim1.visible=!1,this.gameScreen.Anim2.visible=!1,this.gameScreen.Anim3.visible=!1,this.gameScreen.Anim4.visible=!1,this.gameScreen.shunwei1.visible=!0,this.gameScreen.shunwei2.visible=!0,this.gameScreen.shunwei3.visible=!0,this.gameScreen.shunwei4.visible=!0,this.gameScreen.shunwei5.visible=!0,this.gameScreen.shunwei6.visible=!0,this.gameScreen.shunwei7.visible=!0,this.gameScreen.shunwei8.visible=!0},n.prototype.shunwei=function(e){},n.NAME="GameScreenMediator",n}(puremvc.Mediator);e.GameScreenMediator=t,__reflect(t.prototype,"game.GameScreenMediator",["puremvc.IMediator","puremvc.INotifier"])}(game||(game={}));var Main=function(e){function t(){var t=e.call(this)||this;return Object.entries="function"==typeof Object.entries?Object.entries:function(e){return Object.keys(e).map(function(t){return[t,e[t]]})},t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(e){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var t=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",t),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(e){console.log(e)})},t.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return[4,this.loadResource()];case 1:return t.sent(),this.createGameScene(),[4,platform.login()];case 2:return t.sent(),[4,platform.getUserInfo()];case 3:return e=t.sent(),console.log(e),game.CommonData.logon=e,[2]}})})},t.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var e,t,n=this;return __generator(this,function(o){switch(o.label){case 0:return o.trys.push([0,5,,6]),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return o.sent(),[4,this.loadTheme()];case 2:return o.sent(),[4,RES.loadGroup("loading",1)];case 3:return o.sent(),e=new LoadingUI,this.stage.addChild(e),[4,RES.loadGroup("preload",0,e)];case 4:return o.sent(),egret.Tween.get(e).to({alpha:0},1500).call(function(){n.stage.removeChild(e)}),[3,6];case 5:return t=o.sent(),console.error(t),[3,6];case 6:return[2]}})})},t.prototype.loadTheme=function(){var e=this;return new Promise(function(t,n){var o=new eui.Theme("resource/default.thm.json",e.stage);o.addEventListener(eui.UIEvent.COMPLETE,function(){t()},e)})},t.prototype.createGameScene=function(){var e=new game.AppContainer;this.addChild(e),game.ApplicationFacade.getInstance().startUp(e)},t}(eui.UILayer);__reflect(Main.prototype,"Main");var DebugPlatform=function(){function e(){}return e.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,{nickName:"username"}]})})},e.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,n,o){function i(e){t.call(o,e)}function a(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),n.call(o))}var r=this;"undefined"!=typeof generateEUI?egret.callLater(function(){t.call(o,generateEUI)},this):"undefined"!=typeof generateEUI2?RES.getResByUrl("resource/gameEui.json",function(e,n){window.JSONParseClass.setData(e),egret.callLater(function(){t.call(o,generateEUI2)},r)},this,RES.ResourceItem.TYPE_JSON):(RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),RES.getResByUrl(e,i,this,RES.ResourceItem.TYPE_TEXT))},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var game;!function(e){var t=function(){function e(){}return e}();e.AppConfig=t,__reflect(t.prototype,"game.AppConfig")}(game||(game={}));var game;!function(e){var t=function(t){function n(){var n=t.call(this)||this;return n.startScreen=new e.StartScreen,n.gameScreen=new e.GameScreen,n.alpha=0,n}return __extends(n,t),n.prototype.enterStartScreen=function(){this.addChild(this.startScreen),egret.Tween.get(this).to({alpha:1},1500)},n.prototype.enterGameScreen=function(){this.addChild(this.gameScreen),egret.Tween.get(this).to({alpha:1},1500)},Object.defineProperty(n.prototype,"joinWindow",{get:function(){return this._joinWindow||(this._joinWindow=new e.JoinWindow),this._joinWindow},enumerable:!0,configurable:!0}),n.prototype.showJoinWindow=function(){this.addChild(this.joinWindow),this.joinWindow.show()},n.prototype.showUserInfoWindow=function(){this.userInfoWindow||(this.userInfoWindow=new e.UserInfoWindow),this.addChild(this.userInfoWindow),egret.Tween.get(this).to({alpha:1},1500)},n.prototype.showNoticeWindow=function(){this.noticeWindow||(this.noticeWindow=new e.NoticeWindow),this.addChild(this.noticeWindow),egret.Tween.get(this).to({alpha:1},1500)},n.prototype.showRankWindow=function(){this.rankWindow||(this.rankWindow=new e.RankWindow),this.addChild(this.rankWindow),egret.Tween.get(this).to({alpha:1},1500)},n.prototype.showGuideWindow=function(){this.guideWindow||(this.guideWindow=new e.RankWindow),this.addChild(this.guideWindow),egret.Tween.get(this).to({alpha:1},1500)},n.prototype.showSettingWindow=function(){this.settingWindow||(this.settingWindow=new e.SettingWindow),this.addChild(this.settingWindow),egret.Tween.get(this).to({alpha:1},1500)},n.prototype.showAboutWindow=function(){this.aboutWindow||(this.aboutWindow=new e.AboutWindow),this.addChild(this.aboutWindow),egret.Tween.get(this).to({alpha:1},1500)},n.prototype.showPopupHandleWindow=function(t){this.popupHandleWindow||(this.popupHandleWindow=new e.PopupHandleWindow),this.popupHandleWindow.setMessage(t),this.addChild(this.popupHandleWindow),this.popupHandleWindow.show()},n.prototype.showPopupPromptWindow=function(t){this.popupPromptWindow||(this.popupPromptWindow=new e.PopupPromptWindow),this.popupPromptWindow.setMessage(t),this.addChild(this.popupPromptWindow),this.popupPromptWindow.show()},n.prototype.showPopupRoleWindow=function(){this.popupRoleWindow||(this.popupRoleWindow=new e.PopupRoleWindow),this.addChild(this.popupRoleWindow),this.popupRoleWindow.show()},n.prototype.showPopupResultWindow=function(){this.popupResultWindow||(this.popupResultWindow=new e.PopupResultWindow),this.addChild(this.popupResultWindow),this.popupResultWindow.show()},n.prototype.showPopupGameInfoWindow=function(){this.popupGameInfoWindow||(this.popupGameInfoWindow=new e.PopupGameInfoWindow),this.addChild(this.popupGameInfoWindow),this.popupGameInfoWindow.show()},n}(eui.UILayer);e.AppContainer=t,__reflect(t.prototype,"game.AppContainer")}(game||(game={}));var game;!function(e){var t=function(t){function n(){return t.call(this)||this}return __extends(n,t),n.prototype.execute=function(t){(new e.GameCommand).register(),(new e.SceneCommand).register()},n}(puremvc.SimpleCommand);e.ControllerPrepCommand=t,__reflect(t.prototype,"game.ControllerPrepCommand",["puremvc.ICommand","puremvc.INotifier"])}(game||(game={}));var game;!function(e){var t=function(t){function n(){return t.call(this)||this}return __extends(n,t),n.prototype.execute=function(t){this.facade().registerProxy(new e.AccountProxy),this.facade().registerProxy(new e.GameProxy)},n}(puremvc.SimpleCommand);e.ModelPrepCommand=t,__reflect(t.prototype,"game.ModelPrepCommand",["puremvc.ICommand","puremvc.INotifier"])}(game||(game={}));var game;!function(e){var t=function(t){function n(){return t.call(this)||this}return __extends(n,t),n.prototype.initializeMacroCommand=function(){this.addSubCommand(e.ControllerPrepCommand),this.addSubCommand(e.ModelPrepCommand),this.addSubCommand(e.ViewPrepCommand)},n}(puremvc.MacroCommand);e.StartupCommand=t,__reflect(t.prototype,"game.StartupCommand")}(game||(game={}));var game;!function(e){var t=function(t){function n(){return t.call(this)||this}return __extends(n,t),n.prototype.execute=function(t){var n=t.getBody();this.facade().registerMediator(new e.ApplicationMediator(n))},n}(puremvc.SimpleCommand);e.ViewPrepCommand=t,__reflect(t.prototype,"game.ViewPrepCommand",["puremvc.ICommand","puremvc.INotifier"])}(game||(game={}));var game;!function(e){var t=function(t){function n(){return t.call(this)||this}return __extends(n,t),n.prototype.register=function(){this.initializeNotifier("ApplicationFacade"),this.facade().registerCommand(n.START_GAME,n),this.facade().registerCommand(n.CREATE_ROOM,n),this.facade().registerCommand(n.JOIN_ROOM,n),this.facade().registerCommand(n.JOIN_SEAT,n),this.facade().registerCommand(n.CHOOSE_ROLE,n)},n.prototype.execute=function(t){return __awaiter(this,void 0,void 0,function(){var o,i;return __generator(this,function(a){switch(o=this.facade().retrieveProxy(e.GameProxy.NAME),i=t.getBody(),t.getName()){case n.CREATE_ROOM:o.createRoom();break;case n.JOIN_ROOM:o.joinRoom(i);break;case n.JOIN_SEAT:o.joinSeat(i);break;case n.CHOOSE_ROLE:o.chooserole(i)}return[2]})})},n.NAME="GameCommand",n.START_GAME="start_game",n.CREATE_ROOM="create_room",n.JOIN_ROOM="join_room",n.JOIN_SEAT="join_seat",n.CHOOSE_ROLE="choose_role",n}(puremvc.SimpleCommand);e.GameCommand=t,__reflect(t.prototype,"game.GameCommand",["puremvc.ICommand","puremvc.INotifier"])}(game||(game={}));var game;!function(e){var t=function(t){function n(){return t.call(this)||this}return __extends(n,t),n.prototype.register=function(){this.initializeNotifier("ApplicationFacade")},n.prototype.initializeNotifier=function(e){t.prototype.initializeNotifier.call(this,e),this.facade().registerCommand(n.CHANGE,n),this.facade().registerCommand(n.SHOW_JOIN_WINDOW,n),this.facade().registerCommand(n.SHOW_USERINFO_WINDOW,n),this.facade().registerCommand(n.SHOW_NOTICE_WINDOW,n),this.facade().registerCommand(n.SHOW_RANK_WINDOW,n),this.facade().registerCommand(n.SHOW_GUIDE_WINDOW,n),this.facade().registerCommand(n.SHOW_SETTING_WINDOW,n),this.facade().registerCommand(n.SHOW_ABOUT_WINDOW,n),this.facade().registerCommand(n.SHOW_HANDLE_POPUP,n),this.facade().registerCommand(n.SHOW_PROMPT_POPUP,n),this.facade().registerCommand(n.SHOW_ROLE_POPUP,n),this.facade().registerCommand(n.SHOW_RESULT_POPUP,n),this.facade().registerCommand(n.SHOW_GAMEINFO_POPUP,n)},n.prototype.execute=function(t){return __awaiter(this,void 0,void 0,function(){var o,i,a;return __generator(this,function(r){switch(o=t.getBody(),i=this.facade().retrieveMediator(e.ApplicationMediator.NAME),a=this.facade().retrieveProxy(e.GameProxy.NAME),t.getName()){case n.CHANGE:o==e.Scene.Start?i.main.enterStartScreen():o==e.Scene.Game&&i.main.enterGameScreen();break;case n.SHOW_JOIN_WINDOW:i.main.showJoinWindow();break;case n.SHOW_USERINFO_WINDOW:i.main.showUserInfoWindow();break;case n.SHOW_NOTICE_WINDOW:i.main.showNoticeWindow();break;case n.SHOW_RANK_WINDOW:i.main.showRankWindow();break;case n.SHOW_GUIDE_WINDOW:i.main.showGuideWindow();break;case n.SHOW_SETTING_WINDOW:i.main.showSettingWindow();break;case n.SHOW_ABOUT_WINDOW:i.main.showAboutWindow();break;case n.SHOW_HANDLE_POPUP:i.main.showPopupHandleWindow(o);break;case n.SHOW_PROMPT_POPUP:i.main.showPopupPromptWindow(o);break;case n.SHOW_ROLE_POPUP:i.main.showPopupRoleWindow();break;case n.SHOW_RESULT_POPUP:i.main.showPopupResultWindow();break;case n.SHOW_GAMEINFO_POPUP:i.main.showPopupGameInfoWindow()}return[2]})})},n.NAME="SceneCommand",n.CHANGE="scene_change",n.SHOW_JOIN_WINDOW="show_join_window",n.SHOW_USERINFO_WINDOW="show_user_window",n.SHOW_NOTICE_WINDOW="show_notice_window",n.SHOW_RANK_WINDOW="show_rank_window",n.SHOW_GUIDE_WINDOW="show_guide_window",n.SHOW_SETTING_WINDOW="show_setting_window",n.SHOW_ABOUT_WINDOW="show_about_window",n.SHOW_HANDLE_POPUP="show_handle_popup",n.SHOW_PROMPT_POPUP="show_prompt_popup",n.SHOW_ROLE_POPUP="show_role_popup",n.SHOW_RESULT_POPUP="show_result_popup",n.SHOW_GAMEINFO_POPUP="show_info_window",n}(puremvc.SimpleCommand);e.SceneCommand=t,__reflect(t.prototype,"game.SceneCommand",["puremvc.ICommand","puremvc.INotifier"])}(game||(game={}));var game;!function(e){var t=function(t){function n(){return t.call(this,n.NAME)||this}return __extends(n,t),n.prototype.loadUserInfo=function(){var t=this;return new Promise(function(n,o){t.userInfo&&t.userInfo.openId?n(t.userInfo):(console.log("platform.getUserInfo begin."),platform.getUserInfo().then(function(o){t.userInfo=o,console.log("platform.getUserInfo end."),e.CommonData.logon&&e.CommonData.logon.openId?(console.log("load users/info via app server begin, openId: "+e.CommonData.logon.openId+"."),t.userInfo.openId=e.CommonData.logon.openId,n(t.userInfo)):(console.log("We don't have openId now, skip."),n(t.userInfo))}))})},n.NAME="AccountProxy",n.LOAD_USER_INFO_COMPLETED="userinfo_loaded",n}(puremvc.Proxy);e.AccountProxy=t,__reflect(t.prototype,"game.AccountProxy",["puremvc.IProxy","puremvc.INotifier"])}(game||(game={}));var game;!function(e){var t=function(t){function n(){var o=t.call(this,n.NAME)||this;return o.gameState={roomName:void 0,phase:e.GamePhase.Preparing,players:0,maxPlayers:6,seats:[],role:[]},o}return __extends(n,t),Object.defineProperty(n.prototype,"loadBalancingClient",{get:function(){var t=this;return this._loadBalancingClient||(this._loadBalancingClient=new e.MyLoadBalancingClient,this._loadBalancingClient.updateRoomInfoSubject=function(){t.onUpdateRoomInfo()},this._loadBalancingClient.stateChangeSubject=function(){t.onStateChange()},this._loadBalancingClient.onJoinRoomSubject=function(){t.onJoinRoom()},this._loadBalancingClient.receiveMessageSubject=function(e,n,o){t.onMessage(e,n,o)}),this._loadBalancingClient},enumerable:!0,configurable:!0}),n.prototype.onStateChange=function(){var e=this.loadBalancingClient.state;switch(e){case Photon.LoadBalancing.LoadBalancingClient.State.JoinedLobby:this.roomName&&(this.isMasterClient?this.createRoomWithDefaultOptions():this.joinRoom(this.roomName))}},n.prototype.onUpdateRoomInfo=function(){var t=(this.loadBalancingClient.myRoom(),this.loadBalancingClient.myRoomActors(),this.loadBalancingClient.myRoomActorCount());this.gameState.players=t,this.isMasterClient&&this.gameState.phase==e.GamePhase.Preparing&&this.sendNotification(n.PLAYER_UPDATE,this.gameState)},n.prototype.onJoinRoom=function(){this.actorNr=this.loadBalancingClient.myActor().actorNr,this.sendNotification(e.SceneCommand.CHANGE,e.Scene.Game)},n.prototype.onMessage=function(t,o,i){switch(t){case e.CustomPhotonEvents.TakeSeat:if("destory1"==o)this.gameState.seats[1]=void 0;else if("destory2"==o)this.gameState.seats[2]=void 0;else if("destory3"==o)this.gameState.seats[3]=void 0;else if("destory4"==o)this.gameState.seats[4]=void 0;else if("destory5"==o)this.gameState.seats[5]=void 0;else if("destory6"==o)this.gameState.seats[6]=void 0;else if("destory7"==o)this.gameState.seats[7]=void 0;else if("destory8"==o)this.gameState.seats[8]=void 0;else{var a=+o;this.gameState.seats[a]=i,this.sendNotification(n.SEAT_UPDATE,this.gameState.seats)}break;case e.CustomPhotonEvents.startjs:this.sendNotification(n.START_JS);break;case e.CustomPhotonEvents.Chooserole:if("destory1"==o)this.gameState.role[1]=void 0;else if("destory2"==o)this.gameState.role[2]=void 0;else if("destory3"==o)this.gameState.role[3]=void 0;else if("destory4"==o)this.gameState.role[4]=void 0;else if("destory5"==o)this.gameState.role[5]=void 0;else if("destory6"==o)this.gameState.role[6]=void 0;else if("destory7"==o)this.gameState.role[7]=void 0;else if("destory8"==o)this.gameState.role[8]=void 0;else{var r=+o;this.gameState.role[r]=i}console.log(this.gameState.role),this.sendNotification(n.CHOOSE_JS_END,this.gameState.role);break;case e.CustomPhotonEvents.startgame:this.sendNotification(n.START_GAME);break;case e.CustomPhotonEvents.firstoneNr:this.sendNotification(n.FIRST_ONE,o)}},n.prototype.generateRoomNumber=function(){var e=_.padStart(Math.floor(1e3*Math.random()).toString(),3,"0"),t=parseInt(""+e+(new Date).getMilliseconds()).toString(10);return _.padStart(t,6,"0").toUpperCase()},n.prototype.createRoomWithDefaultOptions=function(){this.loadBalancingClient.isInLobby()&&(console.log("Client is in lobby."),this.loadBalancingClient.createRoom(this.roomName,{isVisible:!0,isOpen:!0,maxPlayers:8,suspendedPlayerLiveTime:-1,emptyRoomLiveTime:12e3,uniqueUserId:!1,propsListedInLobby:[]}))},n.prototype.createRoom=function(){this.isMasterClient=!0,this.roomName=this.generateRoomNumber(),this.loadBalancingClient.state==Photon.LoadBalancing.LoadBalancingClient.State.Uninitialized&&this.loadBalancingClient.start(),this.createRoomWithDefaultOptions()},n.prototype.joinRoom=function(e){if(this.isMasterClient=!1,this.roomName=e,this.loadBalancingClient.isInLobby())console.log("Begin joinRoom: "+e),this.loadBalancingClient.joinRoom(e);else if(this.loadBalancingClient.isJoinedToRoom()){this.loadBalancingClient.myRoom().name;this.loadBalancingClient.myRoom().name==e?console.log("Already in room: "+e):(this.loadBalancingClient.leaveRoom(),this.loadBalancingClient.joinRoom(e))}else this.loadBalancingClient.state==Photon.LoadBalancing.LoadBalancingClient.State.Uninitialized&&this.loadBalancingClient.start()},n.prototype.leaveRoom=function(){this.reset(),this.loadBalancingClient.leaveRoom()},n.prototype.reset=function(){this.roomName=void 0},n.prototype.joinSeat=function(t){this.loadBalancingClient.sendMessage(e.CustomPhotonEvents.TakeSeat,t)},n.prototype.chooserole=function(t){this.loadBalancingClient.sendMessage(e.CustomPhotonEvents.Chooserole,t)},n.NAME="GameProxy",n.PLAYER_UPDATE="player_update",n.SEAT_UPDATE="seat_update",n.START_JS="start_js",n.CHOOSE_JS_END="choose_js_end",n.START_GAME="start_game",n.FIRST_ONE="first_one",n}(puremvc.Proxy);e.GameProxy=t,__reflect(t.prototype,"game.GameProxy",["puremvc.IProxy","puremvc.INotifier"])}(game||(game={}));var game;!function(e){var t=!1,n="d5a0e7bb-7a5a-4adb-a2a5-4b60951e58f9",o="1.0",i=e.Constants.Endpoints.photonMasterServer,a=!0,r=function(r){function s(){var e=r.call(this,t?Photon.ConnectionProtocol.Wss:Photon.ConnectionProtocol.Ws,n,o)||this;return e.setupId=0,e.logger=new Exitgames.Common.Logger("Info:"),e.USERCOLORS=["#FF0000","#00AA00","#0000FF","#FFFF00","#00FFFF","#FF00FF"],e.stateChangeSubject=function(){},e.updateRoomInfoSubject=function(){},e.onJoinRoomSubject=function(){},e.receiveMessageSubject=function(e,t,n){},e.output(e.logger.format("Init",i||e.getNameServerAddress(),o)),e.logger.info("Init",i||e.getNameServerAddress(),o),e.setLogLevel(Exitgames.Common.Logger.Level.DEBUG),e}return __extends(s,r),s.prototype.start=function(){a&&(i?(this.setMasterServerAddress(i),this.connect()):this.connectToRegionMaster("US"))},s.prototype.onError=function(e,t){this.output("Error "+e+": "+t)},s.prototype.onEvent=function(t,n,o){var i=this.myRoomActors()[o];switch(t){case e.CustomPhotonEvents.UserMessage:o?this.output(o+": "+n,i.getCustomProperty("color")):this.output(o+": "+n);break;case e.CustomPhotonEvents.UserStartGame:this.output(o+": started the game",this.myRoomActors()[o].getCustomProperty("color"));break;case e.CustomPhotonEvents.EventRequestGameStates:this.raiseEvent(e.CustomPhotonEvents.EventLoadSceneItemFromServer,null,{targetActors:[o]});break;default:this.receiveMessageSubject(t,n,i)}this.logger.debug("onEvent",t,"message:",n,"actor:",o)},s.prototype.updateUserIdAndNickname=function(e,t){r.prototype.updateUserIdAndNickname.call(this,e,t);var n=e[Photon.LoadBalancing.Constants.ParameterCode.Data];this.myActor().setCustomProperty("data",n)},s.prototype.onOperationResponse=function(e,t,n,o){switch(r.prototype.onOperationResponse.call(this,e,t,n,o),n){case Photon.LoadBalancing.Constants.OperationCode.Authenticate:console.log(o)}},s.prototype.onStateChange=function(e){this.stateChangeSubject()},s.prototype.updateRoomInfo=function(){this.updateRoomInfoSubject()
},s.prototype.objToStr=function(e){var t="";for(var n in e)t+=(""==t?"":" ,")+n+"="+e[n];return t},s.prototype.onActorPropertiesChange=function(e){this.updateRoomInfo()},s.prototype.onMyRoomPropertiesChange=function(){this.updateRoomInfo()},s.prototype.onRoomListUpdate=function(e,t,n,o){this.logger.info("Info: onRoomListUpdate",e,t,n,o),this.output("Info: Rooms update: "+t.length+" updated, "+n.length+" added, "+o.length+" removed"),this.onRoomList(e)},s.prototype.onRoomList=function(e){this.output("Info: Rooms total: "+e.length)},s.prototype.onJoinRoom=function(){var e=this.USERCOLORS[this.myRoomActorCount()-1];this.myActor().setCustomProperty("color",e),this.output("Game "+this.myRoom().name+" joined",e);var t=this.myActor().getCustomProperty("data");this.toggleActorState(this.myActor().name,t&&t.Avatar,!0),this.myRoom().getCustomProperty("setupId")||this.myRoom().setCustomProperty("setupId",this.setupId),this.updateRoomInfo(),this.onJoinRoomSubject()},s.prototype.onActorJoin=function(e){this.output("Actor "+(e.name||e.actorNr)+" joined",e.getCustomProperty("color")),this.updateRoomInfo()},s.prototype.onActorLeave=function(e){this.output("Actor "+(e.name||e.actorNr)+" left",e.getCustomProperty("color")),this.updateRoomInfo()},s.prototype.onActorSuspend=function(e){this.output("Actor "+(e.name||e.actorNr)+" suspended",e.getCustomProperty("color"));var t=this.myActor().getCustomProperty("data");this.toggleActorState(e.name,t&&t.Avatar,!1),this.updateRoomInfo()},s.prototype.toggleActorState=function(e,t,n){var o=this.myRoom().getCustomProperty("myRoomActorStates")||[],i=_.keyBy(o,"name")||{};i[e]=i[e]||{name:e,avatar:t},i[e].active=n,this.myRoom().setCustomProperty("myRoomActorStates",_.toArray(i),!0)},s.prototype.getActorState=function(e){var t=this.myRoom().getCustomProperty("myRoomActorStates")||[],n=_.keyBy(t,"name")||{};return n[e]&&n[e].active},s.prototype.sendMessage=function(e,t){try{this.raiseEvent(e,t,{receivers:Photon.LoadBalancing.Constants.ReceiverGroup.All}),this.output("me["+(this.myActor().name||this.myActor().actorNr)+"]: "+t,this.myActor().getCustomProperty("color"))}catch(n){this.output("error: "+n.message)}},s.prototype.startGame=function(){try{this.raiseEvent(e.CustomPhotonEvents.UserStartGame,{message:"",sender:this.myActor().actorNr}),this.output("me["+(this.myActor().name||this.myActor().actorNr)+"]: start the game",this.myActor().getCustomProperty("color"))}catch(t){this.output("error: "+t.message)}},s.prototype.output=function(e,t){e.replace(/&/,"&amp;").replace(/</,"&lt;").replace(/>/,"&gt;").replace(/"/,"&quot;")},s}(Photon.LoadBalancing.LoadBalancingClient);e.MyLoadBalancingClient=r,__reflect(r.prototype,"game.MyLoadBalancingClient")}(game||(game={}));var game;!function(e){var t=function(){function e(){}return e}();e.CommonData=t,__reflect(t.prototype,"game.CommonData")}(game||(game={}));var game;!function(e){var t=function(t){function n(){return t.call(this,"ApplicationFacade")||this}return __extends(n,t),n.getInstance=function(){return null==this.instance&&(this.instance=new n),this.instance},n.prototype.initializeController=function(){t.prototype.initializeController.call(this),this.registerCommand(n.STARTUP,e.StartupCommand)},n.prototype.startUp=function(t){this.sendNotification(n.STARTUP,t),this.removeCommand(n.STARTUP),this.sendNotification(e.SceneCommand.CHANGE,e.Scene.Start)},n.prototype.registerMediator=function(e){t.prototype.registerMediator.call(this,e)},n.STARTUP="startup",n}(puremvc.Facade);e.ApplicationFacade=t,__reflect(t.prototype,"game.ApplicationFacade",["puremvc.IFacade","puremvc.INotifier"])}(game||(game={}));var game;!function(e){var t;!function(e){e[e.UserMessage=0]="UserMessage",e[e.UserStartGame=1]="UserStartGame",e[e.EventRequestGameStates=2]="EventRequestGameStates",e[e.EventLoadSceneItemFromServer=3]="EventLoadSceneItemFromServer",e[e.TakeSeat=4]="TakeSeat",e[e.startjs=5]="startjs",e[e.Chooserole=6]="Chooserole",e[e.startgame=7]="startgame",e[e.firstoneNr=8]="firstoneNr"}(t=e.CustomPhotonEvents||(e.CustomPhotonEvents={}))}(game||(game={}));var game;!function(e){var t;!function(e){e[e.Start=1]="Start",e[e.Game=2]="Game"}(t=e.Scene||(e.Scene={}))}(game||(game={}));var game;!function(e){var t=function(){function e(){}return e}();e.UserInfo=t,__reflect(t.prototype,"game.UserInfo")}(game||(game={}));var game;!function(e){var t;!function(e){e[e.Preparing=1]="Preparing",e[e.Ready=2]="Ready",e[e.Input=3]="Input",e[e.FirstRound=4]="FirstRound"}(t=e.GamePhase||(e.GamePhase={}))}(game||(game={}));var game;!function(e){var t=function(){function e(){}return e}();e.GameState=t,__reflect(t.prototype,"game.GameState")}(game||(game={}));var game;!function(e){var t=function(e){function t(n){return e.call(this,t.NAME,n)||this}return __extends(t,e),t.prototype.listNotificationInterests=function(){return[]},t.prototype.handleNotification=function(e){e.getName()},Object.defineProperty(t.prototype,"main",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),t.NAME="ApplicationMediator",t}(puremvc.Mediator);e.ApplicationMediator=t,__reflect(t.prototype,"game.ApplicationMediator",["puremvc.IMediator","puremvc.INotifier"])}(game||(game={}));var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,n){function o(o){t.call(n,o,e)}if(RES.hasRes(e)){var i=RES.getRes(e);i?o(i):RES.getResAsync(e,o,this)}else RES.getResByUrl(e,o,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var game;!function(e){var t=function(t){function n(e){var o=t.call(this,n.NAME,e)||this;return t.prototype.initializeNotifier.call(o,"ApplicationFacade"),o.joinWindow.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,o.confirmClick,o),console.log("JoinWindow initData:"),o.initData(),o}return __extends(n,t),n.prototype.confirmClick=function(){var t=this.joinWindow.txtRoomName.text;this.sendNotification(e.GameCommand.JOIN_ROOM,t)},n.prototype.initData=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return this.proxy=this.facade().retrieveProxy(e.GameProxy.NAME),[2]})})},n.prototype.listNotificationInterests=function(){return[]},n.prototype.handleNotification=function(e){e.getBody()},Object.defineProperty(n.prototype,"joinWindow",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),n.NAME="JoinWindowMediator",n}(puremvc.Mediator);e.JoinWindowMediator=t,__reflect(t.prototype,"game.JoinWindowMediator",["puremvc.IMediator","puremvc.INotifier"])}(game||(game={}));var game;!function(e){var t=function(e){function t(n){var o=e.call(this,t.NAME,n)||this;return e.prototype.initializeNotifier.call(o,"ApplicationFacade"),o.initData(),o}return __extends(t,e),t.prototype.initData=function(){},Object.defineProperty(t.prototype,"popupGameInfoWindow",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),t.NAME="PopupGameInfoWindowMediator",t}(puremvc.Mediator);e.PopupGameInfoWindowMediator=t,__reflect(t.prototype,"game.PopupGameInfoWindowMediator",["puremvc.IMediator","puremvc.INotifier"])}(game||(game={}));var game;!function(e){var t=function(t){function n(e){var o=t.call(this,n.NAME,e)||this;return t.prototype.initializeNotifier.call(o,"ApplicationFacade"),o.popupHandleWindow.confirmButton.addEventListener(egret.TouchEvent.TOUCH_TAP,o.confirmClick,o),o.popupHandleWindow.btnCreateRoom.addEventListener(egret.TouchEvent.TOUCH_TAP,o.createRoomClick,o),o.popupHandleWindow.sixButton.addEventListener(egret.TouchEvent.TOUCH_TAP,o.selectedSix,o),o.popupHandleWindow.sevenButton.addEventListener(egret.TouchEvent.TOUCH_TAP,o.selectedSeven,o),o.popupHandleWindow.eightButton.addEventListener(egret.TouchEvent.TOUCH_TAP,o.selectedEight,o),o}return __extends(n,t),n.prototype.confirmClick=function(){},n.prototype.createRoomClick=function(t){this.sendNotification(e.GameCommand.CREATE_ROOM)},n.prototype.selectedSix=function(e){this.popupHandleWindow.sixButton.selected=!0,this.popupHandleWindow.sevenButton.selected=this.popupHandleWindow.eightButton.selected=!1},n.prototype.selectedSeven=function(e){this.popupHandleWindow.sevenButton.selected=!0,this.popupHandleWindow.sixButton.selected=this.popupHandleWindow.eightButton.selected=!1},n.prototype.selectedEight=function(e){this.popupHandleWindow.eightButton.selected=!0,this.popupHandleWindow.sevenButton.selected=this.popupHandleWindow.sixButton.selected=!1},Object.defineProperty(n.prototype,"popupHandleWindow",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),n.NAME="PopupHandleWindowMediator",n}(puremvc.Mediator);e.PopupHandleWindowMediator=t,__reflect(t.prototype,"game.PopupHandleWindowMediator",["puremvc.IMediator","puremvc.INotifier"])}(game||(game={}));var game;!function(e){var t=function(e){function t(n){var o=e.call(this,t.NAME,n)||this;return e.prototype.initializeNotifier.call(o,"ApplicationFacade"),o.initData(),o}return __extends(t,e),t.prototype.initData=function(){},Object.defineProperty(t.prototype,"popupResultWindow",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),t.NAME="PopupResultWindowMediator",t}(puremvc.Mediator);e.PopupResultWindowMediator=t,__reflect(t.prototype,"game.PopupResultWindowMediator",["puremvc.IMediator","puremvc.INotifier"])}(game||(game={}));var game;!function(e){var t=function(t){function n(e){var o=t.call(this,n.NAME,e)||this;return t.prototype.initializeNotifier.call(o,"ApplicationFacade"),o.popupRoleWindow.confirmButton.addEventListener(egret.TouchEvent.TOUCH_TAP,o.confirmClick,o),o.initData(),o}return __extends(n,t),n.prototype.initData=function(){},n.prototype.confirmClick=function(t){this.facade().retrieveProxy(e.GameProxy.NAME);this.popupRoleWindow.close()},Object.defineProperty(n.prototype,"popupRoleWindow",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),n.NAME="PopupRoleWindowMediator",n}(puremvc.Mediator);e.PopupRoleWindowMediator=t,__reflect(t.prototype,"game.PopupRoleWindowMediator",["puremvc.IMediator","puremvc.INotifier"])}(game||(game={}));var game;!function(e){var t=function(t){function n(e){var o=t.call(this,n.NAME,e)||this;return t.prototype.initializeNotifier.call(o,"ApplicationFacade"),o.rankWindow.winRateButton.addEventListener(egret.TouchEvent.TOUCH_TAP,o.winRateButtonClick,o),o.rankWindow.roleButton.addEventListener(egret.TouchEvent.TOUCH_TAP,o.roleButtonClick,o),o.rankWindow.gameNumButton.addEventListener(egret.TouchEvent.TOUCH_TAP,o.gameNumButtonClick,o),o.rankWindow.backButton.addEventListener(egret.TouchEvent.TOUCH_TAP,o.backButtonClick,o),o.initData(),o}return __extends(n,t),n.prototype.initData=function(){return __awaiter(this,void 0,void 0,function(){var t,n;return __generator(this,function(o){for(t=[],n=1;21>n;n++)t.push({key:n,name:"name"+n,score:n});return this.rankWindow.rankList.dataProvider=new eui.ArrayCollection(t),this.rankWindow.rankList.itemRenderer=e.RankListItemRenderer,[2]})})},n.prototype.backButtonClick=function(e){this.rankWindow.close()},n.prototype.winRateButtonClick=function(e){this.rankWindow.showGameNumSwitch=this.rankWindow.showRoleSwitch=!1,this.rankWindow.showWinRateSwitch=!this.rankWindow.showWinRateSwitch,this.rankWindow.winRateButton.selected=!0,this.rankWindow.roleButton.selected=this.rankWindow.gameNumButton.selected=!1},n.prototype.roleButtonClick=function(e){this.rankWindow.showGameNumSwitch=this.rankWindow.showWinRateSwitch=!1,this.rankWindow.showRoleSwitch=!this.rankWindow.showRoleSwitch,this.rankWindow.roleButton.selected=!0,this.rankWindow.winRateButton.selected=this.rankWindow.gameNumButton.selected=!1},n.prototype.gameNumButtonClick=function(e){this.rankWindow.showWinRateSwitch=this.rankWindow.showRoleSwitch=!1,this.rankWindow.showGameNumSwitch=!this.rankWindow.showGameNumSwitch,this.rankWindow.gameNumButton.selected=!0,this.rankWindow.roleButton.selected=this.rankWindow.winRateButton.selected=!1},n.prototype.listNotificationInterests=function(){return[]},n.prototype.handleNotification=function(e){e.getBody()},Object.defineProperty(n.prototype,"rankWindow",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),n.NAME="RankWindowMediator",n}(puremvc.Mediator);e.RankWindowMediator=t,__reflect(t.prototype,"game.RankWindowMediator",["puremvc.IMediator","puremvc.INotifier"])}(game||(game={}));var game;!function(e){var t=function(t){function n(e){var o=t.call(this,n.NAME,e)||this;return t.prototype.initializeNotifier.call(o,"ApplicationFacade"),o.settingWindow.shareButton.addEventListener(egret.TouchEvent.TOUCH_TAP,o.shareButtonClick,o),o.settingWindow.aboutButton.addEventListener(egret.TouchEvent.TOUCH_TAP,o.aboutButtonClick,o),o.settingWindow.backButton.addEventListener(egret.TouchEvent.TOUCH_TAP,o.backButtonClick,o),o}return __extends(n,t),n.prototype.backButtonClick=function(e){this.settingWindow.close()},n.prototype.shareButtonClick=function(e){},n.prototype.aboutButtonClick=function(t){this.sendNotification(e.SceneCommand.SHOW_ABOUT_WINDOW)},Object.defineProperty(n.prototype,"settingWindow",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),n.NAME="SettingWindowMediator",n}(puremvc.Mediator);e.SettingWindowMediator=t,__reflect(t.prototype,"game.SettingWindowMediator",["puremvc.IMediator","puremvc.INotifier"])}(game||(game={}));var game;!function(e){var t=function(t){function n(e){var o=t.call(this,n.NAME,e)||this;return t.prototype.initializeNotifier.call(o,"ApplicationFacade"),o.startScreen.btnCreateRoom.addEventListener(egret.TouchEvent.TOUCH_TAP,o.createRoomClick,o),o.startScreen.btnJoinRoom.addEventListener(egret.TouchEvent.TOUCH_TAP,o.joinRoomClick,o),o.startScreen.headGroup.addEventListener(egret.TouchEvent.TOUCH_TAP,o.showMyInfo,o),o.startScreen.btnNotice.addEventListener(egret.TouchEvent.TOUCH_TAP,o.noticeClick,o),o.startScreen.btnRank.addEventListener(egret.TouchEvent.TOUCH_TAP,o.rankClick,o),o.startScreen.btnGuide.addEventListener(egret.TouchEvent.TOUCH_TAP,o.guideClick,o),o.startScreen.btnSetting.addEventListener(egret.TouchEvent.TOUCH_TAP,o.settingClick,o),console.log("StartScreen initData:"),o.initData(),o}return __extends(n,t),n.prototype.initData=function(){return __awaiter(this,void 0,void 0,function(){var t,n=this;return __generator(this,function(o){return t=this.facade().retrieveProxy(e.AccountProxy.NAME),t.loadUserInfo().then(function(e){n.startScreen.nickName=e.nickName,n.startScreen.avatarUrl=e.avatarUrl}),[2]})})},n.prototype.createRoomClick=function(t){this.sendNotification(e.SceneCommand.SHOW_HANDLE_POPUP)},n.prototype.joinRoomClick=function(t){this.sendNotification(e.SceneCommand.SHOW_JOIN_WINDOW)},n.prototype.noticeClick=function(t){this.sendNotification(e.SceneCommand.SHOW_NOTICE_WINDOW)},n.prototype.rankClick=function(t){this.sendNotification(e.SceneCommand.SHOW_RANK_WINDOW)},n.prototype.guideClick=function(t){this.sendNotification(e.SceneCommand.SHOW_PROMPT_POPUP),this.sendNotification(e.SceneCommand.SHOW_ROLE_POPUP),this.sendNotification(e.SceneCommand.SHOW_RESULT_POPUP),this.sendNotification(e.SceneCommand.SHOW_GAMEINFO_POPUP)},n.prototype.settingClick=function(t){this.sendNotification(e.SceneCommand.SHOW_SETTING_WINDOW)},n.prototype.showMyInfo=function(){this.sendNotification(e.SceneCommand.SHOW_USERINFO_WINDOW)},n.prototype.listNotificationInterests=function(){return[]},n.prototype.handleNotification=function(e){e.getBody()},Object.defineProperty(n.prototype,"startScreen",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),n.NAME="StartScreenMediator",n}(puremvc.Mediator);e.StartScreenMediator=t,__reflect(t.prototype,"game.StartScreenMediator",["puremvc.IMediator","puremvc.INotifier"])}(game||(game={}));var game;!function(e){var t=function(e){function t(n){var o=e.call(this,t.NAME,n)||this;return e.prototype.initializeNotifier.call(o,"ApplicationFacade"),o.userInfoWindow.backButton.addEventListener(egret.TouchEvent.TOUCH_TAP,o.backButtonClick,o),o.initData(),o}return __extends(t,e),t.prototype.initData=function(){},t.prototype.backButtonClick=function(e){this.userInfoWindow.close()},Object.defineProperty(t.prototype,"userInfoWindow",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),t.NAME="UserInfoWindowMediator",t}(puremvc.Mediator);e.UserInfoWindowMediator=t,__reflect(t.prototype,"game.UserInfoWindowMediator",["puremvc.IMediator","puremvc.INotifier"])}(game||(game={}));var game;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.skinName="skins.AboutWindow",t.addEventListener(eui.UIEvent.ADDED,t.createCompleteEvent,t),t.addEventListener(egret.TouchEvent.TOUCH_TAP,t.close,t),t}return __extends(t,e),t.prototype.createCompleteEvent=function(e){this.imgHeight=this.stage.stageHeight,this.removeEventListener(eui.UIEvent.ADDED,this.createCompleteEvent,this)},t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t}(eui.Panel);e.AboutWindow=t,__reflect(t.prototype,"game.AboutWindow")}(game||(game={}));var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.skinName="skins.LoadingUI",t.addEventListener(eui.UIEvent.CREATION_COMPLETE,t.createCompleteEvent,t),t}return __extends(t,e),t.prototype.createCompleteEvent=function(e){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.createCompleteEvent,this),this.progressBg.y=this.stage.stageHeight-30,this.progressBar.y=this.stage.stageHeight-30,this.loadingLabel.y=this.stage.stageHeight-60},t.prototype.onProgress=function(e,t){this.labelText.text=e+"/"+t,this.progressBar.width=this.stage.width*e/t},t}(eui.Component);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var game;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.roomName="",e.isMasterClient=!1,e.isNormalClient=!0,e.currentPlayers=0,e.maxPlayers=0,e.isInitial=!1,e.isWaiting=!1,e.isAllReady=!1,e.skinName="skins.GameScreen",e.addEventListener(eui.UIEvent.ADDED,e.createCompleteEvent,e),e.btnjs1.visible=!1,e.btnjs2.visible=!1,e.btnjs3.visible=!1,e.btnjs4.visible=!1,e.btnjs5.visible=!1,e.btnjs6.visible=!1,e.btnjs7.visible=!1,e.btnjs8.visible=!1,e.startjs.visible=!1,e.startgame.visible=!1,e.Anim1.visible=!1,e.Anim2.visible=!1,e.Anim3.visible=!1,e.Anim4.visible=!1,e.shunwei1.visible=!1,e.shunwei2.visible=!1,e.shunwei3.visible=!1,e.shunwei4.visible=!1,e.shunwei5.visible=!1,e.shunwei6.visible=!1,e.shunwei7.visible=!1,e.shunwei8.visible=!1,e}return __extends(n,t),n.prototype.createCompleteEvent=function(t){this.navigationBar.y=this.stage.stageHeight-this.navigationBar.height-10,this.removeEventListener(eui.UIEvent.ADDED,this.createCompleteEvent,this),e.ApplicationFacade.getInstance().registerMediator(new e.GameScreenMediator(this))},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n}(eui.Component);e.GameScreen=t,__reflect(t.prototype,"game.GameScreen")}(game||(game={}));var game;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.skinName="skins.JoinWindow",e.addEventListener(eui.UIEvent.CREATION_COMPLETE,e.createCompleteEvent,e),e}return __extends(n,t),n.prototype.createCompleteEvent=function(t){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.createCompleteEvent,this),e.ApplicationFacade.getInstance().registerMediator(new e.JoinWindowMediator(this))},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n}(e.BasePanel);e.JoinWindow=t,__reflect(t.prototype,"game.JoinWindow")}(game||(game={}));var game;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.skinName="skins.NoticeWindow",t.addEventListener(eui.UIEvent.ADDED,t.createCompleteEvent,t),t.backButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.close,t),t}return __extends(t,e),t.prototype.createCompleteEvent=function(e){this.navigationBar.y=this.stage.stageHeight-this.navigationBar.height-10,this.contentScroller.height=this.stage.stageHeight-this.headGroup.height-this.navigationBar.height-20,this.removeEventListener(eui.UIEvent.ADDED,this.createCompleteEvent,this)},t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t}(eui.Panel);e.NoticeWindow=t,__reflect(t.prototype,"game.NoticeWindow")}(game||(game={}));var game;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.skinName="skins.PopupGameInfoWindow",e.addEventListener(eui.UIEvent.CREATION_COMPLETE,e.createCompleteEvent,e),e}return __extends(n,t),n.prototype.createCompleteEvent=function(t){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.createCompleteEvent,this),e.ApplicationFacade.getInstance().registerMediator(new e.PopupGameInfoWindowMediator(this))},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n}(e.BasePanel);e.PopupGameInfoWindow=t,__reflect(t.prototype,"game.PopupGameInfoWindow")}(game||(game={}));var game;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.skinName="skins.PopupHandleWindow",e.addEventListener(eui.UIEvent.CREATION_COMPLETE,e.createCompleteEvent,e),e}return __extends(n,t),n.prototype.createCompleteEvent=function(t){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.createCompleteEvent,this),e.ApplicationFacade.getInstance().registerMediator(new e.PopupHandleWindowMediator(this))},n.prototype.setMessage=function(e){this.message=e?"确定要退出游戏么？":null,this.isCreate=e?!1:!0},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n}(e.BasePanel);e.PopupHandleWindow=t,__reflect(t.prototype,"game.PopupHandleWindow")}(game||(game={}));var game;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.skinName="skins.PopupPromptWindow",t.addEventListener(eui.UIEvent.CREATION_COMPLETE,t.createCompleteEvent,t),t}return __extends(t,e),t.prototype.createCompleteEvent=function(e){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.createCompleteEvent,this)},t.prototype.setMessage=function(e){this.message=e,this.isStart=e?!1:!0},t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t}(e.BasePanel);e.PopupPromptWindow=t,__reflect(t.prototype,"game.PopupPromptWindow")}(game||(game={}));var game;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.skinName="skins.PopupResultWindow",e.addEventListener(eui.UIEvent.CREATION_COMPLETE,e.createCompleteEvent,e),e}return __extends(n,t),n.prototype.createCompleteEvent=function(t){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.createCompleteEvent,this),e.ApplicationFacade.getInstance().registerMediator(new e.PopupResultWindowMediator(this))},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n}(e.BasePanel);e.PopupResultWindow=t,__reflect(t.prototype,"game.PopupResultWindow")}(game||(game={}));var game;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.skinName="skins.PopupRoleWindow",e.addEventListener(eui.UIEvent.CREATION_COMPLETE,e.createCompleteEvent,e),e}return __extends(n,t),n.prototype.createCompleteEvent=function(t){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.createCompleteEvent,this),e.ApplicationFacade.getInstance().registerMediator(new e.PopupRoleWindowMediator(this))},n.prototype.setRole=function(e){this.role=e},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n}(e.BasePanel);e.PopupRoleWindow=t,__reflect(t.prototype,"game.PopupRoleWindow")}(game||(game={}));var game;!function(e){var t=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onCloseButtonClick=function(e){this.parent&&this.parent.close()},t}(eui.Panel);e.PopupWindowWrapper=t,__reflect(t.prototype,"game.PopupWindowWrapper")}(game||(game={}));var game;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.skinName="skins.RankListItemRenderer",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this)},t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this),this.data.key>3?(this.isNotTopThree=!0,this.rankRes=null):(this.isNotTopThree=!1,this.rankRes="rank"+this.data.key)},t}(eui.ItemRenderer);e.RankListItemRenderer=t,__reflect(t.prototype,"game.RankListItemRenderer")}(game||(game={}));var game;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.skinName="skins.RankWindow",e.addEventListener(eui.UIEvent.ADDED,e.createCompleteEvent,e),e}return __extends(n,t),n.prototype.createCompleteEvent=function(t){console.log(this.navigationBar),this.navigationBar.y=this.stage.stageHeight-this.navigationBar.height-10,this.contentScroller.height=this.stage.stageHeight-this.headGroup.height-this.navigationBar.height-20,this.removeEventListener(eui.UIEvent.ADDED,this.createCompleteEvent,this),e.ApplicationFacade.getInstance().registerMediator(new e.RankWindowMediator(this))},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n}(eui.Panel);e.RankWindow=t,__reflect(t.prototype,"game.RankWindow")}(game||(game={}));var game;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.skinName="skins.SettingWindow",e.addEventListener(eui.UIEvent.ADDED,e.createCompleteEvent,e),e}return __extends(n,t),n.prototype.createCompleteEvent=function(t){this.navigationBar.y=this.stage.stageHeight-this.navigationBar.height-10,this.removeEventListener(eui.UIEvent.ADDED,this.createCompleteEvent,this),e.ApplicationFacade.getInstance().registerMediator(new e.SettingWindowMediator(this))},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n}(eui.Panel);e.SettingWindow=t,__reflect(t.prototype,"game.SettingWindow")}(game||(game={}));var game;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.skinName="skins.Shade",t.addEventListener(eui.UIEvent.ADDED_TO_STAGE,t.createCompleteEvent,t),t}return __extends(t,e),t.prototype.childrenCreated=function(){this.rect.x=this.rect.y=0,this.rect.width=egret.lifecycle.stage.stageWidth,this.rect.height=egret.lifecycle.stage.stageHeight,this.removeEventListener(eui.UIEvent.ADDED_TO_STAGE,this.createCompleteEvent,this)},t.prototype.createCompleteEvent=function(e){},t.addMask=function(e){var t=new eui.Group;t.touchEnabled=!0,t.verticalCenter=0;var n=egret.lifecycle.stage,o=new eui.Rect(n.stageWidth,n.stageHeight,0);o.x=0,o.y=0,o.alpha=.8,t.addChild(o),e.addChildAt(t,0)},t}(eui.Component);e.Shade=t,__reflect(t.prototype,"game.Shade")}(game||(game={}));var game;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.nickName="nickName",e.avatarUrl="btn-share",e.skinName="skins.StartScreen",e.addEventListener(eui.UIEvent.ADDED,e.createCompleteEvent,e),e}return __extends(n,t),n.prototype.createCompleteEvent=function(t){this.navigationBar.y=this.stage.stageHeight-this.navigationBar.height-10,this.contentScroller.height=this.stage.stageHeight-this.navigationBar.height-this.headGroup.height-15,this.removeEventListener(eui.UIEvent.ADDED,this.createCompleteEvent,this),e.ApplicationFacade.getInstance().registerMediator(new e.StartScreenMediator(this))},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n}(eui.Component);e.StartScreen=t,__reflect(t.prototype,"game.StartScreen")}(game||(game={}));var game;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.skinName="skins.UserInfoWindow",e.addEventListener(eui.UIEvent.ADDED,e.createCompleteEvent,e),e}return __extends(n,t),n.prototype.createCompleteEvent=function(t){this.navigationBar.y=this.stage.stageHeight-this.navigationBar.height-10,this.content.height=this.stage.stageHeight-this.navigationBar.height-this.headGroup.height-15,this.removeEventListener(eui.UIEvent.ADDED,this.createCompleteEvent,this),e.ApplicationFacade.getInstance().registerMediator(new e.UserInfoWindowMediator(this))},n.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},n}(eui.Panel);e.UserInfoWindow=t,__reflect(t.prototype,"game.UserInfoWindow")}(game||(game={}));