var __reflect=this&&this.__reflect||function(e,t,o){e.__class__=t,o?o.push(t):o=[t],e.__types__=e.__types__?o.concat(e.__types__):o},__extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);o.prototype=t.prototype,e.prototype=new o},__awaiter=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))(function(n,a){function r(e){try{u(i.next(e))}catch(t){a(t)}}function s(e){try{u(i["throw"](e))}catch(t){a(t)}}function u(e){e.done?n(e.value):new o(function(t){t(e.value)}).then(r,s)}u((i=i.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function o(e){return function(t){return i([e,t])}}function i(o){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,a&&(r=a[2&o[0]?"return":o[0]?"throw":"next"])&&!(r=r.call(a,o[1])).done)return r;switch(a=0,r&&(o=[0,r.value]),o[0]){case 0:case 1:r=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,a=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(r=u.trys,!(r=r.length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){u=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){u.label=o[1];break}if(6===o[0]&&u.label<r[1]){u.label=r[1],r=o;break}if(r&&u.label<r[2]){u.label=r[2],u.ops.push(o);break}r[2]&&u.ops.pop(),u.trys.pop();continue}o=t.call(e,u)}catch(i){o=[6,i],a=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}var n,a,r,s,u={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:o(0),"throw":o(1),"return":o(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},__assign=this&&this.__assign||Object.assign||function(e){for(var t,o=1,i=arguments.length;i>o;o++){t=arguments[o];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},game;!function(e){var t=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.container.visible=!1},t.prototype.show=function(){this.container.verticalCenter=-700,this.container.visible=!0,egret.Tween.get(this.container).to({verticalCenter:0},500,egret.Ease.backOut)},t.prototype.onCloseButtonClick=function(t){e.prototype.onCloseButtonClick.call(this,t),this.close()},t.prototype.close=function(){this.parent&&this.parent.removeChild(this)},t}(eui.Panel);e.BasePanel=t,__reflect(t.prototype,"game.BasePanel")}(game||(game={}));var game;!function(e){var t=function(t){function o(i){var n=t.call(this,o.NAME,i)||this;return t.prototype.initializeNotifier.call(n,"ApplicationFacade"),n.proxy=n.facade().retrieveProxy(e.GameProxy.NAME),n.popupRoundWindow.addEventListener(egret.Event.ADDED_TO_STAGE,n.initData,n),n}return __extends(o,t),o.prototype.initData=function(){this.popupRoundWindow.roundText="第"+this.proxy.gameState.lunci+"轮开始";for(var e=4*this.proxy.gameState.lunci,t=e-4;e>t;t++)this.popupRoundWindow["ant"+(t%4+1)]=this.proxy.antiquesMap.get(this.proxy.gameState.baowulist[t]).source},Object.defineProperty(o.prototype,"popupRoundWindow",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),o.NAME="PopupRoundWindowMediator",o}(puremvc.Mediator);e.PopupRoundWindowMediator=t,__reflect(t.prototype,"game.PopupRoundWindowMediator",["puremvc.IMediator","puremvc.INotifier"])}(game||(game={}));var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,o){function i(i){t.call(o,i,e)}if(RES.hasRes(e)){var n=RES.getRes(e);n?i(n):RES.getResAsync(e,i,this)}else RES.getResByUrl(e,i,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.skinName="skins.LoadingUI",t.addEventListener(eui.UIEvent.CREATION_COMPLETE,t.createCompleteEvent,t),t}return __extends(t,e),t.prototype.createCompleteEvent=function(e){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.createCompleteEvent,this),this.progressBg.y=this.stage.stageHeight-30,this.progressBar.y=this.stage.stageHeight-30,this.loadingLabel.y=this.stage.stageHeight-60,this.btnLogin.y=this.stage.stageHeight-this.btnLogin.height,this.btnAnonymousLogin.y=this.stage.stageHeight-this.btnLogin.height-this.btnAnonymousLogin.height-20},t.prototype.onProgress=function(e,t){this.labelText.text=e+"/"+t,this.progressBar.width=this.stage.width*e/t},t.prototype.showInformation=function(e){this.loadingText.text=e,this.labelText.text=""},t}(eui.Component);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var Main=function(e){function t(){var t=e.call(this)||this;return Object.entries="function"==typeof Object.entries?Object.entries:function(e){return Object.keys(e).map(function(t){return[t,e[t]]})},t}return __extends(t,e),t.prototype.createChildren=function(){var t=this;e.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(e){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume(),console.log("egret onResume"),platform.resume()};var o=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",o),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(e){console.error(e),t.loadingView.showInformation(e)})},t.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var e=this;return __generator(this,function(t){switch(t.label){case 0:return[4,this.loadResource()];case 1:return t.sent(),this.loadingView.groupLoading.visible=!1,"native"==platform.name?[3,4]:[4,AccountAdapter.login()];case 2:return t.sent(),[4,AccountAdapter.loadUserInfo()];case 3:return t.sent(),this.createGameScene(),[3,5];case 4:this.loadingView.btnAnonymousLogin.visible=!0,this.loadingView.btnLogin.visible=!0,this.loadingView.btnLogin.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return __awaiter(e,void 0,void 0,function(){var e=this;return __generator(this,function(t){return egret.ExternalInterface.call("sendWxLoginToNative","native"),egret.ExternalInterface.addCallback("sendWxLoginCodeToJS",function(t){return __awaiter(e,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return this.loadingView.btnLogin.enabled=!1,[4,AccountAdapter.login({code:t})];case 1:return e.sent(),this.createGameScene(),[2]}})})}),[2]})})},this),this.loadingView.btnAnonymousLogin.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return __awaiter(e,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return[4,platform.getSecurityStorageAsync("anonymoustoken")];case 1:return e=t.sent(),[4,AccountAdapter.login({token:e})];case 2:return t.sent(),this.createGameScene(),[2]}})})},this),t.label=5;case 5:return[2]}})})},t.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(o){switch(o.label){case 0:return o.trys.push([0,6,,7]),[4,AccountAdapter.checkForUpdate()];case 1:return e=o.sent(),e.hasUpdate&&platform.applyUpdate(e.version),[4,RES.loadConfig("default.res.json",game.Constants.ResourceEndpoint+"resource/")];case 2:return o.sent(),[4,this.loadTheme()];case 3:return o.sent(),[4,RES.loadGroup("loading",1)];case 4:return o.sent(),this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),[4,RES.loadGroup("preload",0,this.loadingView)];case 5:return o.sent(),RES.loadGroup("lazyload",0),platform.createBannerAd("top","adunit-4616af6cd0c20ef1","top"),[3,7];case 6:return t=o.sent(),console.error(t),[3,7];case 7:return[2]}})})},t.prototype.loadTheme=function(){var e=this;return new Promise(function(t,o){var i=new eui.Theme("resource/default.thm.json",e.stage);i.addEventListener(eui.UIEvent.COMPLETE,function(){t()},e)})},t.prototype.createGameScene=function(){var e=this;egret.Tween.get(this.loadingView).to({alpha:0},1500).call(function(){e.stage.removeChild(e.loadingView)});var t=new game.AppContainer;this.addChild(t),game.ApplicationFacade.getInstance().startUp(t)},t}(eui.UILayer);__reflect(Main.prototype,"Main");var DebugPlatform=function(){function e(){this.isConnected=!0}return Object.defineProperty(e.prototype,"env",{get:function(){return"dev"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return"DebugPlatform"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"appVersion",{get:function(){return"0.2.24"},enumerable:!0,configurable:!0}),e.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,{nickName:game.CommonData.logon&&game.CommonData.logon.unionId||"username"}]})})},e.prototype.authorizeUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,{nickName:game.CommonData.logon&&game.CommonData.logon.unionId||"username"}]})})},e.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,{code:"anonymous",token:""}]})})},e.prototype.getVersion=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e.prototype.applyUpdate=function(){return!0},e.prototype.onNetworkStatusChange=function(e){},e.prototype.registerOnResume=function(e){},e.prototype.resume=function(){},e.prototype.showToast=function(e){console.log(e)},e.prototype.setStorage=function(e,t){sessionStorage.setItem(e,JSON.stringify(t))},e.prototype.getStorage=function(e){return JSON.parse(sessionStorage.getItem(e))},e.prototype.setStorageAsync=function(e,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(o){return sessionStorage.setItem(e,JSON.stringify(t)),[2]})})},e.prototype.getStorageAsync=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,JSON.parse(sessionStorage.getItem(e))]})})},e.prototype.setSecurityStorageAsync=function(e,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(o){return sessionStorage.setItem(e,JSON.stringify(t)),[2]})})},e.prototype.getSecurityStorageAsync=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,JSON.parse(sessionStorage.getItem(e))]})})},e.prototype.playVideo=function(){return{}},e.prototype.showPreImage=function(e,t){},e.prototype.showModal=function(e,t,o){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,{confirm:!1,cancel:!0}]})})},e.prototype.showLoading=function(){return!0},e.prototype.hideLoading=function(){return!0},e.prototype.shareAppMessage=function(){},e.prototype.createBannerAd=function(e,t,o){},e.prototype.showBannerAd=function(e){void 0===e&&(e="bottom")},e.prototype.hideAllBannerAds=function(){},e.prototype.navigateToMiniProgram=function(){},e}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]);var NativePlatform=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.hasGetSecurityStorageAsyncCallback=!1,t.hasSendShowModalCallback=!1,t}return __extends(t,e),Object.defineProperty(t.prototype,"env",{get:function(){return"dev"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return"native"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"appVersion",{get:function(){return"0.3.1"},enumerable:!0,configurable:!0}),t.prototype.setStorage=function(e,t){localStorage.setItem(e,JSON.stringify(t))},t.prototype.getStorage=function(e){return JSON.parse(localStorage.getItem(e))},t.prototype.setStorageAsync=function(e,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(o){return localStorage.setItem(e,JSON.stringify(t)),[2]})})},t.prototype.getStorageAsync=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,JSON.parse(localStorage.getItem(e))]})})},t.prototype.setSecurityStorageAsync=function(e,t){return __awaiter(this,void 0,void 0,function(){var o;return __generator(this,function(i){return o={key:e,value:t},egret.ExternalInterface.call("setSecurityStorageAsync",JSON.stringify(o)),[2]})})},t.prototype.getSecurityStorageAsync=function(e){return __awaiter(this,void 0,void 0,function(){var t=this;return __generator(this,function(o){return egret.ExternalInterface.call("getSecurityStorageAsync",e),[2,new Promise(function(e,o){t.hasGetSecurityStorageAsyncCallback||(t.hasGetSecurityStorageAsyncCallback=!0,egret.ExternalInterface.addCallback("getSecurityStorageAsyncCallback",function(t){return e(t)}))})]})})},t.prototype.onNetworkStatusChange=function(e){var t=this;egret.ExternalInterface.addCallback("sendNetworkStatusChangeToJS",function(o){t.isConnected=o&&"0"!=o,e&&e({isConnected:t.isConnected})})},t.prototype.registerOnResume=function(e){this.onResume=e},t.prototype.resume=function(){this.onResume&&this.onResume({isConnected:this.isConnected})},t.prototype.showModal=function(e,t,o){return __awaiter(this,void 0,void 0,function(){var i=this;return __generator(this,function(n){return egret.ExternalInterface.call("sendShowModalToNative",JSON.stringify({message:e,confirmText:t,cancelText:o})),[2,new Promise(function(e,t){i.hasSendShowModalCallback||(i.hasSendShowModalCallback=!0,egret.ExternalInterface.addCallback("sendShowModalResultToJS",function(t){return e({confirm:"confirm"==t,cancel:"cancel"==t})}))})]})})},t.prototype.showToast=function(e){egret.ExternalInterface.call("sendShowToastToNative",e)},t}(DebugPlatform);__reflect(NativePlatform.prototype,"NativePlatform"),window.platform||(window.platform=new NativePlatform);var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,o,i){function n(e){t.call(i,e)}function a(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),o.call(i))}var r=this;"undefined"!=typeof generateEUI?egret.callLater(function(){t.call(i,generateEUI)},this):"undefined"!=typeof generateEUI2?RES.getResByUrl("resource/gameEui.json",function(e,o){window.JSONParseClass.setData(e),egret.callLater(function(){t.call(i,generateEUI2)},r)},this,RES.ResourceItem.TYPE_JSON):(RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),RES.getResByUrl(e,n,this,RES.ResourceItem.TYPE_TEXT))},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var game;!function(e){var t=function(){function e(){}return e}();e.AppConfig=t,__reflect(t.prototype,"game.AppConfig")}(game||(game={}));var game;!function(e){var t=function(t){function o(){var o=t.call(this)||this;return o.startScreen=new e.StartScreen,o.gameScreen=new e.GameScreen,o.alpha=0,o}return __extends(o,t),o.prototype.enterStartScreen=function(){platform.hideAllBannerAds(),this.removeChildren(),this.addChild(this.startScreen),egret.Tween.get(this).to({alpha:1},1500)},o.prototype.enterGameScreen=function(){platform.hideAllBannerAds(),this.addChild(this.gameScreen),egret.Tween.get(this).to({alpha:1},1500)},o.prototype.showUserInfoWindow=function(){this.userInfoWindow||(this.userInfoWindow=new e.UserInfoWindow),this.addChild(this.userInfoWindow),egret.Tween.get(this).to({alpha:1},1500)},o.prototype.showNoticeWindow=function(){this.noticeWindow||(this.noticeWindow=new e.NoticeWindow),this.addChild(this.noticeWindow),egret.Tween.get(this).to({alpha:1},1500)},o.prototype.showRankWindow=function(){this.rankWindow||(this.rankWindow=new e.RankWindow),this.addChild(this.rankWindow),egret.Tween.get(this).to({alpha:1},1500)},o.prototype.showGuideWindow=function(){this.guideWindow||(this.guideWindow=new e.GuideWindow),this.addChild(this.guideWindow),egret.Tween.get(this).to({alpha:1},1500)},o.prototype.showBarWindow=function(){this.barWindow||(this.barWindow=new e.BarWindow),this.addChild(this.barWindow),egret.Tween.get(this).to({alpha:1},1500)},o.prototype.showSettingWindow=function(){this.settingWindow||(this.settingWindow=new e.SettingWindow),this.addChild(this.settingWindow),egret.Tween.get(this).to({alpha:1},1500)},o.prototype.showAboutWindow=function(t){this.aboutWindow||(this.aboutWindow=new e.AboutWindow),this.addChild(this.aboutWindow),egret.Tween.get(this).to({alpha:1},1500)},o.prototype.showResultWindow=function(){this.resultWindow||(this.resultWindow=new e.ResultWindow),this.addChild(this.resultWindow),egret.Tween.get(this).to({alpha:1},1500)},o.prototype.showPopupHandleWindow=function(t){this.popupHandleWindow||(this.popupHandleWindow=new e.PopupHandleWindow),this.popupHandleWindow.setMessage(t),this.addChild(this.popupHandleWindow),this.popupHandleWindow.show()},o.prototype.showPopupPromptWindow=function(t){this.popupPromptWindow||(this.popupPromptWindow=new e.PopupPromptWindow),this.popupPromptWindow.setMessage(t),this.addChild(this.popupPromptWindow),this.popupPromptWindow.show()},o.prototype.showPopupFangWindow=function(t){this.popupFangWindow||(this.popupFangWindow=new e.PopupFangWindow),this.popupFangWindow.setSeat(t),this.addChild(this.popupFangWindow),this.popupFangWindow.show()},o.prototype.showPopupRoleWindow=function(t){this.popupRoleWindow||(this.popupRoleWindow=new e.PopupRoleWindow),this.popupRoleWindow.setRole(t),this.addChild(this.popupRoleWindow),this.popupRoleWindow.show()},o.prototype.showPopupRoundWindow=function(){this.popupRoundWindow||(this.popupRoundWindow=new e.PopupRoundWindow),this.addChild(this.popupRoundWindow),this.popupRoundWindow.show()},o.prototype.showPopupAppraisalWindow=function(t){this.popupAppraisalWindow||(this.popupAppraisalWindow=new e.PopupAppraisalWindow),this.popupAppraisalWindow.setData(t),this.addChild(this.popupAppraisalWindow),this.popupAppraisalWindow.show()},o.prototype.showVoteRecordWindow=function(){this.voteRecordWindow||(this.voteRecordWindow=new e.PopupVoteRecordWindow),this.addChild(this.voteRecordWindow),egret.Tween.get(this).to({alpha:1},1500)},o.prototype.showPopupResultWindow=function(){this.popupResultWindow||(this.popupResultWindow=new e.PopupVoteResultWindow),this.addChild(this.popupResultWindow),this.popupResultWindow.show()},o.prototype.showPopupGameInfoWindow=function(){this.popupGameInfoWindow||(this.popupGameInfoWindow=new e.PopupGameInfoWindow),this.addChild(this.popupGameInfoWindow),this.popupGameInfoWindow.show()},o.prototype.showGuideVideoWindow=function(){this.guideVideoWindow||(this.guideVideoWindow=new e.GuideVideoWindow),this.addChild(this.guideVideoWindow),egret.Tween.get(this).to({alpha:1},1500)},o.prototype.showGuideGameProcessWindow=function(){this.guideGameProcessWindow||(this.guideGameProcessWindow=new e.GuideGameProcessWindow),this.addChild(this.guideGameProcessWindow),egret.Tween.get(this).to({alpha:1},1500)},o.prototype.showGuideRoleSkillWindow=function(){this.guideRoleSkillWindow||(this.guideRoleSkillWindow=new e.GuideRoleSkillWindow),this.addChild(this.guideRoleSkillWindow),egret.Tween.get(this).to({alpha:1},1500)},o.prototype.showGuideWinJudgeWindow=function(){this.guideWinJudgeWindow||(this.guideWinJudgeWindow=new e.GuideWinJudgeWindow),this.addChild(this.guideWinJudgeWindow),egret.Tween.get(this).to({alpha:1},1500)},o.prototype.showGuideGameTermWindow=function(){this.guideGameTermWindow||(this.guideGameTermWindow=new e.GuideGameTermWindow),this.addChild(this.guideGameTermWindow),egret.Tween.get(this).to({alpha:1},1500)},o.prototype.showPopupNumberKeyboard=function(){this.popupNumberKeyboard||(this.popupNumberKeyboard=new e.PopupNumberKeyboard),this.addChild(this.popupNumberKeyboard),this.popupNumberKeyboard.show()},o.prototype.showMoreWindow=function(){this.moreWindow||(this.moreWindow=new e.MoreGameWindow),this.addChild(this.moreWindow),egret.Tween.get(this).to({alpha:1},1500)},o}(eui.UILayer);e.AppContainer=t,__reflect(t.prototype,"game.AppContainer")}(game||(game={}));var game;!function(e){var t=function(t){function o(){return t.call(this)||this}return __extends(o,t),o.prototype.execute=function(t){(new e.GameCommand).register(),(new e.SceneCommand).register()},o}(puremvc.SimpleCommand);e.ControllerPrepCommand=t,__reflect(t.prototype,"game.ControllerPrepCommand",["puremvc.ICommand","puremvc.INotifier"])}(game||(game={}));var game;!function(e){var t=function(t){function o(){return t.call(this)||this}return __extends(o,t),o.prototype.execute=function(t){this.facade().registerProxy(new e.AccountProxy),this.facade().registerProxy(new e.GameProxy)},o}(puremvc.SimpleCommand);e.ModelPrepCommand=t,__reflect(t.prototype,"game.ModelPrepCommand",["puremvc.ICommand","puremvc.INotifier"])}(game||(game={}));var game;!function(e){var t=function(t){function o(){return t.call(this)||this}return __extends(o,t),o.prototype.initializeMacroCommand=function(){this.addSubCommand(e.ControllerPrepCommand),this.addSubCommand(e.ModelPrepCommand),this.addSubCommand(e.ViewPrepCommand)},o}(puremvc.MacroCommand);e.StartupCommand=t,__reflect(t.prototype,"game.StartupCommand")}(game||(game={}));var game;!function(e){var t=function(t){function o(){return t.call(this)||this}return __extends(o,t),o.prototype.execute=function(t){var o=t.getBody();this.facade().registerMediator(new e.ApplicationMediator(o))},o}(puremvc.SimpleCommand);e.ViewPrepCommand=t,__reflect(t.prototype,"game.ViewPrepCommand",["puremvc.ICommand","puremvc.INotifier"])}(game||(game={}));var game;!function(e){var t=function(t){function o(){return t.call(this)||this}return __extends(o,t),o.prototype.register=function(){this.initializeNotifier("ApplicationFacade"),this.facade().registerCommand(o.START_GAME,o),this.facade().registerCommand(o.CREATE_ROOM,o),this.facade().registerCommand(o.JOIN_ROOM,o),this.facade().registerCommand(o.JOIN_SEAT,o),this.facade().registerCommand(o.CHOOSE_ROLE,o)},o.prototype.execute=function(t){return __awaiter(this,void 0,void 0,function(){var i,n;return __generator(this,function(a){switch(i=this.facade().retrieveProxy(e.GameProxy.NAME),n=t.getBody(),t.getName()){case o.CREATE_ROOM:i.createRoom(n);break;case o.JOIN_ROOM:i.joinRoom(n);break;case o.JOIN_SEAT:i.joinSeat(n);break;case o.CHOOSE_ROLE:i.chooseRole(n);break;case o.START_GAME:i.startGame()}return[2]})})},o.NAME="GameCommand",o.START_GAME="start_game",o.CREATE_ROOM="create_room",o.JOIN_ROOM="join_room",o.JOIN_SEAT="join_seat",o.CHOOSE_ROLE="choose_role",o}(puremvc.SimpleCommand);e.GameCommand=t,__reflect(t.prototype,"game.GameCommand",["puremvc.ICommand","puremvc.INotifier"])}(game||(game={}));var game;!function(e){var t=function(t){function o(){return t.call(this)||this}return __extends(o,t),o.prototype.register=function(){this.initializeNotifier("ApplicationFacade")},o.prototype.initializeNotifier=function(e){t.prototype.initializeNotifier.call(this,e),this.facade().registerCommand(o.CHANGE,o),this.facade().registerCommand(o.SHOW_JOIN_WINDOW,o),this.facade().registerCommand(o.SHOW_USERINFO_WINDOW,o),this.facade().registerCommand(o.SHOW_NOTICE_WINDOW,o),this.facade().registerCommand(o.SHOW_RANK_WINDOW,o),this.facade().registerCommand(o.SHOW_GUIDE_WINDOW,o),this.facade().registerCommand(o.SHOW_SETTING_WINDOW,o),this.facade().registerCommand(o.SHOW_ABOUT_WINDOW,o),this.facade().registerCommand(o.SHOW_BAR_WINDOW,o),this.facade().registerCommand(o.SHOW_RESULT_WINDOW,o),this.facade().registerCommand(o.SHOW_HANDLE_POPUP,o),this.facade().registerCommand(o.SHOW_PROMPT_POPUP,o),this.facade().registerCommand(o.SHOW_FANG_POPUP,o),this.facade().registerCommand(o.SHOW_ROUND_POPUP,o),this.facade().registerCommand(o.SHOW_ROLE_POPUP,o),this.facade().registerCommand(o.SHOW_RESULT_POPUP,o),this.facade().registerCommand(o.SHOW_APPRAISAL_POPUP,o),this.facade().registerCommand(o.SHOW_ROUND_POPUP,o),this.facade().registerCommand(o.SHOW_GAMEINFO_POPUP,o),this.facade().registerCommand(o.SHOW_NUMBER_KEYBOARD,o),this.facade().registerCommand(o.SHOW_GUIDE_VIDEO,o),this.facade().registerCommand(o.SHOW_GUIDE_PROCESS,o),this.facade().registerCommand(o.SHOW_GUIDE_ROLE,o),this.facade().registerCommand(o.SHOW_GUIDE_WINJUDGE,o),this.facade().registerCommand(o.SHOW_GUIDE_TERM,o),this.facade().registerCommand(o.SHOW_VOTERECORD_WINDOW,o),this.facade().registerCommand(o.SHOW_MORE_GAME,o)},o.prototype.execute=function(t){return __awaiter(this,void 0,void 0,function(){var i,n,a;return __generator(this,function(r){switch(i=t.getBody(),n=this.facade().retrieveMediator(e.ApplicationMediator.NAME),a=this.facade().retrieveProxy(e.GameProxy.NAME),t.getName()){case o.CHANGE:i==e.Scene.Start?n.main.enterStartScreen():i==e.Scene.Game&&n.main.enterGameScreen();break;case o.SHOW_USERINFO_WINDOW:n.main.showUserInfoWindow();break;case o.SHOW_NOTICE_WINDOW:n.main.showNoticeWindow();break;case o.SHOW_RANK_WINDOW:n.main.showRankWindow();break;case o.SHOW_GUIDE_WINDOW:n.main.showGuideWindow();break;case o.SHOW_BAR_WINDOW:n.main.showBarWindow();break;case o.SHOW_SETTING_WINDOW:n.main.showSettingWindow();break;case o.SHOW_ABOUT_WINDOW:n.main.showAboutWindow(i);break;case o.SHOW_VOTERECORD_WINDOW:n.main.showVoteRecordWindow();break;case o.SHOW_RESULT_WINDOW:n.main.showResultWindow();break;case o.SHOW_HANDLE_POPUP:n.main.showPopupHandleWindow(i);break;case o.SHOW_PROMPT_POPUP:n.main.showPopupPromptWindow(i);break;case o.SHOW_FANG_POPUP:n.main.showPopupFangWindow(i);break;case o.SHOW_ROLE_POPUP:n.main.showPopupRoleWindow(i);break;case o.SHOW_ROUND_POPUP:n.main.showPopupRoundWindow();break;case o.SHOW_APPRAISAL_POPUP:n.main.showPopupAppraisalWindow(i);break;case o.SHOW_RESULT_POPUP:n.main.showPopupResultWindow();break;case o.SHOW_GAMEINFO_POPUP:n.main.showPopupGameInfoWindow();break;case o.SHOW_NUMBER_KEYBOARD:n.main.showPopupNumberKeyboard();break;case o.SHOW_GUIDE_VIDEO:n.main.showGuideVideoWindow();break;case o.SHOW_GUIDE_PROCESS:n.main.showGuideGameProcessWindow();break;case o.SHOW_GUIDE_ROLE:n.main.showGuideRoleSkillWindow();break;case o.SHOW_GUIDE_WINJUDGE:n.main.showGuideWinJudgeWindow();break;case o.SHOW_GUIDE_TERM:n.main.showGuideGameTermWindow();break;case o.SHOW_MORE_GAME:n.main.showMoreWindow()}return[2]})})},o.NAME="SceneCommand",o.CHANGE="scene_change",o.SHOW_JOIN_WINDOW="show_join_window",o.SHOW_USERINFO_WINDOW="show_user_window",o.SHOW_NOTICE_WINDOW="show_notice_window",o.SHOW_RANK_WINDOW="show_rank_window",o.SHOW_GUIDE_WINDOW="show_guide_window",o.SHOW_SETTING_WINDOW="show_setting_window",o.SHOW_BAR_WINDOW="show_bar_window",o.SHOW_ABOUT_WINDOW="show_about_window",o.SHOW_RESULT_WINDOW="show_result_window",o.SHOW_HANDLE_POPUP="show_handle_popup",o.SHOW_PROMPT_POPUP="show_prompt_popup",o.SHOW_FANG_POPUP="show_fang_popup",o.SHOW_ROUND_POPUP="show_round_popup",o.SHOW_ROLE_POPUP="show_role_popup",o.SHOW_RESULT_POPUP="show_result_popup",o.SHOW_APPRAISAL_POPUP="show_appraisal_popup",o.SHOW_GAMEINFO_POPUP="show_info_window",o.SHOW_NUMBER_KEYBOARD="show_number_keyboard",o.SHOW_VOTERECORD_WINDOW="show_voterecord_window",o.SHOW_GUIDE_VIDEO="show_guide_video",o.SHOW_GUIDE_PROCESS="show_guide_process",o.SHOW_GUIDE_ROLE="show_guide_role",o.SHOW_GUIDE_WINJUDGE="show_guide_winjudge",o.SHOW_GUIDE_TERM="show_guide_term",o.SHOW_MORE_GAME="show_more_game",o}(puremvc.SimpleCommand);e.SceneCommand=t,__reflect(t.prototype,"game.SceneCommand",["puremvc.ICommand","puremvc.INotifier"])}(game||(game={}));var game;!function(e){var t=function(t){function o(){return t.call(this,o.NAME)||this}return __extends(o,t),o.prototype.loadRank=function(t,o,i,n){return void 0===t&&(t=e.OrderType.winRate),void 0===o&&(o=0),void 0===i&&(i=0),void 0===n&&(n=10),__awaiter(this,void 0,void 0,function(){var a,r=this;return __generator(this,function(s){return a=new egret.HttpRequest,a.responseType=egret.HttpResponseType.TEXT,a.open(e.Constants.Endpoints.service+"ranks/?orderType="+t+"&mode="+o+"&role="+i+"&minimumCount="+n,egret.HttpMethod.GET),a.setRequestHeader("Content-Type","application/json"),a.send(),[2,new Promise(function(e,t){a.addEventListener(egret.Event.COMPLETE,function(o){console.log("loadRanks via app server end.");var i=o.currentTarget,n=JSON.parse(i.response);return n.error?(console.error(n.message),t(n.message)):(console.log("resolve current ranks"),e(n.data))},r)})]})})},o.NAME="AccountProxy",o}(puremvc.Proxy);e.AccountProxy=t,__reflect(t.prototype,"game.AccountProxy",["puremvc.IProxy","puremvc.INotifier"])}(game||(game={}));var game;!function(e){var t=function(t){function o(){var i=t.call(this,o.NAME)||this;i.gameState=new e.GameState;var n=i;return platform.onNetworkStatusChange(function(e){return console.log(e),e&&e.isConnected?(console.log(n.loadBalancingClient.state),console.log("reset retried",n.loadBalancingClient.retried),n.loadBalancingClient.retried=0,void((n.loadBalancingClient.state==Photon.LoadBalancing.LoadBalancingClient.State.Disconnected||n.loadBalancingClient.state==Photon.LoadBalancing.LoadBalancingClient.State.Error)&&(n.loadBalancingClient.autoRejoin=!0,n.loadBalancingClient.start()))):void console.log("onResume: not connected")}),platform.registerOnResume(function(e){return console.log("registered onResume"),e&&e.isConnected?(console.log(n.loadBalancingClient.state),console.log("reset retried",n.loadBalancingClient.retried),n.loadBalancingClient.retried=0,void((n.loadBalancingClient.state==Photon.LoadBalancing.LoadBalancingClient.State.Disconnected||n.loadBalancingClient.state==Photon.LoadBalancing.LoadBalancingClient.State.Error)&&(n.loadBalancingClient.autoRejoin=!0,n.loadBalancingClient.start()))):void console.log("onResume: not connected")}),i}return __extends(o,t),o.prototype.initialize=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return e=this,[4,AccountAdapter.loadUserInfo()];case 1:return e.userInfo=t.sent(),this.loadBalancingClient.setCustomAuthentication("userId="+this.userInfo.userId,Photon.LoadBalancing.Constants.CustomAuthenticationType.Custom),this.loadBalancingClient.start(),[2]}})})},Object.defineProperty(o.prototype,"isMasterClient",{get:function(){return this.loadBalancingClient&&this.loadBalancingClient.myActor().actorNr==this.loadBalancingClient.myRoomMasterActorNr()},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"actorNr",{get:function(){return this._actorNr},set:function(e){this._actorNr=e,platform.setStorage("currentRoom",{roomName:this.roomName,actorNr:this.actorNr})},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"currentRoom",{get:function(){return platform.getStorage("currentRoom")},set:function(e){platform.setStorage("currentRoom",e)},enumerable:!0,configurable:!0}),o.prototype.isActorMaster=function(e){return e&&e.actorNr==this.loadBalancingClient.myRoomMasterActorNr()},o.prototype.isActorLocal=function(e){return e&&e.actorNr==this.loadBalancingClient.myActor().actorNr},Object.defineProperty(o.prototype,"antiquesMap",{get:function(){return this._antiquesMap||(this._antiquesMap=new Map(Object.entries(RES.getRes("antiques_json")))),this._antiquesMap},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"seatsMap",{get:function(){return this._seatsMap||(this._seatsMap=new Map(Object.entries(RES.getRes("seats_json")))),this._seatsMap},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"rolesMap",{get:function(){return this._rolesMap||(this._rolesMap=new Map(Object.entries(RES.getRes("role_json")))),this._rolesMap},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"loadBalancingClient",{get:function(){var t=this;return this._loadBalancingClient||(this._loadBalancingClient=new e.MyLoadBalancingClient,this._loadBalancingClient.updateRoomInfoSubject=function(){t.onUpdateRoomInfo()},this._loadBalancingClient.stateChangeSubject=function(){t.onStateChange()},this._loadBalancingClient.onJoinRoomSubject=function(){t.onJoinRoom()},this._loadBalancingClient.receiveMessageSubject=function(e,o,i){t.onMessage(e,o,i)},this._loadBalancingClient.onOperationResponseSubject=function(e){t.onOperationResponse(e)}),this._loadBalancingClient},enumerable:!0,configurable:!0}),o.prototype.onOperationResponse=function(e){e&&this.reset()},o.prototype.onStateChange=function(){var e=this.loadBalancingClient.state;
switch(e){case Photon.LoadBalancing.LoadBalancingClient.State.JoinedLobby:if(platform.showToast("连接服务器成功"),this.roomName)this.loadBalancingClient.retried=0,this.isMasterClient&&this.isCreating?this.createRoomWithDefaultOptions():this.joinRoom(this.roomName);else if(this.loadBalancingClient.autoRejoin){var t=this.currentRoom;t&&t.roomName&&this.joinRoom(t.roomName)}}},o.prototype.onUpdateRoomInfo=function(){var t=(this.loadBalancingClient.myRoom(),this.loadBalancingClient.myRoomActors()),i=_(t).toArray().value().filter(function(e){return e&&!e.suspended}).length;this.gameState.players=i;for(var n=0;n<this.gameState.seats.length;++n){var a=this.gameState.seats[n];a&&(t[a.actorNr]?a.suspended=t[a.actorNr].suspended:this.gameState.seats[n]=void 0)}this.isMasterClient&&this.gameState.phase==e.GamePhase.Preparing&&(console.log("GamePhase.Preparing: setCustomProperty"),this.loadBalancingClient.myRoom().setCustomProperty("gameState",this.gameState,!1,null)),this.sendNotification(o.PLAYER_UPDATE,this.gameState)},o.prototype.onJoinRoom=function(){return __awaiter(this,void 0,void 0,function(){var t,o;return __generator(this,function(i){switch(i.label){case 0:return console.log("onJoinRoom hideLoading"),platform.hideLoading(),this.loadBalancingClient.autoRejoin=!0,this.actorNr=this.loadBalancingClient.myActor().actorNr,this.sendNotification(e.SceneCommand.CHANGE,e.Scene.Game),this.gameState=this.loadBalancingClient.myRoom().getCustomProperty("gameState")||this.gameState,t=this.facade().retrieveProxy(e.AccountProxy.NAME),[4,AccountAdapter.loadUserInfo()];case 1:return o=i.sent(),this.loadBalancingClient.myActor().setCustomProperties({userId:o.userId,avatarUrl:o.avatarUrl,nickName:o.nickName}),[2]}})})},o.prototype.onMessage=function(t,i,n){if(!this.loadBalancingClient.isConnectedToGame())return void console.log("Disconnected: skip onMessage");switch(t){case e.CustomPhotonEvents.TakeSeat:var a=(i.oldSeatNumber,i.newSeatNumber),r=this.gameState.seats.findIndex(function(e){return e&&e.actorNr==n.actorNr});-1!=r&&(this.gameState.seats[r]=void 0);var s=new e.ActorModel(n,a),u=this.seatsMap.get(a.toString());s.color=u,this.gameState.seats[a]=s,this.isMasterClient&&(console.log("CustomPhotonEvents.TakeSeat: setCustomProperty"),this.loadBalancingClient.myRoom().setCustomProperty("gameState",this.gameState,!1,null)),this.sendNotification(o.SEAT_UPDATE,this.gameState.seats),this.sendNotification(o.PLAYER_UPDATE,this.gameState),this.sendNotification(o.ROLEING,0);break;case e.CustomPhotonEvents.StartChoosingRole:this.gameState.phase=e.GamePhase.ChoosingRole,this.isMasterClient&&(console.log("CustomPhotonEvents.StartChoosingRole: setCustomProperty"),this.loadBalancingClient.myRoom().setCustomProperty("gameState",this.gameState,!1,null)),this.sendNotification(o.PLAYER_UPDATE,this.gameState);break;case e.CustomPhotonEvents.ChooseRole:var h=i.oldRoleId,c=i.newRoleId;h&&(this.gameState.role[h]=void 0),this.gameState.role[c]=new e.ActorModel(n);var l=0;this.gameState.role.forEach(function(e){e&&l++}),this.sendNotification(o.ROLEING,l),this.sendNotification(o.PLAYER_UPDATE,this.gameState),this.isMasterClient&&(console.log("CustomPhotonEvents.ChooseRole: setCustomProperty"),this.loadBalancingClient.myRoom().setCustomProperty("gameState",this.gameState,!1,null));break;case e.CustomPhotonEvents.FirstOneNr:this.gameState=this.loadBalancingClient.myRoom().getCustomProperty("gameState"),this.sendNotification(e.SceneCommand.SHOW_ROUND_POPUP),this.sendNotification(o.PLAYER_UPDATE,this.gameState),this.sendNotification(o.FIRST_ONE,i);break;case e.CustomPhotonEvents.nextNr:this.sendNotification(o.NEXT_NR,i);break;case e.CustomPhotonEvents.tongzhi:this.sendNotification(o.TONGZHI,i);break;case e.CustomPhotonEvents.baowutongzhi:this.sendNotification(o.BAOWU_TONGZHI,i);break;case e.CustomPhotonEvents.toupiaoui:this.sendNotification(o.TOUPIAO_UI);break;case e.CustomPhotonEvents.piaoshu:var p=this.gameState.seats.findIndex(function(e){return e&&e.actorNr==n.actorNr});this.gameState.toupiao[p]=i,this.sendNotification(o.PIAO_SHU,this.gameState.toupiao),this.isMasterClient&&(console.log("CustomPhotonEvents.piaoshu: setCustomProperty"),this.loadBalancingClient.myRoom().setCustomProperty("gameState",this.gameState,!1,null));break;case e.CustomPhotonEvents.piaoshu2:var p=this.gameState.seats.findIndex(function(e){return e&&e.actorNr==n.actorNr});this.gameState.toupiao2[p]=i,this.sendNotification(o.PIAO_SHU,this.gameState.toupiao2),this.isMasterClient&&(console.log("CustomPhotonEvents.piaoshu2: setCustomProperty"),this.loadBalancingClient.myRoom().setCustomProperty("gameState",this.gameState,!1,null));break;case e.CustomPhotonEvents.piaoshu3:var p=this.gameState.seats.findIndex(function(e){return e&&e.actorNr==n.actorNr});this.gameState.toupiao3[p]=i,this.sendNotification(o.PIAO_SHU,this.gameState.toupiao3),this.isMasterClient&&(console.log("CustomPhotonEvents.piaoshu3: setCustomProperty"),this.loadBalancingClient.myRoom().setCustomProperty("gameState",this.gameState,!1,null));break;case e.CustomPhotonEvents.toupiaoend:var d=0;this.gameState.toupiao.forEach(function(e){var t=+e;d+=t}),this.sendNotification(o.ZONG_PIAOSHU,d);break;case e.CustomPhotonEvents.toupiaoend2:var m=0;this.gameState.toupiao2.forEach(function(e){var t=+e;m+=t}),this.sendNotification(o.ZONG_PIAOSHU,m);break;case e.CustomPhotonEvents.toupiaoend3:var g=0;this.gameState.toupiao3.forEach(function(e){var t=+e;g+=t}),this.sendNotification(o.ZONG_PIAOSHU,g);break;case e.CustomPhotonEvents.starttwo:this.sendNotification(o.START_TWO);break;case e.CustomPhotonEvents.onelcftongbu:this.gameState.onelcfskill=!0;break;case e.CustomPhotonEvents.twolcftongbu:this.gameState.twolcfskill=!0;break;case e.CustomPhotonEvents.threelcftongbu:this.gameState.threelcfskill=!0;break;case e.CustomPhotonEvents.oneybrtongbu:var f=+i;this.gameState.oneybrskill=f,this.sendNotification(o.ONE_YBRSKILL,f);break;case e.CustomPhotonEvents.twoybrtongbu:var f=+i;this.gameState.twoybrskill=f,this.sendNotification(o.ONE_YBRSKILL,f);break;case e.CustomPhotonEvents.threeybrtongbu:var f=+i;this.gameState.threeybrskill=f,this.sendNotification(o.ONE_YBRSKILL,f);break;case e.CustomPhotonEvents.onezgqtongbu:var f=+i;this.gameState.onezgqskill=f,this.sendNotification(o.ONE_ZGQSKILL,f);break;case e.CustomPhotonEvents.twozgqtongbu:var f=+i;this.gameState.twozgqskill=f,this.sendNotification(o.ONE_ZGQSKILL,f);break;case e.CustomPhotonEvents.threezgqtongbu:var f=+i;this.gameState.threezgqskill=f,this.sendNotification(o.ONE_ZGQSKILL,f);break;case e.CustomPhotonEvents.lunci:var f=+i;this.gameState.lunci=f;break;case e.CustomPhotonEvents.touren:this.sendNotification(o.TOUREN);break;case e.CustomPhotonEvents.tourenjieguo:var f=+i;this.gameState.role[1]&&n.actorNr==this.gameState.role[1].actorNr?this.gameState.touren[1]=this.gameState.seats[f]:this.gameState.role[2]&&n.actorNr==this.gameState.role[2].actorNr?this.gameState.touren[2]=this.gameState.seats[f]:this.gameState.role[3]&&n.actorNr==this.gameState.role[3].actorNr?this.gameState.touren[3]=this.gameState.seats[f]:this.gameState.role[4]&&n.actorNr==this.gameState.role[4].actorNr?this.gameState.touren[4]=this.gameState.seats[f]:this.gameState.role[5]&&n.actorNr==this.gameState.role[5].actorNr?this.gameState.touren[5]=this.gameState.seats[f]:this.gameState.role[6]&&n.actorNr==this.gameState.role[6].actorNr?this.gameState.touren[6]=this.gameState.seats[f]:this.gameState.role[7]&&n.actorNr==this.gameState.role[7].actorNr?this.gameState.touren[7]=this.gameState.seats[f]:this.gameState.role[8]&&n.actorNr==this.gameState.role[8].actorNr&&(this.gameState.touren[8]=this.gameState.seats[f]),this.sendNotification(o.TOUREN_JIEGUO,this.gameState.touren),console.log(this.gameState.touren),this.isMasterClient&&(console.log("CustomPhotonEvents.tourenjieguo: setCustomProperty"),this.loadBalancingClient.myRoom().setCustomProperty("gameState",this.gameState,!1,null));break;case e.CustomPhotonEvents.starttoupiao:this.sendNotification(o.START_TOUPIAO_BUTTON);break;case e.CustomPhotonEvents.UpdateCurrentTurn:this.gameState.seats.forEach(function(t){t&&(t.actorNr==n.actorNr||i.receiver==e.Receiver.All?t.action=i.action:i.updateOthers&&(t.action=""))}),this.isMasterClient&&this.loadBalancingClient.myRoom().setCustomProperty("gameState",this.gameState),this.sendNotification(o.PLAYER_UPDATE,this.gameState);break;case e.CustomPhotonEvents.UpdateCurrentActor:this.gameState.seats.forEach(function(e){e&&(e.actorNr==i.actorNr?e.action=i.action:i.updateOthers&&(e.action=""))}),this.isMasterClient&&this.loadBalancingClient.myRoom().setCustomProperty("gameState",this.gameState),this.sendNotification(o.PLAYER_UPDATE,this.gameState);break;case e.CustomPhotonEvents.DestroyRoom:this.leaveRoom(),this.sendNotification(e.SceneCommand.CHANGE,e.Scene.Start)}},o.prototype.startGame=function(){this.randomShuffle(this.gameState.baowulist),this.randomShuffle(this.gameState.onezj),this.randomShuffle(this.gameState.twozj),this.randomShuffle(this.gameState.threezj),this.gameState.hyyskill=_.random(1,3),this.gameState.mhjnskill=_.random(1,3);var t=this.gameState.seats.map(function(e,t){return{actor:e,index:t}}).filter(function(e,t){return e.actor}),o=_.random(0,t.length-1);this.gameState.firstOne=t[o].index,this.gameState.phase=e.GamePhase.GameInProgress,console.log("MasterClient startGame: setCustomProperty"),console.log(this.gameState.baowulist),console.log(this.gameState.onezj),console.log(this.gameState.twozj),console.log(this.gameState.threezj),this.loadBalancingClient.myRoom().setCustomProperty("gameState",this.gameState,!1,null),this.loadBalancingClient.sendMessage(e.CustomPhotonEvents.FirstOneNr,this.gameState.firstOne.toString())},o.prototype.generateRoomNumber=function(){var e=_.padStart(Math.floor(1e3*Math.random()).toString(),3,"0"),t=parseInt(""+e+(new Date).getMilliseconds()).toString(10);return _.padStart(t,6,"0").toUpperCase()},o.prototype.createRoomWithDefaultOptions=function(){this.loadBalancingClient.isInLobby()&&(console.log("Client is in lobby."),this.loadBalancingClient.createRoom(this.roomName,{isVisible:!0,isOpen:!0,maxPlayers:this.gameState.maxPlayers,suspendedPlayerLiveTime:-1,emptyRoomLiveTime:12e3,uniqueUserId:!0,propsListedInLobby:[]}),this.isCreating=!1)},o.prototype.createRoom=function(e){platform.showLoading(),this.roomName=this.generateRoomNumber(),(this.loadBalancingClient.state==Photon.LoadBalancing.LoadBalancingClient.State.Uninitialized||this.loadBalancingClient.state==Photon.LoadBalancing.LoadBalancingClient.State.Error)&&this.loadBalancingClient.start(),this.gameState.maxPlayers=e||this.gameState.maxPlayers,this.isCreating=!0,this.createRoomWithDefaultOptions()},o.prototype.getCurrentJoinToken=function(e){if(this.actorNr&&-1!=this.actorNr)return this.actorNr;if(this.loadBalancingClient.myActor().getJoinToken())return this.loadBalancingClient.myActor().getJoinToken();var t=platform.getStorage("currentRoom");return t&&t.roomName==e?t.actorNr:this.userInfo.unionId&&this.userInfo.unionId.substr(5)},o.prototype.joinRoom=function(e){if(platform.showLoading(),this.roomName=e,this.loadBalancingClient.isInLobby())console.log("Begin joinRoom: "+e),this.loadBalancingClient.joinRoom(e,{joinToken:this.getCurrentJoinToken(e)});else if(this.loadBalancingClient.isJoinedToRoom()){this.loadBalancingClient.myRoom().name;this.loadBalancingClient.myRoom().name==e?console.log("Already in room: "+e):(this.loadBalancingClient.leaveRoom(),this.loadBalancingClient.joinRoom(e))}else(this.loadBalancingClient.state==Photon.LoadBalancing.LoadBalancingClient.State.Uninitialized||this.loadBalancingClient.state==Photon.LoadBalancing.LoadBalancingClient.State.Error)&&this.loadBalancingClient.start()},o.prototype.suspendRoom=function(){this.gameState.phase!=e.GamePhase.Preparing?this.loadBalancingClient.sendMessage(e.CustomPhotonEvents.DestroyRoom):(this.leaveRoom(),this.sendNotification(e.SceneCommand.CHANGE,e.Scene.Start))},o.prototype.leaveRoom=function(){this.reset(),this.loadBalancingClient.leaveRoom()},o.prototype.reset=function(){this.roomName=void 0,this.actorNr=-1,this.loadBalancingClient.autoRejoin=!1,this.gameState=new e.GameState,this.resetPlayerInfo()},o.prototype.joinSeat=function(t){this.loadBalancingClient.sendMessage(e.CustomPhotonEvents.TakeSeat,t)},o.prototype.chooseRole=function(t){var o=t.oldRoleId,i=t.newRoleId;this.loadBalancingClient.sendMessage(e.CustomPhotonEvents.ChooseRole,{oldRoleId:o,newRoleId:i})},o.prototype.startChooseRole=function(){this.loadBalancingClient.sendMessage(e.CustomPhotonEvents.StartChoosingRole)},o.prototype.updateMyState=function(t,o,i){void 0===o&&(o=!1),this.loadBalancingClient.sendMessage(e.CustomPhotonEvents.UpdateCurrentTurn,{action:t,receiver:i,updateOthers:o})},o.prototype.updateActorState=function(t,o,i){void 0===i&&(i=!1),this.loadBalancingClient.sendMessage(e.CustomPhotonEvents.UpdateCurrentActor,{actorNr:t,action:o,updateOthers:i})},o.prototype.setSypiaoshu=function(e){this.loadBalancingClient.myActor().setCustomProperty("syPiaoshu",e)},o.prototype.getSyPiaoshu=function(){return this.loadBalancingClient.myActor().getCustomProperty("syPiaoshu")},o.prototype.updatePlayerInfo=function(t,o){var i=this.getPlayerInfo()||new e.PlayerInfo;i[t]=o,this.setPlayerInfo(i)},o.prototype.setPlayerInfo=function(e){this.loadBalancingClient.myActor().setCustomProperty("playerInfo",e)},o.prototype.resetPlayerInfo=function(){this.loadBalancingClient.myActor().setCustomProperty("playerInfo",new e.PlayerInfo)},o.prototype.getPlayerInfo=function(){return this.loadBalancingClient.myActor().getCustomProperty("playerInfo")},o.prototype.randomShuffle=function(e){e.sort(function(){return.5-Math.random()})},o.prototype.updateUserGameRecords=function(){return __awaiter(this,void 0,void 0,function(){var t,o,i,n,a=this;return __generator(this,function(r){switch(r.label){case 0:return t=this.gameState.role.findIndex(function(e){return a.isActorLocal(e)}),o=this.rolesMap.get(t.toString()).camp,i=o==e.gameCamp.xuyuan?this.gameState.defen>=6:this.gameState.defen<6,n=this.gameState.role.map(function(e,t){if(e){var n={userId:e.userId,camp:6>t?1:2,roleId:t,gameType:a.gameState.maxPlayers,isWin:a.rolesMap.get(t.toString()).camp==o?i:!i,roomName:a.roomName};return n}}).filter(function(e){return e}),[4,AccountAdapter.saveUserGameRecords(n)];case 1:return r.sent(),[2]}})})},o.NAME="GameProxy",o.PLAYER_UPDATE="player_update",o.SEAT_UPDATE="seat_update",o.CHOOSE_JS_END="choose_js_end",o.FIRST_ONE="first_one",o.NEXT_NR="next_nr",o.TONGZHI="tongzhi",o.BAOWU_TONGZHI="baowu_tongzhi",o.TOUPIAO_UI="toupiao_ui",o.ZONG_PIAOSHU="zong_piaoshu",o.INPUT_NUMBER="input_number",o.FINISH_INPUT="finish_input",o.PIAO_SHU="piao_shu",o.TOUPIAO_END="toupiao_end",o.START_TWO="start_two",o.ONE_YBRSKILL="one_ybrskill",o.ONE_ZGQSKILL="one_zgqskill",o.TOUREN="touren",o.TOUREN_JIEGUO="touren_jieguo",o.START_TOUPIAO_BUTTON="start_toupiao_button",o.ROLEING="roleing",o.AUTH_EDN="auth_end",o}(puremvc.Proxy);e.GameProxy=t,__reflect(t.prototype,"game.GameProxy",["puremvc.IProxy","puremvc.INotifier"])}(game||(game={}));var game;!function(e){var t="f0e09630-c30e-4d9d-8d60-64d91ebf642b",o="1.0",i=!0,n=function(n){function a(){var i=n.call(this,a.photonWss?Photon.ConnectionProtocol.Wss:Photon.ConnectionProtocol.Ws,t,o)||this;return i.retried=0,i.maxRetriedCount=3,i.setupId=0,i.logger=new Exitgames.Common.Logger("Info:"),i.USERCOLORS=["#FF0000","#00AA00","#0000FF","#FFFF00","#00FFFF","#FF00FF"],i.stateChangeSubject=function(){},i.updateRoomInfoSubject=function(){},i.onJoinRoomSubject=function(){},i.receiveMessageSubject=function(e,t,o){},i.onOperationResponseSubject=function(e){},e.Constants.photonNameServer&&i.setNameServerAddress(e.Constants.photonNameServer),i.setLogLevel(Exitgames.Common.Logger.Level.ERROR),i}return __extends(a,n),Object.defineProperty(a,"photonWss",{get:function(){return"prod"==platform.env},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"autoRejoin",{get:function(){return platform.getStorage("autoRejoin")},set:function(e){platform.setStorage("autoRejoin",e)},enumerable:!0,configurable:!0}),a.prototype.start=function(){i&&(this.output(this.logger.format("Init",e.Constants.photonMasterServer||this.getNameServerAddress(),o)),this.logger.info("Init",e.Constants.photonMasterServer||this.getNameServerAddress(),o),e.Constants.photonMasterServer?(this.setMasterServerAddress(e.Constants.photonMasterServer),this.connect()):this.connectToRegionMaster(e.Constants.photonRegion))},a.prototype.onError=function(e,t){var o=this;platform.hideAllBannerAds(),platform.hideLoading(),console.log("retried count:",this.retried),this.output("Error "+e+": "+t),platform.isConnected&&(1003==e?++this.retried<this.maxRetriedCount?this.start():platform.showModal("服务器连接已重置,请检查网络或尝试重连","重试","取消").then(function(e){e&&e.confirm?(o.retried=0,o.autoRejoin=!1,o.start()):e&&e.cancel&&(o.autoRejoin=!1)}):1004==e?++this.retried<this.maxRetriedCount?this.start():platform.showModal("服务器连接超时,请检查网络或尝试重连","重试","取消").then(function(e){e&&e.confirm?(o.retried=0,o.start()):e&&e.cancel&&(o.autoRejoin=!1)}):++this.retried<this.maxRetriedCount?this.start():platform.showModal("服务器连接失败,请检查网络或尝试重连","重试","取消").then(function(e){e&&e.confirm?(o.retried=0,o.start()):e&&e.cancel&&(o.autoRejoin=!1)}))},a.prototype.onEvent=function(t,o,i){var n=this.myRoomActors()[i];switch(t){case e.CustomPhotonEvents.UserMessage:i?this.output(i+": "+o,n.getCustomProperty("color")):this.output(i+": "+o);break;case e.CustomPhotonEvents.UserStartGame:this.output(i+": started the game",this.myRoomActors()[i].getCustomProperty("color"));break;case e.CustomPhotonEvents.EventRequestGameStates:this.raiseEvent(e.CustomPhotonEvents.EventLoadSceneItemFromServer,null,{targetActors:[i]});break;default:this.receiveMessageSubject(t,o,n)}this.logger.debug("onEvent",t,"message:",o,"actor:",i)},a.prototype.updateUserIdAndNickname=function(e,t){n.prototype.updateUserIdAndNickname.call(this,e,t);var o=e[Photon.LoadBalancing.Constants.ParameterCode.Data];this.myActor().setCustomProperty("data",o)},a.prototype.onOperationResponse=function(e,t,o,i){if(n.prototype.onOperationResponse.call(this,e,t,o,i),e){switch(console.error(t),e){case 32746:platform.showToast("不能重复加入"),this.autoRejoin=!1;break;case 32748:platform.showToast("房间已关闭"),this.autoRejoin=!1;break;case 32758:this.autoRejoin=!1,platform.showToast("房间不存在");break;case 32765:this.autoRejoin=!1,platform.showToast("房间已满");break;case 32752:this.autoRejoin=!1,platform.showToast("无法加入该房间");break;default:platform.showToast("Code: "+e)}this.onOperationResponseSubject&&this.onOperationResponseSubject(e)}switch(o){case Photon.LoadBalancing.Constants.OperationCode.Authenticate:console.log(i)}},a.prototype.onStateChange=function(e){this.stateChangeSubject()},a.prototype.updateRoomInfo=function(){this.updateRoomInfoSubject()},a.prototype.objToStr=function(e){var t="";for(var o in e)t+=(""==t?"":" ,")+o+"="+e[o];return t},a.prototype.onActorPropertiesChange=function(e){this.updateRoomInfo()},a.prototype.onMyRoomPropertiesChange=function(){this.updateRoomInfo()},a.prototype.onRoomListUpdate=function(e,t,o,i){this.logger.info("Info: onRoomListUpdate",e,t,o,i),this.output("Info: Rooms update: "+t.length+" updated, "+o.length+" added, "+i.length+" removed"),this.onRoomList(e)},a.prototype.onRoomList=function(e){this.output("Info: Rooms total: "+e.length)},a.prototype.onJoinRoom=function(){var e=this.USERCOLORS[this.myRoomActorCount()-1];this.myActor().setCustomProperty("color",e),this.output("Game "+this.myRoom().name+" joined",e);var t=this.myActor().getCustomProperty("data");this.toggleActorState(this.myActor().name,t&&t.Avatar,!0),this.myRoom().getCustomProperty("setupId")||this.myRoom().setCustomProperty("setupId",this.setupId),this.onJoinRoomSubject(),this.updateRoomInfo()},a.prototype.onActorJoin=function(e){this.output("Actor "+(e.name||e.actorNr)+" joined",e.getCustomProperty("color")),this.updateRoomInfo()},a.prototype.onActorLeave=function(e){this.output("Actor "+(e.name||e.actorNr)+" left",e.getCustomProperty("color")),this.updateRoomInfo()},a.prototype.onActorSuspend=function(e){this.output("Actor "+(e.name||e.actorNr)+" suspended",e.getCustomProperty("color")),platform.showToast(e.getCustomProperty("nickName")+"已挂起");var t=this.myActor().getCustomProperty("data");this.toggleActorState(e.name,t&&t.Avatar,!1),this.updateRoomInfo()},a.prototype.toggleActorState=function(e,t,o){var i=this.myRoom().getCustomProperty("myRoomActorStates")||[],n=_.keyBy(i,"name")||{};n[e]=n[e]||{name:e,avatar:t},n[e].active=o,this.myRoom().setCustomProperty("myRoomActorStates",_.toArray(n),!0)},a.prototype.getActorState=function(e){var t=this.myRoom().getCustomProperty("myRoomActorStates")||[],o=_.keyBy(t,"name")||{};return o[e]&&o[e].active},a.prototype.sendMessage=function(e,t){try{this.raiseEvent(e,t,{receivers:Photon.LoadBalancing.Constants.ReceiverGroup.All}),this.output("me["+(this.myActor().name||this.myActor().actorNr)+"]: "+JSON.stringify(t),this.myActor().getCustomProperty("color"))}catch(o){this.output("error: "+o.message)}},a.prototype.startGame=function(){try{this.raiseEvent(e.CustomPhotonEvents.UserStartGame,{message:"",sender:this.myActor().actorNr}),this.output("me["+(this.myActor().name||this.myActor().actorNr)+"]: start the game",this.myActor().getCustomProperty("color"))}catch(t){this.output("error: "+t.message)}},a.prototype.output=function(e,t){e.replace(/&/,"&amp;").replace(/</,"&lt;").replace(/>/,"&gt;").replace(/"/,"&quot;");console.log(e)},a}(Photon.LoadBalancing.LoadBalancingClient);e.MyLoadBalancingClient=n,__reflect(n.prototype,"game.MyLoadBalancingClient")}(game||(game={}));var game;!function(e){var t=function(){function e(e,t){e&&(this.actorNr=e.actorNr,this.userId=e.getCustomProperty("userId"),this.name=e.getCustomProperty("nickName"),this.avatarUrl=e.getCustomProperty("avatarUrl"),this.seatNumber=t)}return e}();e.ActorModel=t,__reflect(t.prototype,"game.ActorModel")}(game||(game={}));var game;!function(e){var t=function(){function e(){}return e}();e.Club=t,__reflect(t.prototype,"game.Club")}(game||(game={}));var game;!function(e){var t=function(){function e(){}return e.logon={},e}();e.CommonData=t,__reflect(t.prototype,"game.CommonData")}(game||(game={}));var game;!function(e){var t=function(){function e(){}return Object.defineProperty(e,"photonConfig",{get:function(){return e._photonConfig||(e._photonConfig=new Map(Object.entries(RES.getRes("photon_json")))),e._photonConfig},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ResourceEndpoint",{get:function(){return"local"==platform.env||"dev"==platform.env||"wxgame"!=platform.name?this.Endpoints.localResource:this.Endpoints.remoteResource},enumerable:!0,configurable:!0}),Object.defineProperty(e,"photonMasterServer",{get:function(){return"local"==platform.env||"dev"==platform.env?this.photonConfig.get("localMasterServer"):this.photonConfig.get("photonMasterServer")},enumerable:!0,configurable:!0}),Object.defineProperty(e,"photonNameServer",{get:function(){return this.photonConfig.get("photonNameServer")},enumerable:!0,configurable:!0}),Object.defineProperty(e,"photonRegion",{get:function(){return this.photonConfig.get("photonRegion")},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Endpoints",{get:function(){return"local"==platform.env?{service:"http://localhost:4040/",localResource:"",remoteResource:"http://localhost:4040/miniGame/",ws:"ws://192.168.2.117:9090",wss:"wss://192.168.2.117:9090"}:"dev"==platform.env?{service:"http://gdjzj.hzsdgames.com:8090/",localResource:"",remoteResource:"http://gdjzj.hzsdgames.com:8090/miniGame/",ws:"ws://192.168.2.202:9090",wss:"wss://192.168.2.202:9090"}:"prod"==platform.env?{service:"https://gdjzj.hzsdgames.com:8084/",localResource:"",remoteResource:"https://gdjzj.hzsdgames.com:8084/miniGame/",ws:"ws://photon.hzsdgames.com:19090",wss:"wss://photon.hzsdgames.com:19090"}:"test"==platform.env?{service:"http://gdjzj.hzsdgames.com:8090/",localResource:"",remoteResource:"http://gdjzj.hzsdgames.com:8090/miniGame/",ws:"ws://photon.hzsdgames.com:19090",wss:"wss://photon.hzsdgames.com:19090"}:void 0},enumerable:!0,configurable:!0}),e}();e.Constants=t,__reflect(t.prototype,"game.Constants"),e.gameType={six:"六人局",seven:"七人局",eight:"八人局"},e.gameCamp={xuyuan:"许愿阵营",laochaofen:"老朝奉阵营"};var o;!function(e){e[e.XuYuan=1]="XuYuan",e[e.FangZheng=2]="FangZheng",e[e.JiYunFu=3]="JiYunFu",e[e.HuangYanYan=4]="HuangYanYan",e[e.MuHuJiaNai=5]="MuHuJiaNai",e[e.LaoChaoFen=6]="LaoChaoFen",e[e.YaoBuRan=7]="YaoBuRan",e[e.ZhengGuoQu=8]="ZhengGuoQu"}(o=e.RoleId||(e.RoleId={})),e.GameInfo={attacked:"被药不然偷袭",attack:"你偷袭了",hide:"你隐藏了",reverse:"你调换了真假信息",skipSkill:"你跳过了技能",cannotJudge:"无法鉴定"}}(game||(game={}));var game;!function(e){var t;!function(e){e[e.UserMessage=0]="UserMessage",e[e.UserStartGame=1]="UserStartGame",e[e.EventRequestGameStates=2]="EventRequestGameStates",e[e.EventLoadSceneItemFromServer=3]="EventLoadSceneItemFromServer",e[e.TakeSeat=4]="TakeSeat",e[e.StartChoosingRole=5]="StartChoosingRole",e[e.ChooseRole=6]="ChooseRole",e[e.StartGame=7]="StartGame",e[e.FirstOneNr=8]="FirstOneNr",e[e.nextNr=9]="nextNr",e[e.twogameend=10]="twogameend",e[e.threegameend=11]="threegameend",e[e.tongzhi=12]="tongzhi",e[e.baowutongzhi=13]="baowutongzhi",e[e.toupiaoui=14]="toupiaoui",e[e.piaoshu=15]="piaoshu",e[e.piaoshu2=16]="piaoshu2",e[e.piaoshu3=17]="piaoshu3",e[e.toupiaoend=18]="toupiaoend",e[e.toupiaoend2=19]="toupiaoend2",e[e.toupiaoend3=20]="toupiaoend3",e[e.starttwo=21]="starttwo",e[e.startgametongbu=22]="startgametongbu",e[e.onelcftongbu=23]="onelcftongbu",e[e.oneybrtongbu=24]="oneybrtongbu",e[e.onezgqtongbu=25]="onezgqtongbu",e[e.twolcftongbu=26]="twolcftongbu",e[e.twoybrtongbu=27]="twoybrtongbu",e[e.twozgqtongbu=28]="twozgqtongbu",e[e.threelcftongbu=29]="threelcftongbu",e[e.threeybrtongbu=30]="threeybrtongbu",e[e.threezgqtongbu=31]="threezgqtongbu",e[e.lunci=32]="lunci",e[e.touren=33]="touren",e[e.tourenjieguo=34]="tourenjieguo",e[e.starttoupiao=35]="starttoupiao",e[e.UpdateCurrentTurn=36]="UpdateCurrentTurn",e[e.UpdateCurrentActor=37]="UpdateCurrentActor",e[e.DestroyRoom=38]="DestroyRoom",e[e.userinfo=39]="userinfo"}(t=e.CustomPhotonEvents||(e.CustomPhotonEvents={}))}(game||(game={}));var game;!function(e){var t=function(){function e(){}return e}();e.MyStats=t,__reflect(t.prototype,"game.MyStats")}(game||(game={}));var game;!function(e){e.OrderType={winRate:"winRate",countTotal:"countTotal"}}(game||(game={}));var game;!function(e){var t=function(){function e(){this.zhenying="",this.juese="",this.onebaowu="",this.onezhenjia="",this.onebaowu2="",this.onezhenjia2="",this.touxi1=!1,this.twobaowu="",this.twozhenjia="",this.twobaowu2="",this.twozhenjia2="",this.touxi2=!1,this.threebaowu="",this.threezhenjia="",this.threebaowu2="",this.threezhenjia2="",this.touxi3=!1,this.skipskill1=!1,this.skipskill2=!1,this.skipskill3=!1,this.sypiaoshu=0}return e}();e.PlayerInfo=t,__reflect(t.prototype,"game.PlayerInfo")}(game||(game={}));var game;!function(e){var t=function(){function e(){}return e}();e.Rank=t,__reflect(t.prototype,"game.Rank")}(game||(game={}));var game;!function(e){var t;!function(e){e[e.Self=0]="Self",e[e.All=1]="All"}(t=e.Receiver||(e.Receiver={}))}(game||(game={}));var game;!function(e){var t=function(){function e(){}return e}();e.Role=t,__reflect(t.prototype,"game.Role")}(game||(game={}));var game;!function(e){var t;!function(e){e[e.Start=1]="Start",e[e.Game=2]="Game"}(t=e.Scene||(e.Scene={}))}(game||(game={}));var game;!function(e){var t=function(){function e(){}return e}();e.UserInfo=t,__reflect(t.prototype,"game.UserInfo")}(game||(game={}));var game;!function(e){var t;!function(e){e[e.Preparing=1]="Preparing",e[e.ChoosingRole=2]="ChoosingRole",e[e.GameInProgress=3]="GameInProgress"}(t=e.GamePhase||(e.GamePhase={}))}(game||(game={}));var game;!function(e){var t=function(){function t(){this.roomName=void 0,this.players=0,this.maxPlayers="local"==platform.env||"dev"==platform.env?2:8,this.phase=e.GamePhase.Preparing,this.seats=[],this.role=[],this.touren=[],this.shunwei_one_been=[],this.shunwei_two_been=[],this.shunwei_three_been=[],this.toupiao=[],this.toupiao2=[],this.toupiao3=[],this.baowulist=["鼠","牛","虎","兔","龙","蛇","马","羊","猴","鸡","狗","猪"],this.baowulist2=["鼠","牛","虎","兔","龙","蛇","马","羊","猴","鸡","狗","猪"],this.toupiaojieguo1=[],this.toupiaojieguo2=[],this.toupiaojieguo3=[],this.onezj=["真","真","假","假"],this.twozj=["真","真","假","假"],this.threezj=["真","真","假","假"],this.hyyskill=100,this.mhjnskill=100,this.firstOne=0,this.onelcfskill=!1,this.twolcfskill=!1,this.threelcfskill=!1,this.oneybrskill=0,this.twoybrskill=0,this.threeybrskill=0,this.onezgqskill=100,this.twozgqskill=100,this.threezgqskill=100,this.lunci=1,this.defen=0,this.lcfpiao=0,this.findPeopleScore=0,this.jueselist=["许愿","方震","姬云浮","黄烟烟","木户加奈","老朝奉","药不然","郑国渠"],this.ybrskill=[0,0,0,0,0,0,0,0,0],this.jyfskill=!0,this.playerInfor=[]}return t}();e.GameState=t,__reflect(t.prototype,"game.GameState")}(game||(game={}));var game;!function(e){var t=function(){function e(){}return e.createDragonBone=function(e,t){var o=dragonBones.EgretFactory.factory;if(!o.getDragonBonesData(e)){var i=RES.getRes(e+"_ske_json");o.parseDragonBonesData(i)}if(!o.getTextureAtlasData(e)){var n=RES.getRes(e+"_tex_json"),a=RES.getRes(e+"_tex_png");o.parseTextureAtlasData(n,a)}var r=o.buildArmatureDisplay(t);return r},e}();e.DragonBones=t,__reflect(t.prototype,"game.DragonBones")}(game||(game={}));var game;!function(e){var t=function(e){function t(o){return e.call(this,t.NAME,o)||this}return __extends(t,e),t.prototype.listNotificationInterests=function(){return[]},t.prototype.handleNotification=function(e){e.getName()},Object.defineProperty(t.prototype,"main",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),t.NAME="ApplicationMediator",t}(puremvc.Mediator);e.ApplicationMediator=t,__reflect(t.prototype,"game.ApplicationMediator",["puremvc.IMediator","puremvc.INotifier"])}(game||(game={}));var game;!function(e){var t=function(t){function o(e){var i=t.call(this,o.NAME,e)||this;return i.provinceList=[{name:"四川省"}],i.cityList=[{name:"成都市"}],i.districtList=[{name:"成华区"}],t.prototype.initializeNotifier.call(i,"ApplicationFacade"),i.barWindow.backButton.addEventListener(egret.TouchEvent.TOUCH_TAP,i.backButtonClick,i),i.barWindow.provinceGroup.addEventListener(egret.TouchEvent.TOUCH_TAP,i.showProvinceList,i),i.barWindow.cityGroup.addEventListener(egret.TouchEvent.TOUCH_TAP,i.showCityList,i),i.barWindow.districtGroup.addEventListener(egret.TouchEvent.TOUCH_TAP,i.showDistrictList,i),i.barWindow.listProvince.addEventListener(eui.ItemTapEvent.ITEM_TAP,i.selectProvince,i),i.barWindow.listCity.addEventListener(eui.ItemTapEvent.ITEM_TAP,i.selectCity,i),i.barWindow.listDistrict.addEventListener(eui.ItemTapEvent.ITEM_TAP,i.selectDistrict,i),i.initData(),i}return __extends(o,t),Object.defineProperty(o.prototype,"allClubs",{get:function(){return this._allClubs||(this._allClubs=RES.getRes("clubs_json")),this._allClubs},enumerable:!0,configurable:!0}),o.prototype.initData=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return this.barWindow.showListProvince=this.barWindow.showListCity=this.barWindow.showListDistrict=!1,this.refresh(),this.refreshProvinces(),[2]})})},o.prototype.refresh=function(){var t=this;this.clubList=this.allClubs.filter(function(e){return!t.selectedProvince||e.province==t.selectedProvince}).filter(function(e){return!t.selectedCity||e.city==t.selectedCity}).filter(function(e){return!t.selectedDistrict||e.district==t.selectedDistrict}).map(function(e){return{clubName:e.name,time:e.time,phone:e.phone,attr:e.attr,game_1:"club_game1_"+("1"==e.game_1?1:2),game_2:"club_game2_"+("1"==e.game_2?1:2),game_3:"club_game3_"+("1"==e.game_3?1:2),game_4:"club_game4_"+("1"==e.game_4?1:2)}}),this.barWindow.listClub.dataProvider=new eui.ArrayCollection(this.clubList),this.barWindow.listClub.itemRenderer=e.ClubListItemRenderer},o.prototype.refreshProvinces=function(){var t=_(this.allClubs.map(function(e){return e.province
})).uniq().value().map(function(e){return{name:e}});this.barWindow.listProvince.dataProvider=new eui.ArrayCollection(t),this.barWindow.listProvince.itemRenderer=e.CityItemRenderer,this.refreshCities()},o.prototype.refreshCities=function(){var t=this,o=_(this.allClubs.filter(function(e){return!e.province||e.province==t.selectedProvince}).map(function(e){return e.city})).uniq().value().map(function(e){return{name:e}});this.barWindow.listCity.dataProvider=new eui.ArrayCollection(o),this.barWindow.listCity.itemRenderer=e.CityItemRenderer,this.barWindow.city=this.selectedCity="",this.refreshDistrict()},o.prototype.refreshDistrict=function(){var t=this,o=_(this.allClubs.filter(function(e){return!e.city||e.city==t.selectedCity}).map(function(e){return e.district})).uniq().value().map(function(e){return{name:e}});this.barWindow.listDistrict.dataProvider=new eui.ArrayCollection(o),this.barWindow.listDistrict.itemRenderer=e.CityItemRenderer,this.barWindow.district=this.selectedDistrict=""},o.prototype.showProvinceList=function(e){this.barWindow.showListProvince=!this.barWindow.showListProvince,this.barWindow.showListCity=this.barWindow.showListDistrict=!1},o.prototype.showCityList=function(e){this.barWindow.showListCity=!this.barWindow.showListCity,this.barWindow.showListProvince=this.barWindow.showListDistrict=!1},o.prototype.showDistrictList=function(e){this.barWindow.showListDistrict=!this.barWindow.showListDistrict,this.barWindow.showListCity=this.barWindow.showListProvince=!1},o.prototype.selectProvince=function(e){this.barWindow.showListProvince=!1,this.selectedProvince!=e.item.name&&(this.barWindow.province=this.selectedProvince=e.item.name,this.refreshCities(),this.refresh())},o.prototype.selectCity=function(e){this.barWindow.showListCity=!1,this.selectedCity!=e.item.name&&(this.barWindow.city=this.selectedCity=e.item.name,this.refreshDistrict(),this.refresh())},o.prototype.selectDistrict=function(e){this.selectedDistrict!=e.item.name&&(this.barWindow.showListDistrict=!1,this.barWindow.district=this.selectedDistrict=e.item.name,this.refresh())},o.prototype.backButtonClick=function(e){this.barWindow.close()},o.prototype.listNotificationInterests=function(){return[]},o.prototype.handleNotification=function(e){e.getBody()},Object.defineProperty(o.prototype,"barWindow",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),o.NAME="BarWindowMediator",o}(puremvc.Mediator);e.BarWindowMediator=t,__reflect(t.prototype,"game.BarWindowMediator",["puremvc.IMediator","puremvc.INotifier"])}(game||(game={}));var game;!function(e){var t=function(){function e(){}return Object.defineProperty(e,"grey",{get:function(){var e=[.15,.3,0,0,0,.15,.3,0,0,0,.15,.3,0,0,0,0,0,0,1,0],t=new egret.ColorMatrixFilter(e);return t},enumerable:!0,configurable:!0}),e}();e.ColorFilter=t,__reflect(t.prototype,"game.ColorFilter")}(game||(game={}));var game;!function(e){var t=[{controlName:"Anim1",index:0},{controlName:"Anim2",index:1},{controlName:"Anim3",index:2},{controlName:"Anim4",index:3},{controlName:"Anim5",index:4},{controlName:"Anim6",index:5},{controlName:"Anim7",index:6},{controlName:"Anim8",index:7},{controlName:"Anim9",index:8},{controlName:"Anim10",index:9},{controlName:"Anim11",index:10},{controlName:"Anim12",index:11}],o=function(o){function i(e){var t=o.call(this,i.NAME,e)||this;return t.skillAnimAdded=!1,t.selectedAnims=[],t.baowu1=0,t.baowu2=0,t.baowu3=0,t.baowu4=0,t.sypiaoshu=0,t.muqianpiaoshu=0,o.prototype.initializeNotifier.call(t,"ApplicationFacade"),t.gameScreen.addEventListener(egret.Event.ADDED_TO_STAGE,t.initData,t),t.gameScreen.btnGuide.addEventListener(egret.TouchEvent.TOUCH_TAP,t.showGuide,t),t.gameScreen.btnQuit.addEventListener(egret.TouchEvent.TOUCH_TAP,t.quitClick,t),t.gameScreen.btnGameInfo.addEventListener(egret.TouchEvent.TOUCH_TAP,t.showGameInfo,t),t.gameScreen.btnGameRecord.addEventListener(egret.TouchEvent.TOUCH_TAP,t.showGameRecord,t),t.findSeat(),t}return __extends(i,o),i.prototype.initData=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return console.log("GameScreen initData"),this.proxy=this.facade().retrieveProxy(e.GameProxy.NAME),this.skillAnimAdded=!1,this.gameScreen.isLastPlayer=!1,this.updateGameScreen(this.proxy.gameState),[2]})})},i.prototype.showGuide=function(){this.sendNotification(e.SceneCommand.SHOW_GUIDE_WINDOW)},i.prototype.quitClick=function(){this.sendNotification(e.SceneCommand.SHOW_HANDLE_POPUP,!0)},i.prototype.showGameInfo=function(){this.sendNotification(e.SceneCommand.SHOW_GAMEINFO_POPUP)},i.prototype.showGameRecord=function(){this.sendNotification(e.SceneCommand.SHOW_VOTERECORD_WINDOW)},i.prototype.listNotificationInterests=function(){return[e.GameProxy.PLAYER_UPDATE,e.GameProxy.SEAT_UPDATE,e.GameProxy.FIRST_ONE,e.GameProxy.NEXT_NR,e.GameProxy.TONGZHI,e.GameProxy.BAOWU_TONGZHI,e.GameProxy.TOUPIAO_UI,e.GameProxy.PIAO_SHU,e.GameProxy.ZONG_PIAOSHU,e.GameProxy.START_TWO,e.GameProxy.ONE_YBRSKILL,e.GameProxy.ONE_ZGQSKILL,e.GameProxy.TOUREN,e.GameProxy.TOUREN_JIEGUO,e.GameCommand.JOIN_ROOM,e.GameProxy.START_TOUPIAO_BUTTON,e.GameProxy.ROLEING,e.GameProxy.AUTH_EDN]},i.prototype.handleNotification=function(t){var o=t.getBody();switch(t.getName()){case e.GameProxy.PLAYER_UPDATE:this.updateGameScreen(o);break;case e.GameProxy.SEAT_UPDATE:this.touxiang(o);break;case e.GameProxy.FIRST_ONE:this.first_one(o);break;case e.GameProxy.NEXT_NR:this.shunwei2(o);break;case e.GameProxy.TONGZHI:this.tongzhi(o);break;case e.GameProxy.BAOWU_TONGZHI:this.baowu_tongzhi(o);break;case e.GameProxy.TOUPIAO_UI:this.toupiaoui();break;case e.GameProxy.PIAO_SHU:this.piaoshujisuan(o);break;case e.GameProxy.ZONG_PIAOSHU:this.toupiaoend(o);break;case e.GameProxy.START_TWO:this.starttwo();break;case e.GameProxy.ONE_YBRSKILL:this.ybrskilladd(o);break;case e.GameProxy.ONE_ZGQSKILL:break;case e.GameProxy.TOUREN:this.tourenui();break;case e.GameProxy.TOUREN_JIEGUO:this.tourenjieguo(o);break;case e.GameCommand.JOIN_ROOM:this.initData();break;case e.GameProxy.START_TOUPIAO_BUTTON:this.start_toupiao_button();break;case e.GameProxy.ROLEING:this.roleing(o);break;case e.GameProxy.AUTH_EDN:this.isWaitTouRen()}},i.prototype.updateGameScreen=function(t){var o=this;this.gameScreen.roomName=this.proxy.roomName,this.gameScreen.isMasterClient=this.proxy.isMasterClient,this.gameScreen.isNormalClient=!this.proxy.isMasterClient,this.gameScreen.currentPlayers=t.players,this.gameScreen.maxPlayers=t.maxPlayers;var i=this.proxy.gameState.seats.filter(function(e){return e&&void 0!==e.actorNr}),n=this.proxy.gameState.role.filter(function(e){return e&&void 0!=e.actorNr}),a=i.length==t.maxPlayers,r=n.length==t.maxPlayers,s=!a&&this.proxy.gameState.seats.some(function(e){return e&&e.actorNr==o.proxy.actorNr});if(r){var u=t.role.findIndex(function(e){return o.proxy.isActorLocal(e)});if(this.myRole=this.proxy.rolesMap.get(u.toString()),this.gameScreen.role=this.myRole,this.gameScreen.isNotFangZhen="方震"!=this.myRole.name,this.gameScreen.isFangZhen="方震"==this.myRole.name,this.gameScreen.isYaoBuran="药不然"==this.myRole.name,this.gameScreen.isZhengGuoqu="郑国渠"==this.myRole.name,i.forEach(function(e){o.gameScreen["ybrskill"+e.seatNumber].update(e),o.gameScreen["fangzhenskill"+e.seatNumber].update(e),o.gameScreen["shunwei"+e.seatNumber].update(e)}),!this.skillAnimAdded){var h=this.gameScreen.btnSkill.getChildByName("dragonBone");h&&this.gameScreen.btnSkill.removeChild(h);var c=e.DragonBones.createDragonBone("skills",this.myRole.skillRes);c.name="dragonBone",c.animation.play(this.myRole.skillRes,0),c.animation.animationConfig.timeScale=.5,c.x=250,c.y=120,c.scaleX=.5,c.scaleY=.5,this.gameScreen.btnSkill.addChild(c),this.skillAnimAdded=!0}}switch(t.phase){case e.GamePhase.Preparing:this.gameScreen.isInitial=!s&&!a,this.gameScreen.isWaiting=s,this.gameScreen.isAllReady=a,this.gameScreen.isAllRolesReady=!1,this.gameScreen.canChooseSeat=!0,this.gameScreen.isChoosingRole=!1,this.gameScreen.isChoosingRoleandSeven=!1,this.gameScreen.isChoosingRoleandEight=!1,this.gameScreen.isChoosingRoleOrMasterClient=!1,this.gameScreen.isAllRolesReadyAndNormalClient=!1,this.gameScreen.isPhasePreparing=!0,this.gameScreen.isPhaseChoosingRole=!1,this.gameScreen.isPhaseGameInProgress=!1,this.gameScreen.isMyTurn=!1,this.gameScreen.isOthersTurn=!1;break;case e.GamePhase.ChoosingRole:this.gameScreen.isInitial=!1,this.gameScreen.isWaiting=!1,this.gameScreen.isAllReady=!1,this.gameScreen.isAllRolesReady=r,this.gameScreen.canChooseSeat=!1,this.gameScreen.isChoosingRole=!r,this.gameScreen.isChoosingRoleandSeven=!r&&(7==this.proxy.gameState.maxPlayers||8==this.proxy.gameState.maxPlayers),this.gameScreen.isChoosingRoleandEight=!r&&8==this.proxy.gameState.maxPlayers,this.gameScreen.btnjs3.filters=8!=this.proxy.gameState.maxPlayers?[e.ColorFilter.grey]:[],this.gameScreen.btnjs8.filters=6==this.proxy.gameState.maxPlayers?[e.ColorFilter.grey]:[],this.gameScreen.isChoosingRoleOrMasterClient=!r||this.gameScreen.isMasterClient,this.gameScreen.isAllRolesReadyAndNormalClient=r&&this.gameScreen.isNormalClient,this.gameScreen.isPhasePreparing=!1,this.gameScreen.isPhaseChoosingRole=!0,this.gameScreen.isPhaseGameInProgress=!1,this.gameScreen.isMyTurn=!1,this.gameScreen.isOthersTurn=!1,6==this.proxy.gameState.maxPlayers?(this.gameScreen.btnjs3.enabled=!1,this.gameScreen.btnjs8.enabled=!1):7==this.proxy.gameState.maxPlayers&&(this.gameScreen.btnjs3.enabled=!1);break;case e.GamePhase.GameInProgress:this.gameScreen.isInitial=!1,this.gameScreen.isWaiting=!1,this.gameScreen.isAllReady=!1,this.gameScreen.isAllRolesReady=!1,this.gameScreen.canChooseSeat=!1,this.gameScreen.isChoosingRole=!1,this.gameScreen.isChoosingRoleandSeven=!1,this.gameScreen.isChoosingRoleandEight=!1,this.gameScreen.isChoosingRoleOrMasterClient=!1,this.gameScreen.isAllRolesReadyAndNormalClient=!1,this.gameScreen.isPhasePreparing=!1,this.gameScreen.isPhaseChoosingRole=!1,this.gameScreen.isPhaseGameInProgress=!0,this.gameScreen.isFirstRound=1==t.lunci,this.gameScreen.isSecondRound=2==t.lunci,this.gameScreen.isThirdRound=3==t.lunci;var l=this.proxy.gameState.seats.find(function(e){return e&&e.actorNr==o.proxy.actorNr});this.setMyTurnState(t.seats);var p=l.action;p!=this.previousAction&&(this.previousAction=p,this.setAnims(),this.setChoosingNextOrVotingPersonUI(),this.setToupiaoUI(),this.tourenjieguo2(this.proxy.gameState.touren)),this.gameScreen.isWaitNextTurnOrWaitTouRen=this.gameScreen.isWaitNextTurn||this.gameScreen.isWaitTouRen}this.touxiang(t.seats)},Object.defineProperty(i.prototype,"gameScreen",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),i.prototype.findSeat=function(){var e=this;this.gameScreen.btnSeat1.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.findSeat2("1")},this),this.gameScreen.btnSeat2.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.findSeat2("2")},this),this.gameScreen.btnSeat3.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.findSeat2("3")},this),this.gameScreen.btnSeat4.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.findSeat2("4")},this),this.gameScreen.btnSeat5.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.findSeat2("5")},this),this.gameScreen.btnSeat6.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.findSeat2("6")},this),this.gameScreen.btnSeat7.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.findSeat2("7")},this),this.gameScreen.btnSeat8.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.findSeat2("8")},this),this.gameScreen.startjs.addEventListener(egret.TouchEvent.TOUCH_TAP,this.startChooseRole,this),this.gameScreen.btnjs1.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.chooseRole(1)},this),this.gameScreen.btnjs2.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.chooseRole(2)},this),this.gameScreen.btnjs3.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.chooseRole(3)},this),this.gameScreen.btnjs4.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.chooseRole(4)},this),this.gameScreen.btnjs5.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.chooseRole(5)},this),this.gameScreen.btnjs6.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.chooseRole(6)},this),this.gameScreen.btnjs7.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.chooseRole(7)},this),this.gameScreen.btnjs8.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.chooseRole(8)},this),this.gameScreen.startgame.addEventListener(egret.TouchEvent.TOUCH_TAP,this.startGame,this),this.gameScreen.Anim1.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){e.chooseAnimReal(0,t)},this),this.gameScreen.Anim2.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){e.chooseAnimReal(1,t)},this),this.gameScreen.Anim3.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){e.chooseAnimReal(2,t)},this),this.gameScreen.Anim4.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){e.chooseAnimReal(3,t)},this),this.gameScreen.Anim5.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){e.chooseAnimReal(4,t)},this),this.gameScreen.Anim6.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){e.chooseAnimReal(5,t)},this),this.gameScreen.Anim7.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){e.chooseAnimReal(6,t)},this),this.gameScreen.Anim8.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){e.chooseAnimReal(7,t)},this),this.gameScreen.Anim9.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){e.chooseAnimReal(8,t)},this),this.gameScreen.Anim10.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){e.chooseAnimReal(9,t)},this),this.gameScreen.Anim11.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){e.chooseAnimReal(10,t)},this),this.gameScreen.Anim12.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){e.chooseAnimReal(11,t)},this),this.gameScreen.btnAuth.addEventListener(egret.TouchEvent.TOUCH_TAP,this.chooseAnim,this),this.gameScreen.btnSkipAuth.addEventListener(egret.TouchEvent.TOUCH_TAP,this.skipAuth,this),this.gameScreen.btnSkill.addEventListener(egret.TouchEvent.TOUCH_TAP,this.applySkill,this),this.gameScreen.btnSkipSkill.addEventListener(egret.TouchEvent.TOUCH_TAP,this.skipSkill,this),this.gameScreen.shunwei1.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.shunwei("1")},this),this.gameScreen.shunwei2.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.shunwei("2")},this),this.gameScreen.shunwei3.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.shunwei("3")},this),this.gameScreen.shunwei4.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.shunwei("4")},this),this.gameScreen.shunwei5.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.shunwei("5")},this),this.gameScreen.shunwei6.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.shunwei("6")},this),this.gameScreen.shunwei7.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.shunwei("7")},this),this.gameScreen.shunwei8.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.shunwei("8")},this),this.gameScreen.onegameend.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onegameend2,this),this.gameScreen.onespeakend.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onespeakend,this),this.gameScreen.toupiao1.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.toupiao("1")},this),this.gameScreen.toupiao2.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.toupiao("2")},this),this.gameScreen.toupiao3.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.toupiao("3")},this),this.gameScreen.toupiao4.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.toupiao("4")},this),this.gameScreen.fangzhenskill1.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.fangzhenskilling("1")},this),this.gameScreen.fangzhenskill2.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.fangzhenskilling("2")},this),this.gameScreen.fangzhenskill3.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.fangzhenskilling("3")},this),this.gameScreen.fangzhenskill4.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.fangzhenskilling("4")},this),this.gameScreen.fangzhenskill5.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.fangzhenskilling("5")},this),this.gameScreen.fangzhenskill6.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.fangzhenskilling("6")},this),this.gameScreen.fangzhenskill7.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.fangzhenskilling("7")},this),this.gameScreen.fangzhenskill8.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.fangzhenskilling("8")},this),this.gameScreen.qingkong.addEventListener(egret.TouchEvent.TOUCH_TAP,this.qingkong,this),this.gameScreen.toupiaoqueren.addEventListener(egret.TouchEvent.TOUCH_TAP,this.toupiaoqueren,this),this.gameScreen.startno2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.startno2,this),this.gameScreen.ybrskill1.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.ybrskilling("1")},this),this.gameScreen.ybrskill2.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.ybrskilling("2")},this),this.gameScreen.ybrskill3.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.ybrskilling("3")},this),this.gameScreen.ybrskill4.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.ybrskilling("4")},this),this.gameScreen.ybrskill5.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.ybrskilling("5")},this),this.gameScreen.ybrskill6.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.ybrskilling("6")},this),this.gameScreen.ybrskill7.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.ybrskilling("7")},this),this.gameScreen.ybrskill8.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.ybrskilling("8")},this),this.gameScreen.zgqskill1.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.zgqskilling("0")},this),this.gameScreen.zgqskill2.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.zgqskilling("1")},this),this.gameScreen.zgqskill3.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.zgqskilling("2")},this),this.gameScreen.zgqskill4.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.zgqskilling("3")},this)},i.prototype.findSeat2=function(t){var o=this;if(this.proxy.gameState.seats[t]);else{var i=this.proxy.gameState.seats.findIndex(function(e){return e&&e.actorNr==o.proxy.loadBalancingClient.myActor().actorNr});this.sendNotification(e.GameCommand.JOIN_SEAT,{oldSeatNumber:i,newSeatNumber:t})}},i.prototype.touxiang=function(t){var o=this,i=[{seatNumber:1,controlName:"btnSeat1",defaultSource:"color-black"},{seatNumber:2,controlName:"btnSeat2",defaultSource:"color-blue"},{seatNumber:3,controlName:"btnSeat3",defaultSource:"color-green"},{seatNumber:4,controlName:"btnSeat4",defaultSource:"color-orange"},{seatNumber:5,controlName:"btnSeat5",defaultSource:"color-purple"},{seatNumber:6,controlName:"btnSeat6",defaultSource:"color-red"},{seatNumber:7,controlName:"btnSeat7",defaultSource:"color-white"},{seatNumber:8,controlName:"btnSeat8",defaultSource:"color-yellow"}];i.forEach(function(i,n){var a=o.gameScreen[i.controlName],r=a.getChildByName("content"),s=a.getChildByName("nickName"),u=a.getChildByName("normalBg"),h=a.getChildByName("masterBg"),c=a.getChildByName("selfMark");t[i.seatNumber]?(r.source="DebugPlatform"==platform.name?i.defaultSource:t[i.seatNumber].avatarUrl||i.defaultSource,s.text=t[i.seatNumber].name||"blank name",h.visible=o.proxy.isActorMaster(t[i.seatNumber]),u.visible=!h.visible,c.visible=o.proxy.isActorLocal(t[i.seatNumber]),r.visible=!0,s.visible=!0,a.filters=t[i.seatNumber].suspended?[e.ColorFilter.grey]:[]):(u.visible=!0,h.visible=!1,c.visible=!1,r.visible=!1,s.visible=!1,a.filters=[])})},i.prototype.startChooseRole=function(){this.skillAnimAdded=!1,this.proxy.startChooseRole()},i.prototype.chooseRole=function(t){this.sendNotification(e.SceneCommand.SHOW_ROLE_POPUP,t)},i.prototype.roleing=function(e){this.gameScreen.roleing=e+"/"+this.proxy.gameState.maxPlayers},i.prototype.startGame=function(){this.sendNotification(e.GameCommand.START_GAME)},i.prototype.setAnims=function(){var e=this;t.forEach(function(t){var o=e.proxy.gameState.baowulist[t.index],i=e.proxy.antiquesMap.get(o),n=e.gameScreen[t.controlName],a=n.getChildByName("antique-group"),r=a.getChildByName("antique-normal"),s=a.getChildByName("antique-selected");r.visible=!0,s.visible=!1;var u=a.getChildByName("antique-content");u.source=i.source;var h=n.getChildByName("antique-label");h.text=i.name})},i.prototype.first_one=function(e){this.setAnims();var t=+e;this.proxy.gameState.shunwei_one_been[1]=this.proxy.gameState.seats[t],this.xingdong(t)},i.prototype.xingdong=function(e){if(this.proxy.isMasterClient){var t=this.proxy.gameState.seats[e];this.proxy.updateActorState(t.actorNr,"isAuthing",!0)}},i.prototype.syncMyTurnState=function(t,o,i){void 0===o&&(o=!1),void 0===i&&(i=e.Receiver.Self),this.proxy.updateMyState(t,o,i)},i.prototype.setMyTurnState=function(e){var t=this,o=["isAuthing","isSkilling","isChoosingSkillingTarget","isChoosingNext","isSpeaking","isVoting","isVoteEnd","isWaitNextTurn","isWaitTouRen","isVotingPerson","isWaitOthersTouRen"],i=e.find(function(e){return e&&e.actorNr==t.proxy.actorNr}),n=e.filter(function(e){return e&&e.action});if(this.gameScreen.isMyTurn=i&&i.action&&"isSpeaking"!=i.action,this.gameScreen.isOthersTurn=!i.action&&n.length>0&&n.some(function(e){return e&&/isAuthing|isSkilling|isChoosingSkillingTarget|isChoosingNext/.test(e.action)}),o.forEach(function(e){t.gameScreen[e]=i&&i.action==e}),this.gameScreen.isChoosingNextOrVotingPerson=this.gameScreen.isChoosingNext||this.gameScreen.isVotingPerson,this.gameScreen.isChoosingNextOrVotingPerson,1==n.length&&this.gameScreen.isOthersTurn){var a=n[0];this.gameScreen.processingActorUI.update(__assign({},a)),this.gameScreen.processingPlayer={colorName:a.color.color,name:a.name}}},i.prototype.ybrskilladd=function(e){this.proxy.gameState.role[1]&&this.proxy.gameState.seats[e].actorNr==this.proxy.gameState.role[1].actorNr?this.proxy.gameState.ybrskill[1]++:this.proxy.gameState.role[2]&&this.proxy.gameState.seats[e].actorNr==this.proxy.gameState.role[2].actorNr?(this.proxy.gameState.ybrskill[2]++,this.proxy.gameState.ybrskill[1]++):this.proxy.gameState.role[3]&&this.proxy.gameState.seats[e].actorNr==this.proxy.gameState.role[3].actorNr?(this.proxy.gameState.ybrskill[3]++,this.proxy.gameState.jyfskill=!1):this.proxy.gameState.role[4]&&this.proxy.gameState.seats[e].actorNr==this.proxy.gameState.role[4].actorNr?this.proxy.gameState.ybrskill[4]++:this.proxy.gameState.role[5]&&this.proxy.gameState.seats[e].actorNr==this.proxy.gameState.role[5].actorNr?this.proxy.gameState.ybrskill[5]++:this.proxy.gameState.role[6]&&this.proxy.gameState.seats[e].actorNr==this.proxy.gameState.role[6].actorNr?this.proxy.gameState.ybrskill[6]++:this.proxy.gameState.role[8]&&this.proxy.gameState.seats[e].actorNr==this.proxy.gameState.role[8].actorNr&&this.proxy.gameState.ybrskill[8]++},i.prototype.chooseAnimReal=function(e,o){var i=this;if(-1==this.selectedAnims.findIndex(function(t){return t==e})){var n=o.currentTarget.getChildByName("antique-group"),a=n.getChildByName("antique-normal"),r=n.getChildByName("antique-selected");if(a.visible=!1,r.visible=!0,this.selectedAnims.push(e),this.selectedAnims.length>this.gameScreen.role.roleCheckCount){var s=this.selectedAnims.shift();t.forEach(function(e,t){if(e.index==s){var o=i.gameScreen[e.controlName],n=o.getChildByName("antique-group"),a=n.getChildByName("antique-normal"),r=n.getChildByName("antique-selected");a.visible=!0,r.visible=!1}})}}},i.prototype.skipAuth=function(e){this.proxy.isActorLocal(this.proxy.gameState.role[2])&&this.syncMyTurnState("isSkilling",!0)},i.prototype.applySkill=function(e){2==this.gameScreen.role.id?(this.syncMyTurnState("isChoosingSkillingTarget",!0),this.fangzhenskill()):6==this.gameScreen.role.id?this.lcfskill():7==this.gameScreen.role.id?(this.syncMyTurnState("isChoosingSkillingTarget",!0),this.ybrskill()):8==this.gameScreen.role.id&&(this.syncMyTurnState("isChoosingSkillingTarget",!0),this.zgqskill())},i.prototype.skipSkill=function(t){var o=this.myRole.id;(6==o||7==o||8==o||this.proxy.isActorLocal(this.proxy.gameState.role[2])&&this.proxy.gameState.ybrskill[2]<=0)&&this.proxy.updatePlayerInfo("skipskill"+this.proxy.gameState.lunci,!0),this.proxy.isActorLocal(this.proxy.gameState.role[2])&&this.proxy.gameState.ybrskill[2]>0&&(this.proxy.gameState.ybrskill[2]--,this.sendNotification(e.SceneCommand.SHOW_PROMPT_POPUP,"你被偷袭")),console.log("skipSkill"),this.chuanshunwei()},i.prototype.chooseAnim=function(t){if(console.log(this.selectedAnims),this.proxy.isActorLocal(this.proxy.gameState.role[1])){if(this.selectedAnims.length<2)return void this.sendNotification(e.SceneCommand.SHOW_PROMPT_POPUP,"请选择两个宝物进行鉴定")}else if(this.selectedAnims.length<1)return void this.sendNotification(e.SceneCommand.SHOW_PROMPT_POPUP,"请选择一个宝物进行鉴定");var o=[];this.gameScreen.role.hasActiveSkill&&this.syncMyTurnState("isSkilling",!0),this.proxy.isActorLocal(this.proxy.gameState.role[1])?(this.proxy.gameState.ybrskill[1]>0?(this.sendNotification(e.SceneCommand.SHOW_PROMPT_POPUP,"你被偷袭"),this.proxy.updatePlayerInfo("touxi"+this.proxy.gameState.lunci,!0),this.proxy.gameState.ybrskill[1]--):1==this.proxy.gameState.lunci?(this.proxy.gameState.onelcfskill?(o[0]="真"==this.proxy.gameState.onezj[this.selectedAnims[0]]?"假":"真",o[1]="真"==this.proxy.gameState.onezj[this.selectedAnims[1]]?"假":"真"):(o[0]=this.proxy.gameState.onezj[this.selectedAnims[0]],o[1]=this.proxy.gameState.onezj[this.selectedAnims[1]]),this.proxy.gameState.onezgqskill==this.selectedAnims[0]&&(o[0]="无法鉴定"),this.proxy.gameState.onezgqskill==this.selectedAnims[1]&&(o[1]="无法鉴定"),this.proxy.updatePlayerInfo("onebaowu",this.proxy.gameState.baowulist[this.selectedAnims[0]]),this.proxy.updatePlayerInfo("onezhenjia",o[0]),this.proxy.updatePlayerInfo("onebaowu2",this.proxy.gameState.baowulist[this.selectedAnims[1]]),this.proxy.updatePlayerInfo("onezhenjia2",o[1])):2==this.proxy.gameState.lunci?(this.proxy.gameState.twolcfskill?(o[0]="真"==this.proxy.gameState.twozj[this.selectedAnims[0]-4]?"假":"真",o[1]="真"==this.proxy.gameState.twozj[this.selectedAnims[1]-4]?"假":"真"):(o[0]=this.proxy.gameState.twozj[this.selectedAnims[0]-4],o[1]=this.proxy.gameState.twozj[this.selectedAnims[1]-4]),this.proxy.gameState.twozgqskill==this.selectedAnims[0]-4&&(o[0]="无法鉴定"),this.proxy.gameState.twozgqskill==this.selectedAnims[1]-4&&(o[1]="无法鉴定"),this.proxy.updatePlayerInfo("twobaowu",this.proxy.gameState.baowulist[this.selectedAnims[0]]),this.proxy.updatePlayerInfo("twozhenjia",o[0]),this.proxy.updatePlayerInfo("twobaowu2",this.proxy.gameState.baowulist[this.selectedAnims[1]]),this.proxy.updatePlayerInfo("twozhenjia2",o[1])):3==this.proxy.gameState.lunci&&(this.proxy.gameState.threelcfskill?(o[0]="真"==this.proxy.gameState.threezj[this.selectedAnims[0]-8]?"假":"真",o[1]="真"==this.proxy.gameState.threezj[this.selectedAnims[1]-8]?"假":"真"):(o[0]=this.proxy.gameState.threezj[this.selectedAnims[0]-8],o[1]=this.proxy.gameState.threezj[this.selectedAnims[1]-8]),this.proxy.gameState.threezgqskill==this.selectedAnims[0]-8&&(o[0]="无法鉴定"),this.proxy.gameState.threezgqskill==this.selectedAnims[1]-8&&(o[1]="无法鉴定"),this.proxy.updatePlayerInfo("threebaowu",this.proxy.gameState.baowulist[this.selectedAnims[0]]),this.proxy.updatePlayerInfo("threezhenjia",o[0]),this.proxy.updatePlayerInfo("threebaowu2",this.proxy.gameState.baowulist[this.selectedAnims[1]]),this.proxy.updatePlayerInfo("threezhenjia2",o[1])),this.chuanshunwei()):this.proxy.isActorLocal(this.proxy.gameState.role[3])?(this.proxy.gameState.ybrskill[3]>0?(this.sendNotification(e.SceneCommand.SHOW_PROMPT_POPUP,"你被偷袭"),this.proxy.updatePlayerInfo("touxi"+this.proxy.gameState.lunci,!0),this.proxy.gameState.jyfskill=!1,this.proxy.gameState.ybrskill[3]--):this.proxy.gameState.jyfskill?1==this.proxy.gameState.lunci?(this.proxy.gameState.onezgqskill==this.selectedAnims[0]?o[0]="无法鉴定":o[0]=this.proxy.gameState.onezj[this.selectedAnims[0]],this.proxy.updatePlayerInfo("onebaowu",this.proxy.gameState.baowulist[this.selectedAnims[0]]),this.proxy.updatePlayerInfo("onezhenjia",o[0])):2==this.proxy.gameState.lunci?(this.proxy.gameState.twozgqskill==this.selectedAnims[0]-4?o[0]="无法鉴定":o[0]=this.proxy.gameState.twozj[this.selectedAnims[0]-4],this.proxy.updatePlayerInfo("twobaowu",this.proxy.gameState.baowulist[this.selectedAnims[0]]),this.proxy.updatePlayerInfo("twozhenjia",o[0])):3==this.proxy.gameState.lunci&&(this.proxy.gameState.threezgqskill==this.selectedAnims[0]-8?o[0]="无法鉴定":o[0]=this.proxy.gameState.threezj[this.selectedAnims[0]-8],this.proxy.updatePlayerInfo("threebaowu",this.proxy.gameState.baowulist[this.selectedAnims[0]]),this.proxy.updatePlayerInfo("threezhenjia",o[0])):(this.sendNotification(e.SceneCommand.SHOW_PROMPT_POPUP,"无法鉴定"),1==this.proxy.gameState.lunci?(this.proxy.updatePlayerInfo("onebaowu",this.proxy.gameState.baowulist[this.selectedAnims[0]]),this.proxy.updatePlayerInfo("onezhenjia","无法鉴定")):2==this.proxy.gameState.lunci?(this.proxy.updatePlayerInfo("twobaowu",this.proxy.gameState.baowulist[this.selectedAnims[0]]),this.proxy.updatePlayerInfo("twozhenjia","无法鉴定")):3==this.proxy.gameState.lunci&&(this.proxy.updatePlayerInfo("threebaowu",this.proxy.gameState.baowulist[this.selectedAnims[0]]),this.proxy.updatePlayerInfo("threezhenjia","无法鉴定"))),this.chuanshunwei()):this.proxy.isActorLocal(this.proxy.gameState.role[4])?(this.proxy.gameState.ybrskill[4]>0?(this.sendNotification(e.SceneCommand.SHOW_PROMPT_POPUP,"你被偷袭"),this.proxy.updatePlayerInfo("touxi"+this.proxy.gameState.lunci,!0),this.proxy.gameState.ybrskill[4]--):1==this.proxy.gameState.lunci?(this.proxy.gameState.onelcfskill?o[0]="真"==this.proxy.gameState.onezj[this.selectedAnims[0]]?"假":"真":o[0]=this.proxy.gameState.onezj[this.selectedAnims[0]],(this.proxy.gameState.onezgqskill==this.selectedAnims[0]||1==this.proxy.gameState.hyyskill)&&(o[0]="无法鉴定"),this.proxy.updatePlayerInfo("onebaowu",this.proxy.gameState.baowulist[this.selectedAnims[0]]),this.proxy.updatePlayerInfo("onezhenjia",o[0])):2==this.proxy.gameState.lunci?(this.proxy.gameState.twolcfskill?o[0]="真"==this.proxy.gameState.twozj[this.selectedAnims[0]-4]?"假":"真":o[0]=this.proxy.gameState.twozj[this.selectedAnims[0]-4],(this.proxy.gameState.twozgqskill==this.selectedAnims[0]-4||2==this.proxy.gameState.hyyskill)&&(o[0]="无法鉴定"),this.proxy.updatePlayerInfo("twobaowu",this.proxy.gameState.baowulist[this.selectedAnims[0]]),this.proxy.updatePlayerInfo("twozhenjia",o[0])):3==this.proxy.gameState.lunci&&(this.proxy.gameState.threelcfskill?o[0]="真"==this.proxy.gameState.threezj[this.selectedAnims[0]-8]?"假":"真":o[0]=this.proxy.gameState.threezj[this.selectedAnims[0]-8],(this.proxy.gameState.threezgqskill==this.selectedAnims[0]-8||3==this.proxy.gameState.hyyskill)&&(o[0]="无法鉴定"),this.proxy.updatePlayerInfo("threebaowu",this.proxy.gameState.baowulist[this.selectedAnims[0]]),this.proxy.updatePlayerInfo("threezhenjia",o[0])),this.chuanshunwei()):this.proxy.isActorLocal(this.proxy.gameState.role[5])?(this.proxy.gameState.ybrskill[5]>0?(this.sendNotification(e.SceneCommand.SHOW_PROMPT_POPUP,"你被偷袭"),this.proxy.updatePlayerInfo("touxi"+this.proxy.gameState.lunci,!0),this.proxy.gameState.ybrskill[5]--):1==this.proxy.gameState.lunci?(this.proxy.gameState.onelcfskill?o[0]="真"==this.proxy.gameState.onezj[this.selectedAnims[0]]?"假":"真":o[0]=this.proxy.gameState.onezj[this.selectedAnims[0]],(this.proxy.gameState.onezgqskill==this.selectedAnims[0]||1==this.proxy.gameState.mhjnskill)&&(o[0]="无法鉴定"),this.proxy.updatePlayerInfo("onebaowu",this.proxy.gameState.baowulist[this.selectedAnims[0]]),this.proxy.updatePlayerInfo("onezhenjia",o[0])):2==this.proxy.gameState.lunci?(this.proxy.gameState.twolcfskill?o[0]="真"==this.proxy.gameState.twozj[this.selectedAnims[0]-4]?"假":"真":o[0]=this.proxy.gameState.twozj[this.selectedAnims[0]-4],(this.proxy.gameState.twozgqskill==this.selectedAnims[0]-4||2==this.proxy.gameState.mhjnskill)&&(o[0]="无法鉴定"),this.proxy.updatePlayerInfo("twobaowu",this.proxy.gameState.baowulist[this.selectedAnims[0]]),this.proxy.updatePlayerInfo("twozhenjia",o[0])):3==this.proxy.gameState.lunci&&(this.proxy.gameState.threelcfskill?o[0]="真"==this.proxy.gameState.threezj[this.selectedAnims[0]-8]?"假":"真":o[0]=this.proxy.gameState.threezj[this.selectedAnims[0]-8],(this.proxy.gameState.threezgqskill==this.selectedAnims[0]-8||3==this.proxy.gameState.mhjnskill)&&(o[0]="无法鉴定"),this.proxy.updatePlayerInfo("threebaowu",this.proxy.gameState.baowulist[this.selectedAnims[0]]),this.proxy.updatePlayerInfo("threezhenjia",o[0])),this.chuanshunwei()):this.proxy.isActorLocal(this.proxy.gameState.role[6])?this.proxy.gameState.ybrskill[6]>0?(this.sendNotification(e.SceneCommand.SHOW_PROMPT_POPUP,"你被偷袭"),this.proxy.updatePlayerInfo("touxi"+this.proxy.gameState.lunci,!0),this.proxy.gameState.ybrskill[6]--,this.chuanshunwei()):1==this.proxy.gameState.lunci?(this.proxy.gameState.onezgqskill==this.selectedAnims[0]?o[0]="无法鉴定":o[0]=this.proxy.gameState.onezj[this.selectedAnims[0]],this.proxy.updatePlayerInfo("onebaowu",this.proxy.gameState.baowulist[this.selectedAnims[0]]),this.proxy.updatePlayerInfo("onezhenjia",o[0])):2==this.proxy.gameState.lunci?(this.proxy.gameState.twozgqskill==this.selectedAnims[0]-4?o[0]="无法鉴定":o[0]=this.proxy.gameState.twozj[this.selectedAnims[0]-4],this.proxy.updatePlayerInfo("twobaowu",this.proxy.gameState.baowulist[this.selectedAnims[0]]),this.proxy.updatePlayerInfo("twozhenjia",o[0])):3==this.proxy.gameState.lunci&&(this.proxy.gameState.threezgqskill==this.selectedAnims[0]-8?o[0]="无法鉴定":o[0]=this.proxy.gameState.threezj[this.selectedAnims[0]-8],this.proxy.updatePlayerInfo("threebaowu",this.proxy.gameState.baowulist[this.selectedAnims[0]]),this.proxy.updatePlayerInfo("threezhenjia",o[0])):this.proxy.isActorLocal(this.proxy.gameState.role[7])?1==this.proxy.gameState.lunci?(this.proxy.gameState.onezgqskill==this.selectedAnims[0]?o[0]="无法鉴定":o[0]=this.proxy.gameState.onezj[this.selectedAnims[0]],this.proxy.updatePlayerInfo("onebaowu",this.proxy.gameState.baowulist[this.selectedAnims[0]]),this.proxy.updatePlayerInfo("onezhenjia",o[0])):2==this.proxy.gameState.lunci?(this.proxy.gameState.twozgqskill==this.selectedAnims[0]-4?o[0]="无法鉴定":o[0]=this.proxy.gameState.twozj[this.selectedAnims[0]-4],this.proxy.updatePlayerInfo("twobaowu",this.proxy.gameState.baowulist[this.selectedAnims[0]]),this.proxy.updatePlayerInfo("twozhenjia",o[0])):3==this.proxy.gameState.lunci&&(this.proxy.gameState.threezgqskill==this.selectedAnims[0]-8?o[0]="无法鉴定":o[0]=this.proxy.gameState.threezj[this.selectedAnims[0]-8],this.proxy.updatePlayerInfo("threebaowu",this.proxy.gameState.baowulist[this.selectedAnims[0]]),this.proxy.updatePlayerInfo("threezhenjia",o[0])):this.proxy.isActorLocal(this.proxy.gameState.role[8])&&(this.proxy.gameState.ybrskill[8]>0?(this.sendNotification(e.SceneCommand.SHOW_PROMPT_POPUP,"你被偷袭"),this.proxy.updatePlayerInfo("touxi"+this.proxy.gameState.lunci,!0),this.proxy.gameState.ybrskill[8]--,this.chuanshunwei()):1==this.proxy.gameState.lunci?(o[0]=this.proxy.gameState.onezj[this.selectedAnims[0]],this.proxy.updatePlayerInfo("onebaowu",this.proxy.gameState.baowulist[this.selectedAnims[0]]),this.proxy.updatePlayerInfo("onezhenjia",o[0])):2==this.proxy.gameState.lunci?(o[0]=this.proxy.gameState.twozj[this.selectedAnims[0]-4],this.proxy.updatePlayerInfo("twobaowu",this.proxy.gameState.baowulist[this.selectedAnims[0]]),this.proxy.updatePlayerInfo("twozhenjia",o[0])):3==this.proxy.gameState.lunci&&(o[0]=this.proxy.gameState.threezj[this.selectedAnims[0]-8],this.proxy.updatePlayerInfo("threebaowu",this.proxy.gameState.baowulist[this.selectedAnims[0]]),this.proxy.updatePlayerInfo("threezhenjia",o[0])));
for(var i=[],n=0;n<o.length;n++)i.push({source:this.proxy.antiquesMap.get(this.proxy.gameState.baowulist[this.selectedAnims[n]]).source,name:this.proxy.gameState.baowulist[this.selectedAnims[n]]+"首",result:o[n]});i.length&&this.sendNotification(e.SceneCommand.SHOW_APPRAISAL_POPUP,i),this.selectedAnims.length=0},i.prototype.setChoosingNextOrVotingPersonUI=function(){this.gameScreen.shunwei1.visible=!0,this.gameScreen.shunwei2.visible=!0,this.gameScreen.shunwei3.visible=!0,this.gameScreen.shunwei4.visible=!0,this.gameScreen.shunwei5.visible=!0,this.gameScreen.shunwei6.visible=!0,this.gameScreen.shunwei7.visible=!0,this.gameScreen.shunwei8.visible=!0;for(var e=function(){var e=t.proxy.gameState.seats[o];e?1==t.proxy.gameState.lunci?t.proxy.gameState.shunwei_one_been.some(function(t){return t&&t.actorNr==e.actorNr})&&(t.gameScreen["shunwei"+e.seatNumber].visible=!1):2==t.proxy.gameState.lunci?t.proxy.gameState.shunwei_two_been.some(function(t){return t&&t.actorNr==e.actorNr})&&(t.gameScreen["shunwei"+e.seatNumber].visible=!1):3==t.proxy.gameState.lunci&&t.proxy.gameState.shunwei_three_been.some(function(t){return t&&t.actorNr==e.actorNr})&&(t.gameScreen["shunwei"+e.seatNumber].visible=!1):t.gameScreen["shunwei"+o]&&(t.gameScreen["shunwei"+o].visible=!1)},t=this,o=1;8>=o;++o)e()},i.prototype.chuanshunwei=function(){99!=this.proxy.gameState.lunci&&(this.syncMyTurnState("isChoosingNext",!0),this.gameScreen.isChoosingNextText=!0,this.gameScreen.touren_note.text="选择下一位行动的玩家"),this.setChoosingNextOrVotingPersonUI(),this.gameScreen.shunwei1.visible||this.gameScreen.shunwei2.visible||this.gameScreen.shunwei3.visible||this.gameScreen.shunwei4.visible||this.gameScreen.shunwei5.visible||this.gameScreen.shunwei6.visible||this.gameScreen.shunwei7.visible||this.gameScreen.shunwei8.visible||this.onegameend()},i.prototype.shunwei=function(t){this.syncMyTurnState("",!1,e.Receiver.Self),99==this.proxy.gameState.lunci?(this.syncMyTurnState("isWaitOthersTouRen"),this.proxy.loadBalancingClient.sendMessage(e.CustomPhotonEvents.tourenjieguo,t)):this.proxy.loadBalancingClient.sendMessage(e.CustomPhotonEvents.nextNr,t)},i.prototype.shunwei2=function(e){var t=this;if(1!=this.proxy.gameState.lunci||this.proxy.gameState.shunwei_one_been.some(function(o){return o&&o==t.proxy.gameState.seats[e]}))if(2!=this.proxy.gameState.lunci||this.proxy.gameState.shunwei_two_been.some(function(o){return o&&o==t.proxy.gameState.seats[e]})){if(3==this.proxy.gameState.lunci&&!this.proxy.gameState.shunwei_three_been.some(function(o){return o&&o==t.proxy.gameState.seats[e]})){this.proxy.gameState.shunwei_three_been.push(this.proxy.gameState.seats[e]);var o=+e;this.xingdong(o)}}else{this.proxy.gameState.shunwei_two_been.push(this.proxy.gameState.seats[e]);var o=+e;this.xingdong(o)}else{this.proxy.gameState.shunwei_one_been.push(this.proxy.gameState.seats[e]);var o=+e;this.xingdong(o)}},i.prototype.lcfskill=function(){1==this.proxy.gameState.lunci?this.proxy.loadBalancingClient.sendMessage(e.CustomPhotonEvents.onelcftongbu):2==this.proxy.gameState.lunci?this.proxy.loadBalancingClient.sendMessage(e.CustomPhotonEvents.twolcftongbu):3==this.proxy.gameState.lunci&&this.proxy.loadBalancingClient.sendMessage(e.CustomPhotonEvents.threelcftongbu),this.chuanshunwei()},i.prototype.ybrskill=function(){this.gameScreen.ybrskill1.visible=!0,this.gameScreen.ybrskill2.visible=!0,this.gameScreen.ybrskill3.visible=!0,this.gameScreen.ybrskill4.visible=!0,this.gameScreen.ybrskill5.visible=!0,this.gameScreen.ybrskill6.visible=!0,this.gameScreen.ybrskill7.visible=!0,this.gameScreen.ybrskill8.visible=!0,this.proxy.gameState.seats[1]||(this.gameScreen.ybrskill1.visible=!1),this.proxy.gameState.seats[2]||(this.gameScreen.ybrskill2.visible=!1),this.proxy.gameState.seats[3]||(this.gameScreen.ybrskill3.visible=!1),this.proxy.gameState.seats[4]||(this.gameScreen.ybrskill4.visible=!1),this.proxy.gameState.seats[5]||(this.gameScreen.ybrskill5.visible=!1),this.proxy.gameState.seats[6]||(this.gameScreen.ybrskill6.visible=!1),this.proxy.gameState.seats[7]||(this.gameScreen.ybrskill7.visible=!1),this.proxy.gameState.seats[8]||(this.gameScreen.ybrskill8.visible=!1)},i.prototype.ybrskilling=function(t){var o=+t;this.proxy.isActorLocal(this.proxy.gameState.seats[o])?this.sendNotification(e.SceneCommand.SHOW_PROMPT_POPUP,"不能对自己使用此技能"):(1==this.proxy.gameState.lunci?this.proxy.loadBalancingClient.sendMessage(e.CustomPhotonEvents.oneybrtongbu,t):2==this.proxy.gameState.lunci?this.proxy.loadBalancingClient.sendMessage(e.CustomPhotonEvents.twoybrtongbu,t):3==this.proxy.gameState.lunci&&this.proxy.loadBalancingClient.sendMessage(e.CustomPhotonEvents.threeybrtongbu,t),this.gameScreen.ybrskill1.visible=!1,this.gameScreen.ybrskill2.visible=!1,this.gameScreen.ybrskill3.visible=!1,this.gameScreen.ybrskill4.visible=!1,this.gameScreen.ybrskill5.visible=!1,this.gameScreen.ybrskill6.visible=!1,this.gameScreen.ybrskill7.visible=!1,this.gameScreen.ybrskill8.visible=!1,this.chuanshunwei())},i.prototype.zgqskill=function(){var e=this,t=[{controlName:"zgqskill1",index:0},{controlName:"zgqskill2",index:1},{controlName:"zgqskill3",index:2},{controlName:"zgqskill4",index:3}];t.forEach(function(t){var o=e.proxy.gameState.baowulist[4*(e.proxy.gameState.lunci-1)+t.index],i=e.proxy.antiquesMap.get(o),n=e.gameScreen[t.controlName],a=n.getChildByName("antique-group"),r=a.getChildByName("antique-content");r.source=i.source;var s=n.getChildByName("antique-label");s.text=i.name,n.enabled=!0})},i.prototype.zgqskilling=function(t){1==this.proxy.gameState.lunci?this.proxy.loadBalancingClient.sendMessage(e.CustomPhotonEvents.onezgqtongbu,t):2==this.proxy.gameState.lunci?this.proxy.loadBalancingClient.sendMessage(e.CustomPhotonEvents.twozgqtongbu,t):3==this.proxy.gameState.lunci&&this.proxy.loadBalancingClient.sendMessage(e.CustomPhotonEvents.threezgqtongbu,t),this.chuanshunwei()},i.prototype.fangzhenskill=function(){this.proxy.gameState.ybrskill[2]>0?(this.sendNotification(e.SceneCommand.SHOW_PROMPT_POPUP,"你被偷袭"),this.proxy.updatePlayerInfo("touxi"+this.proxy.gameState.lunci,!0),this.proxy.gameState.ybrskill[2]--,this.chuanshunwei()):(this.gameScreen.fangzhenskill1.visible=!0,this.gameScreen.fangzhenskill2.visible=!0,this.gameScreen.fangzhenskill3.visible=!0,this.gameScreen.fangzhenskill4.visible=!0,this.gameScreen.fangzhenskill5.visible=!0,this.gameScreen.fangzhenskill6.visible=!0,this.gameScreen.fangzhenskill7.visible=!0,this.gameScreen.fangzhenskill8.visible=!0,this.proxy.gameState.seats[1]||(this.gameScreen.fangzhenskill1.visible=!1),this.proxy.gameState.seats[2]||(this.gameScreen.fangzhenskill2.visible=!1),this.proxy.gameState.seats[3]||(this.gameScreen.fangzhenskill3.visible=!1),this.proxy.gameState.seats[4]||(this.gameScreen.fangzhenskill4.visible=!1),this.proxy.gameState.seats[5]||(this.gameScreen.fangzhenskill5.visible=!1),this.proxy.gameState.seats[6]||(this.gameScreen.fangzhenskill6.visible=!1),this.proxy.gameState.seats[7]||(this.gameScreen.fangzhenskill7.visible=!1),this.proxy.gameState.seats[8]||(this.gameScreen.fangzhenskill8.visible=!1))},i.prototype.fangzhenskilling=function(t){var o=+t;this.proxy.isActorLocal(this.proxy.gameState.seats[o])?this.sendNotification(e.SceneCommand.SHOW_PROMPT_POPUP,"不能对自己使用此技能"):this.fangzhenskilling2(t)},i.prototype.fangzhenskilling2=function(t){var o=this,i=+t,n=this.proxy.gameState.role.findIndex(function(e){return e&&e.actorNr==o.proxy.gameState.seats[i].actorNr});n>=1&&5>=n?(this.sendNotification(e.SceneCommand.SHOW_FANG_POPUP,t),1==this.proxy.gameState.lunci?(this.proxy.updatePlayerInfo("onebaowu",t),this.proxy.updatePlayerInfo("onezhenjia","许愿阵营")):2==this.proxy.gameState.lunci?(this.proxy.updatePlayerInfo("twobaowu",t),this.proxy.updatePlayerInfo("twozhenjia","许愿阵营")):3==this.proxy.gameState.lunci&&(this.proxy.updatePlayerInfo("threebaowu",t),this.proxy.updatePlayerInfo("threezhenjia","许愿阵营"))):n>=6&&8>=n&&(this.sendNotification(e.SceneCommand.SHOW_FANG_POPUP,t),1==this.proxy.gameState.lunci?(this.proxy.updatePlayerInfo("onebaowu",t),this.proxy.updatePlayerInfo("onezhenjia","老朝奉阵营")):2==this.proxy.gameState.lunci?(this.proxy.updatePlayerInfo("twobaowu",t),this.proxy.updatePlayerInfo("twozhenjia","老朝奉阵营")):3==this.proxy.gameState.lunci&&(this.proxy.updatePlayerInfo("threebaowu",t),this.proxy.updatePlayerInfo("threezhenjia","老朝奉阵营"))),this.gameScreen.fangzhenskill1.visible=!1,this.gameScreen.fangzhenskill2.visible=!1,this.gameScreen.fangzhenskill3.visible=!1,this.gameScreen.fangzhenskill4.visible=!1,this.gameScreen.fangzhenskill5.visible=!1,this.gameScreen.fangzhenskill6.visible=!1,this.gameScreen.fangzhenskill7.visible=!1,this.gameScreen.fangzhenskill8.visible=!1,this.chuanshunwei()},i.prototype.onegameend=function(){this.gameScreen.isChoosingNextText=!1,this.gameScreen.isLastPlayer=!0,this.gameScreen.isChoosingNext=!1,this.gameScreen.onegameend.visible=!0},i.prototype.tongzhi=function(t){this.sendNotification(e.SceneCommand.SHOW_PROMPT_POPUP,t)},i.prototype.baowu_tongzhi=function(t){this.sendNotification(e.SceneCommand.SHOW_ROUND_POPUP,t)},i.prototype.onegameend2=function(){this.syncMyTurnState("isSpeaking",!1,e.Receiver.All),this.gameScreen.onegameend.visible=!1,this.gameScreen.isLastPlayer=!1,1==this.proxy.gameState.lunci?this.proxy.loadBalancingClient.sendMessage(e.CustomPhotonEvents.tongzhi,"第一轮结束，开始发言"):2==this.proxy.gameState.lunci?this.proxy.loadBalancingClient.sendMessage(e.CustomPhotonEvents.tongzhi,"第二轮结束，开始发言"):3==this.proxy.gameState.lunci&&this.proxy.loadBalancingClient.sendMessage(e.CustomPhotonEvents.tongzhi,"第三轮结束，开始发言"),this.proxy.loadBalancingClient.sendMessage(e.CustomPhotonEvents.starttoupiao)},i.prototype.start_toupiao_button=function(){this.gameScreen.isOthersTurn=!1},i.prototype.onespeakend=function(){this.proxy.loadBalancingClient.sendMessage(e.CustomPhotonEvents.tongzhi,"开始录入票数"),this.proxy.loadBalancingClient.sendMessage(e.CustomPhotonEvents.toupiaoui)},i.prototype.setToupiaoUI=function(){var e=this;if(99!=this.proxy.gameState.lunci){var t=[{controlName:"toupiao1",index:0},{controlName:"toupiao2",index:1},{controlName:"toupiao3",index:2},{controlName:"toupiao4",index:3}];t.forEach(function(t){var o=e.proxy.gameState.baowulist[4*(e.proxy.gameState.lunci-1)+t.index],i=e.proxy.antiquesMap.get(o),n=e.gameScreen[t.controlName],a=n.getChildByName("antique-group"),r=a.getChildByName("antique-normal"),s=a.getChildByName("antique-selected");r.visible=!0,s.visible=!1;var u=a.getChildByName("antique-content");u.source=i.source;var h=n.getChildByName("antique-label");h.text=i.name,n.enabled=!0}),1==this.proxy.gameState.lunci?(this.sypiaoshu=2,this.muqianpiaoshu=2):(2==this.proxy.gameState.lunci||3==this.proxy.gameState.lunci)&&(this.muqianpiaoshu=this.sypiaoshu=this.proxy.getSyPiaoshu()+2),this.gameScreen.toupiao11.text="0",this.gameScreen.toupiao21.text="0",this.gameScreen.toupiao31.text="0",this.gameScreen.toupiao41.text="0",this.baowu1=0,this.baowu2=0,this.baowu3=0,this.baowu4=0,this.gameScreen.piaoshu.text=this.muqianpiaoshu+"/"+this.sypiaoshu}},i.prototype.toupiaoui=function(){this.syncMyTurnState("isVoting",!1,e.Receiver.All)},i.prototype.qingkong=function(){var e=this;[1,2,3,4].forEach(function(t){var o=e.gameScreen["toupiao"+t],i=o.getChildByName("antique-group"),n=i.getChildByName("antique-normal"),a=i.getChildByName("antique-selected");n.visible=!0,a.visible=!1}),this.baowu1=0,this.baowu2=0,this.baowu3=0,this.baowu4=0,this.gameScreen.toupiao11.text="0",this.gameScreen.toupiao21.text="0",this.gameScreen.toupiao31.text="0",this.gameScreen.toupiao41.text="0",this.muqianpiaoshu=this.sypiaoshu,this.gameScreen.piaoshu.text=this.muqianpiaoshu+"/"+this.sypiaoshu},i.prototype.toupiao=function(t){if(this.muqianpiaoshu<=0)this.sendNotification(e.SceneCommand.SHOW_PROMPT_POPUP,"你的票数不足");else{var o=this.gameScreen["toupiao"+t],i=o.getChildByName("antique-group"),n=i.getChildByName("antique-normal"),a=i.getChildByName("antique-selected");n.visible=!1,a.visible=!0,"1"==t?(this.baowu1++,this.muqianpiaoshu--,this.gameScreen.toupiao11.text=this.baowu1.toString()):"2"==t?(this.baowu2++,this.muqianpiaoshu--,this.gameScreen.toupiao21.text=this.baowu2.toString()):"3"==t?(this.baowu3++,this.muqianpiaoshu--,this.gameScreen.toupiao31.text=this.baowu3.toString()):"4"==t&&(this.baowu4++,this.muqianpiaoshu--,this.gameScreen.toupiao41.text=this.baowu4.toString()),this.gameScreen.piaoshu.text=this.muqianpiaoshu+"/"+this.sypiaoshu}},i.prototype.toupiaoqueren=function(){this.sypiaoshu=this.muqianpiaoshu;this.gameScreen.role;this.proxy.setSypiaoshu(this.sypiaoshu),this.syncMyTurnState("isVoteEnd"),1==this.proxy.gameState.lunci?this.proxy.loadBalancingClient.sendMessage(e.CustomPhotonEvents.piaoshu,"0"+this.baowu1+"0"+this.baowu2+"0"+this.baowu3+"0"+this.baowu4):2==this.proxy.gameState.lunci?this.proxy.loadBalancingClient.sendMessage(e.CustomPhotonEvents.piaoshu2,"0"+this.baowu1+"0"+this.baowu2+"0"+this.baowu3+"0"+this.baowu4):3==this.proxy.gameState.lunci&&this.proxy.loadBalancingClient.sendMessage(e.CustomPhotonEvents.piaoshu3,"0"+this.baowu1+"0"+this.baowu2+"0"+this.baowu3+"0"+this.baowu4)},i.prototype.piaoshujisuan=function(t){var o=0;1==this.proxy.gameState.lunci?this.proxy.gameState.toupiao.forEach(function(e){e&&o++}):2==this.proxy.gameState.lunci?this.proxy.gameState.toupiao2.forEach(function(e){e&&o++}):3==this.proxy.gameState.lunci&&this.proxy.gameState.toupiao3.forEach(function(e){e&&o++}),this.gameScreen.voteing=o+"/"+this.proxy.gameState.maxPlayers+"  已完成投票",this.proxy.loadBalancingClient.myRoomMasterActorNr()==this.proxy.loadBalancingClient.myActor().actorNr&&o==this.proxy.gameState.maxPlayers&&(1==this.proxy.gameState.lunci?this.proxy.loadBalancingClient.sendMessage(e.CustomPhotonEvents.toupiaoend):2==this.proxy.gameState.lunci?this.proxy.loadBalancingClient.sendMessage(e.CustomPhotonEvents.toupiaoend2):3==this.proxy.gameState.lunci&&this.proxy.loadBalancingClient.sendMessage(e.CustomPhotonEvents.toupiaoend3))},i.prototype.toupiaoend=function(t){var o=this,i=+t;this.baowu4=i%100,this.baowu3=(i-this.baowu4)/100%100,this.baowu2=((i-this.baowu4)/100-this.baowu3)/100%100,this.baowu1=(i-this.baowu4-100*this.baowu3-1e4*this.baowu2)/1e6,this.gameScreen.toupiao11.text=this.baowu1.toString(),this.gameScreen.toupiao21.text=this.baowu2.toString(),this.gameScreen.toupiao31.text=this.baowu3.toString(),this.gameScreen.toupiao41.text=this.baowu4.toString(),1==this.proxy.gameState.lunci?(this.baowu1_sx=this.proxy.gameState.baowulist2.findIndex(function(e){return e==o.proxy.gameState.baowulist[0]}),this.baowu2_sx=this.proxy.gameState.baowulist2.findIndex(function(e){return e==o.proxy.gameState.baowulist[1]}),this.baowu3_sx=this.proxy.gameState.baowulist2.findIndex(function(e){return e==o.proxy.gameState.baowulist[2]}),this.baowu4_sx=this.proxy.gameState.baowulist2.findIndex(function(e){return e==o.proxy.gameState.baowulist[3]}),this.proxy.gameState.toupiaojieguo1[0]={baowu:this.proxy.gameState.baowulist[0],piaoshu:this.baowu1,sx:this.baowu1_sx,zhenjia:this.proxy.gameState.onezj[0]},this.proxy.gameState.toupiaojieguo1[1]={baowu:this.proxy.gameState.baowulist[1],piaoshu:this.baowu2,sx:this.baowu2_sx,zhenjia:this.proxy.gameState.onezj[1]},this.proxy.gameState.toupiaojieguo1[2]={baowu:this.proxy.gameState.baowulist[2],piaoshu:this.baowu3,sx:this.baowu3_sx,zhenjia:this.proxy.gameState.onezj[2]},this.proxy.gameState.toupiaojieguo1[3]={baowu:this.proxy.gameState.baowulist[3],piaoshu:this.baowu4,sx:this.baowu4_sx,zhenjia:this.proxy.gameState.onezj[3]},this.proxy.gameState.toupiaojieguo1=_(this.proxy.gameState.toupiaojieguo1).orderBy(["piaoshu","sx"],["desc","asc"]).value(),console.log(this.proxy.gameState.toupiaojieguo1),this.sendNotification(e.SceneCommand.SHOW_RESULT_POPUP),"真"==this.proxy.gameState.toupiaojieguo1[0].zhenjia&&this.proxy.gameState.defen++,"真"==this.proxy.gameState.toupiaojieguo1[1].zhenjia&&this.proxy.gameState.defen++):2==this.proxy.gameState.lunci?(this.baowu1_sx=this.proxy.gameState.baowulist2.findIndex(function(e){return e==o.proxy.gameState.baowulist[4]}),this.baowu2_sx=this.proxy.gameState.baowulist2.findIndex(function(e){return e==o.proxy.gameState.baowulist[5]}),this.baowu3_sx=this.proxy.gameState.baowulist2.findIndex(function(e){return e==o.proxy.gameState.baowulist[6]}),this.baowu4_sx=this.proxy.gameState.baowulist2.findIndex(function(e){return e==o.proxy.gameState.baowulist[7]}),this.proxy.gameState.toupiaojieguo2[0]={baowu:this.proxy.gameState.baowulist[4],piaoshu:this.baowu1,sx:this.baowu1_sx,zhenjia:this.proxy.gameState.twozj[0]},this.proxy.gameState.toupiaojieguo2[1]={baowu:this.proxy.gameState.baowulist[5],piaoshu:this.baowu2,sx:this.baowu2_sx,zhenjia:this.proxy.gameState.twozj[1]},this.proxy.gameState.toupiaojieguo2[2]={baowu:this.proxy.gameState.baowulist[6],piaoshu:this.baowu3,sx:this.baowu3_sx,zhenjia:this.proxy.gameState.twozj[2]},this.proxy.gameState.toupiaojieguo2[3]={baowu:this.proxy.gameState.baowulist[7],piaoshu:this.baowu4,sx:this.baowu4_sx,zhenjia:this.proxy.gameState.twozj[3]},this.proxy.gameState.toupiaojieguo2=_(this.proxy.gameState.toupiaojieguo2).orderBy(["piaoshu","sx"],["desc","asc"]).value(),console.log(this.proxy.gameState.toupiaojieguo2),this.sendNotification(e.SceneCommand.SHOW_RESULT_POPUP),"真"==this.proxy.gameState.toupiaojieguo2[0].zhenjia&&this.proxy.gameState.defen++,"真"==this.proxy.gameState.toupiaojieguo2[1].zhenjia&&this.proxy.gameState.defen++):3==this.proxy.gameState.lunci&&(this.baowu1_sx=this.proxy.gameState.baowulist2.findIndex(function(e){return e==o.proxy.gameState.baowulist[8]}),this.baowu2_sx=this.proxy.gameState.baowulist2.findIndex(function(e){return e==o.proxy.gameState.baowulist[9]}),this.baowu3_sx=this.proxy.gameState.baowulist2.findIndex(function(e){return e==o.proxy.gameState.baowulist[10]}),this.baowu4_sx=this.proxy.gameState.baowulist2.findIndex(function(e){return e==o.proxy.gameState.baowulist[11]}),this.proxy.gameState.toupiaojieguo3[0]={baowu:this.proxy.gameState.baowulist[8],piaoshu:this.baowu1,sx:this.baowu1_sx,zhenjia:this.proxy.gameState.threezj[0]},this.proxy.gameState.toupiaojieguo3[1]={baowu:this.proxy.gameState.baowulist[9],piaoshu:this.baowu2,sx:this.baowu2_sx,zhenjia:this.proxy.gameState.threezj[1]},this.proxy.gameState.toupiaojieguo3[2]={baowu:this.proxy.gameState.baowulist[10],piaoshu:this.baowu3,sx:this.baowu3_sx,zhenjia:this.proxy.gameState.threezj[2]},this.proxy.gameState.toupiaojieguo3[3]={baowu:this.proxy.gameState.baowulist[11],piaoshu:this.baowu4,sx:this.baowu4_sx,zhenjia:this.proxy.gameState.threezj[3]},this.proxy.gameState.toupiaojieguo3=_(this.proxy.gameState.toupiaojieguo3).orderBy(["piaoshu","sx"],["desc","asc"]).value(),console.log(this.proxy.gameState.toupiaojieguo3),this.sendNotification(e.SceneCommand.SHOW_RESULT_POPUP),"真"==this.proxy.gameState.toupiaojieguo3[0].zhenjia&&this.proxy.gameState.defen++,"真"==this.proxy.gameState.toupiaojieguo3[1].zhenjia&&this.proxy.gameState.defen++),3!=this.proxy.gameState.lunci&&this.proxy.isMasterClient&&(this.syncMyTurnState("isWaitNextTurn",!1,e.Receiver.All),this.gameScreen.startno2.visible=!0)},i.prototype.isWaitTouRen=function(){this.proxy.gameState.defen<2?(this.gameScreen.startno2.visible=!1,this.sendNotification(e.SceneCommand.SHOW_RESULT_WINDOW),this.proxy.isMasterClient&&this.proxy.updateUserGameRecords()):6==this.proxy.gameState.defen?(this.gameScreen.startno2.visible=!1,this.sendNotification(e.SceneCommand.SHOW_RESULT_WINDOW),this.proxy.isMasterClient&&this.proxy.updateUserGameRecords()):this.proxy.isMasterClient&&(this.syncMyTurnState("isWaitTouRen",!1,e.Receiver.All),this.gameScreen.startno2.visible=!0)},i.prototype.startno2=function(){this.gameScreen.startno2.visible=!1,1==this.proxy.gameState.lunci?this.proxy.loadBalancingClient.sendMessage(e.CustomPhotonEvents.starttwo):2==this.proxy.gameState.lunci?this.proxy.loadBalancingClient.sendMessage(e.CustomPhotonEvents.starttwo):3==this.proxy.gameState.lunci&&(this.proxy.loadBalancingClient.sendMessage(e.CustomPhotonEvents.tongzhi,"鉴人环节"),this.proxy.loadBalancingClient.sendMessage(e.CustomPhotonEvents.touren))},i.prototype.starttwo=function(){var t=this;this.gameScreen.isFirstRound=!1,this.gameScreen.isSecondRound=1==this.proxy.gameState.lunci,this.gameScreen.isThirdRound=2==this.proxy.gameState.lunci,1==this.proxy.gameState.lunci?(this.proxy.gameState.lunci=2,this.proxy.loadBalancingClient.sendMessage(e.CustomPhotonEvents.baowutongzhi),this.proxy.gameState.shunwei_two_been[1]=this.proxy.gameState.shunwei_one_been[this.proxy.gameState.shunwei_one_been.length-1],this.xingdong(this.proxy.gameState.seats.findIndex(function(e){return e&&e.actorNr==t.proxy.gameState.shunwei_two_been[1].actorNr}))):2==this.proxy.gameState.lunci&&(this.proxy.gameState.lunci=3,this.proxy.loadBalancingClient.sendMessage(e.CustomPhotonEvents.baowutongzhi),this.proxy.gameState.shunwei_three_been[1]=this.proxy.gameState.shunwei_two_been[this.proxy.gameState.shunwei_two_been.length-1],this.xingdong(this.proxy.gameState.seats.findIndex(function(e){return e&&e.actorNr==t.proxy.gameState.shunwei_three_been[1].actorNr})))},i.prototype.tourenui=function(){this.gameScreen.isChoosingNextText=!0,this.gameScreen.isWaitTouRen=!1,this.gameScreen.startno2.visible=!1,this.proxy.gameState.lunci=99,this.syncMyTurnState("isVotingPerson",!1,e.Receiver.All),this.proxy.isActorLocal(this.proxy.gameState.role[1])||this.proxy.isActorLocal(this.proxy.gameState.role[2])||this.proxy.isActorLocal(this.proxy.gameState.role[3])||this.proxy.isActorLocal(this.proxy.gameState.role[4])||this.proxy.isActorLocal(this.proxy.gameState.role[5])?this.gameScreen.touren_note.text="找出老朝奉":this.proxy.isActorLocal(this.proxy.gameState.role[6])?this.gameScreen.touren_note.text="找出许愿":this.proxy.isActorLocal(this.proxy.gameState.role[7])?this.gameScreen.touren_note.text="找出方震":this.proxy.isActorLocal(this.proxy.gameState.role[8])&&(this.gameScreen.touren_note.text="装作在选人的样子")},i.prototype.tourenjieguo=function(t){if(t){var o,i,n,a,r=0;t.forEach(function(e){e&&r++}),console.log("check tourenjieguo"),r==this.proxy.gameState.maxPlayers&&(this.gameScreen.isWaitOthersTouRen=!1,console.log("check tourenjieguo finished."),this.proxy.gameState.role[6]&&this.proxy.gameState.touren[1]&&this.proxy.gameState.touren[1].actorNr==this.proxy.gameState.role[6].actorNr&&this.proxy.gameState.lcfpiao++,this.proxy.gameState.role[6]&&this.proxy.gameState.touren[2]&&this.proxy.gameState.touren[2].actorNr==this.proxy.gameState.role[6].actorNr&&this.proxy.gameState.lcfpiao++,this.proxy.gameState.role[6]&&this.proxy.gameState.touren[3]&&this.proxy.gameState.touren[3].actorNr==this.proxy.gameState.role[6].actorNr&&this.proxy.gameState.lcfpiao++,this.proxy.gameState.role[6]&&this.proxy.gameState.touren[4]&&this.proxy.gameState.touren[4].actorNr==this.proxy.gameState.role[6].actorNr&&this.proxy.gameState.lcfpiao++,this.proxy.gameState.role[6]&&this.proxy.gameState.touren[5]&&this.proxy.gameState.touren[5].actorNr==this.proxy.gameState.role[6].actorNr&&this.proxy.gameState.lcfpiao++,this.proxy.gameState.lcfpiao>=3?(o="找到老朝奉",this.proxy.gameState.defen++,this.proxy.gameState.findPeopleScore++):o="没找到老朝奉",this.proxy.gameState.role[1]&&this.proxy.gameState.touren[6]&&this.proxy.gameState.touren[6].actorNr==this.proxy.gameState.role[1].actorNr?i="找到许愿":(i="没找到许愿",this.proxy.gameState.defen+=2,this.proxy.gameState.findPeopleScore+=2),this.proxy.gameState.role[2]&&this.proxy.gameState.touren[7]&&this.proxy.gameState.touren[7].actorNr==this.proxy.gameState.role[2].actorNr?n="找到方震":(n="没找到方震",this.proxy.gameState.defen++,this.proxy.gameState.findPeopleScore++),a=this.proxy.gameState.defen<6?"许愿阵营失败":"许愿阵营胜利",this.zhaoren(),console.log(this.proxy.gameState.lcfpiao),console.log(o),console.log(i),console.log(n),this.sendNotification(e.SceneCommand.SHOW_RESULT_WINDOW),this.proxy.isMasterClient&&this.proxy.updateUserGameRecords())}},i.prototype.tourenjieguo2=function(t){if(t){var o=0;t.forEach(function(e){e&&o++}),o==this.proxy.gameState.maxPlayers&&this.sendNotification(e.SceneCommand.SHOW_RESULT_WINDOW)}},i.prototype.zhaoren=function(){var e=this;this.xuyuanweizhi=this.proxy.gameState.seats.findIndex(function(t){return t&&e.proxy.gameState.role[1]&&t.actorNr==e.proxy.gameState.role[1].actorNr}),this.fangzhenweizhi=this.proxy.gameState.seats.findIndex(function(t){return t&&e.proxy.gameState.role[2]&&t.actorNr==e.proxy.gameState.role[2].actorNr}),this.laochaofengweizhi=this.proxy.gameState.seats.findIndex(function(t){return t&&e.proxy.gameState.role[6]&&t.actorNr==e.proxy.gameState.role[6].actorNr}),this.proxy.gameState.weizhi_xuyuan=this.xuyuanweizhi,this.proxy.gameState.weizhi_fangzhen=this.fangzhenweizhi,this.proxy.gameState.weizhi_laochaofeng=this.laochaofengweizhi},i.NAME="GameScreenMediator",i}(puremvc.Mediator);e.GameScreenMediator=o,__reflect(o.prototype,"game.GameScreenMediator",["puremvc.IMediator","puremvc.INotifier"])}(game||(game={}));var game;!function(e){var t=function(t){function o(e){var i=t.call(this,o.NAME,e)||this;return t.prototype.initializeNotifier.call(i,"ApplicationFacade"),i.initData(),i}return __extends(o,t),o.prototype.initData=function(){var t=RES.getRes("game-term_json");this.termWindow.termList.dataProvider=new eui.ArrayCollection(t),this.termWindow.termList.itemRenderer=e.TermItemRenderer},Object.defineProperty(o.prototype,"termWindow",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),o.NAME="GuideGameTermWindowMediator",o}(puremvc.Mediator);e.GuideGameTermWindowMediator=t,__reflect(t.prototype,"game.GuideGameTermWindowMediator",["puremvc.IMediator","puremvc.INotifier"])}(game||(game={}));var game;!function(e){var t=function(t){function o(e){var i=t.call(this,o.NAME,e)||this;return t.prototype.initializeNotifier.call(i,"ApplicationFacade"),i.guideWindow.videoButton.addEventListener(egret.TouchEvent.TOUCH_TAP,i.videoButtonClick,i),i.guideWindow.gameProcessButton.addEventListener(egret.TouchEvent.TOUCH_TAP,i.gameProcessButtonClick,i),i.guideWindow.roleSkillButton.addEventListener(egret.TouchEvent.TOUCH_TAP,i.roleSkillButtonClick,i),i.guideWindow.winJudgeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,i.winJudgeButtonClick,i),i.guideWindow.gameTermButton.addEventListener(egret.TouchEvent.TOUCH_TAP,i.gameTermButtonClick,i),i}return __extends(o,t),o.prototype.videoButtonClick=function(){this.sendNotification(e.SceneCommand.SHOW_GUIDE_VIDEO)},o.prototype.gameProcessButtonClick=function(){this.sendNotification(e.SceneCommand.SHOW_GUIDE_PROCESS)},o.prototype.roleSkillButtonClick=function(){this.sendNotification(e.SceneCommand.SHOW_GUIDE_ROLE)},o.prototype.winJudgeButtonClick=function(){this.sendNotification(e.SceneCommand.SHOW_GUIDE_WINJUDGE)},o.prototype.gameTermButtonClick=function(){this.sendNotification(e.SceneCommand.SHOW_GUIDE_TERM)},o.prototype.listNotificationInterests=function(){return[]},o.prototype.handleNotification=function(e){e.getBody()},Object.defineProperty(o.prototype,"guideWindow",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),o.NAME="GuideWindowMediator",o}(puremvc.Mediator);e.GuideWindowMediator=t,__reflect(t.prototype,"game.GuideWindowMediator",["puremvc.IMediator","puremvc.INotifier"])}(game||(game={}));var game;!function(e){var t=function(t){function o(i){var n=t.call(this,o.NAME,i)||this;return t.prototype.initializeNotifier.call(n,"ApplicationFacade"),n.proxy=n.facade().retrieveProxy(e.GameProxy.NAME),n.popupFangWindow.addEventListener(egret.Event.ADDED_TO_STAGE,n.initData,n),n}return __extends(o,t),o.prototype.initData=function(){var e=this.proxy.gameState.seats[this.popupFangWindow.seatNum];this.popupFangWindow.seat={color:e.color.source,url:e.avatarUrl,name:e.name};var t=this.proxy.rolesMap.get(this.proxy.gameState.role.findIndex(function(t){return t&&t.actorNr==e.actorNr}).toString());this.popupFangWindow.message="是"+t.camp},Object.defineProperty(o.prototype,"popupFangWindow",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),o.NAME="PopupFangWindowMediator",o}(puremvc.Mediator);e.PopupFangWindowMediator=t,__reflect(t.prototype,"game.PopupFangWindowMediator",["puremvc.IMediator","puremvc.INotifier"])}(game||(game={}));var game;!function(e){var t=function(t){function o(i){var n=t.call(this,o.NAME,i)||this;return t.prototype.initializeNotifier.call(n,"ApplicationFacade"),n.proxy=n.facade().retrieveProxy(e.GameProxy.NAME),n.popupGameInfoWindow.addEventListener(egret.Event.ADDED_TO_STAGE,n.initData,n),n}return __extends(o,t),o.prototype.initData=function(){return __awaiter(this,void 0,void 0,function(){var t,o,i,n,a,r,s,u,u,h,c,s,u,u,h,c,s,u,u,h,c,l=this;return __generator(this,function(p){return t=this.proxy.gameState.role.findIndex(function(e){return l.proxy.isActorLocal(e)}),this.popupGameInfoWindow.role=this.proxy.rolesMap.get(t.toString()),o=this.proxy.gameState.seats.find(function(e){return e&&e.actorNr==l.proxy.gameState.role[t].actorNr}),this.popupGameInfoWindow.nickName=o.name,this.popupGameInfoWindow.avatarUrl=o.avatarUrl,this.popupGameInfoWindow.selfColor=o.color.source,this.popupGameInfoWindow.teammate=null,t==e.RoleId.LaoChaoFen&&this.proxy.gameState.role[e.RoleId.YaoBuRan]?(i=this.proxy.gameState.seats.find(function(t){return t&&t.actorNr==l.proxy.gameState.role[e.RoleId.YaoBuRan].actorNr}),this.popupGameInfoWindow.teammate={avatarUrl:i.avatarUrl,color:i.color.source,nickName:i.name,name:"药不然"}):t==e.RoleId.YaoBuRan&&this.proxy.gameState.role[e.RoleId.LaoChaoFen]&&(n=this.proxy.gameState.seats.find(function(t){return t&&t.actorNr==l.proxy.gameState.role[e.RoleId.LaoChaoFen].actorNr}),this.popupGameInfoWindow.teammate={avatarUrl:n.avatarUrl,color:n.color.source,nickName:n.name,name:"老朝奉"}),this.popupGameInfoWindow.firstRound={fang:null,r1:null,r2:null,text:"",skillText:"",yaoSkill:null,zhengSkill:null},this.popupGameInfoWindow.secondRound={fang:null,r1:null,r2:null,text:"",skillText:"",yaoSkill:null,zhengSkill:null},this.popupGameInfoWindow.thirdRound={fang:null,r1:null,r2:null,text:"",skillText:"",yaoSkill:null,zhengSkill:null},a=this.proxy.getPlayerInfo(),r=this.proxy.gameState.role.findIndex(function(e){return l.proxy.isActorLocal(e)}),a?(a.touxi1?this.popupGameInfoWindow.firstRound.text=e.GameInfo.attacked:(a.onebaowu&&(r==e.RoleId.FangZheng?(s=this.proxy.gameState.seats[a.onebaowu],this.popupGameInfoWindow.firstRound.fang={actorUrl:s.avatarUrl,color:s.color.source,name:s.name,result:a.onezhenjia}):(u=this.proxy.antiquesMap.get(a.onebaowu),this.popupGameInfoWindow.firstRound.r1={source:u.source,resultRes:"",resultLabel:""},a.onezhenjia==e.GameInfo.cannotJudge?this.popupGameInfoWindow.firstRound.r1.resultLabel=e.GameInfo.cannotJudge:this.popupGameInfoWindow.firstRound.r1.resultRes="真"==a.onezhenjia?"true":"false")),a.onebaowu2?(u=this.proxy.antiquesMap.get(a.onebaowu2),this.popupGameInfoWindow.firstRound.r2={source:u.source,resultRes:"",resultLabel:""},a.onezhenjia2==e.GameInfo.cannotJudge?this.popupGameInfoWindow.firstRound.r2.resultLabel=e.GameInfo.cannotJudge:this.popupGameInfoWindow.firstRound.r2.resultRes="真"==a.onezhenjia2?"true":"false"):a.skipskill1?this.popupGameInfoWindow.firstRound.skillText=e.GameInfo.skipSkill:r==e.RoleId.YaoBuRan&&this.proxy.gameState.oneybrskill?(h=this.proxy.gameState.seats[this.proxy.gameState.oneybrskill],this.popupGameInfoWindow.firstRound.skillText=e.GameInfo.attack,this.popupGameInfoWindow.firstRound.yaoSkill={color:h.color.source,url:h.avatarUrl,name:h.name}):r==e.RoleId.ZhengGuoQu&&this.proxy.gameState.onezgqskill<100?(c=this.proxy.antiquesMap.get(this.proxy.gameState.baowulist[this.proxy.gameState.onezgqskill]),this.popupGameInfoWindow.firstRound.skillText=e.GameInfo.hide,this.popupGameInfoWindow.firstRound.zhengSkill={source:c.source}):r==e.RoleId.LaoChaoFen&&this.proxy.gameState.onelcfskill&&(this.popupGameInfoWindow.firstRound.skillText=e.GameInfo.reverse)),a.touxi2?this.popupGameInfoWindow.secondRound.text=e.GameInfo.attacked:(a.twobaowu&&(r==e.RoleId.FangZheng?(s=this.proxy.gameState.seats[a.twobaowu],this.popupGameInfoWindow.secondRound.fang={actorUrl:s.avatarUrl,color:s.color.source,name:s.name,result:a.twozhenjia}):(u=this.proxy.antiquesMap.get(a.twobaowu),this.popupGameInfoWindow.secondRound.r1={source:u.source,resultRes:"",resultLabel:""},a.twozhenjia==e.GameInfo.cannotJudge?this.popupGameInfoWindow.secondRound.r1.resultLabel=e.GameInfo.cannotJudge:this.popupGameInfoWindow.secondRound.r1.resultRes="真"==a.twozhenjia?"true":"false")),a.twobaowu2?(u=this.proxy.antiquesMap.get(a.twobaowu2),this.popupGameInfoWindow.secondRound.r2={source:u.source,resultRes:"",resultLabel:""},a.twozhenjia2==e.GameInfo.cannotJudge?this.popupGameInfoWindow.secondRound.r2.resultLabel=e.GameInfo.cannotJudge:this.popupGameInfoWindow.secondRound.r2.resultRes="真"==a.twozhenjia2?"true":"false"):a.skipskill2?this.popupGameInfoWindow.secondRound.skillText=e.GameInfo.skipSkill:r==e.RoleId.YaoBuRan&&this.proxy.gameState.twoybrskill?(h=this.proxy.gameState.seats[this.proxy.gameState.twoybrskill],this.popupGameInfoWindow.secondRound.skillText=e.GameInfo.attack,this.popupGameInfoWindow.secondRound.yaoSkill={color:h.color.source,url:h.avatarUrl,name:h.name}):r==e.RoleId.ZhengGuoQu&&this.proxy.gameState.twozgqskill<100?(c=this.proxy.antiquesMap.get(this.proxy.gameState.baowulist[this.proxy.gameState.twozgqskill+4]),this.popupGameInfoWindow.secondRound.skillText=e.GameInfo.hide,this.popupGameInfoWindow.secondRound.zhengSkill={source:c.source}):r==e.RoleId.LaoChaoFen&&this.proxy.gameState.twolcfskill&&(this.popupGameInfoWindow.secondRound.skillText=e.GameInfo.reverse)),a.touxi3?this.popupGameInfoWindow.thirdRound.text=e.GameInfo.attacked:(a.threebaowu&&(r==e.RoleId.FangZheng?(s=this.proxy.gameState.seats[a.threebaowu],this.popupGameInfoWindow.thirdRound.fang={actorUrl:s.avatarUrl,color:s.color.source,name:s.name,result:a.threezhenjia}):(u=this.proxy.antiquesMap.get(a.threebaowu),this.popupGameInfoWindow.thirdRound.r1={source:u.source,resultRes:"",resultLabel:""},a.threezhenjia==e.GameInfo.cannotJudge?this.popupGameInfoWindow.thirdRound.r1.resultLabel=e.GameInfo.cannotJudge:this.popupGameInfoWindow.thirdRound.r1.resultRes="真"==a.threezhenjia?"true":"false")),a.threebaowu2?(u=this.proxy.antiquesMap.get(a.threebaowu2),this.popupGameInfoWindow.thirdRound.r2={source:u.source,resultRes:"",resultLabel:""},a.threezhenjia2==e.GameInfo.cannotJudge?this.popupGameInfoWindow.thirdRound.r2.resultLabel=e.GameInfo.cannotJudge:this.popupGameInfoWindow.thirdRound.r2.resultRes="真"==a.threezhenjia2?"true":"false"):a.skipskill3?this.popupGameInfoWindow.thirdRound.skillText=e.GameInfo.skipSkill:r==e.RoleId.YaoBuRan&&this.proxy.gameState.threeybrskill?(h=this.proxy.gameState.seats[this.proxy.gameState.threeybrskill],this.popupGameInfoWindow.thirdRound.skillText=e.GameInfo.attack,this.popupGameInfoWindow.thirdRound.yaoSkill={color:h.color.source,url:h.avatarUrl,name:h.name}):r==e.RoleId.ZhengGuoQu&&this.proxy.gameState.threezgqskill<100?(c=this.proxy.antiquesMap.get(this.proxy.gameState.baowulist[this.proxy.gameState.threezgqskill+8]),this.popupGameInfoWindow.thirdRound.skillText=e.GameInfo.hide,this.popupGameInfoWindow.thirdRound.zhengSkill={source:c.source}):r==e.RoleId.LaoChaoFen&&this.proxy.gameState.threelcfskill&&(this.popupGameInfoWindow.thirdRound.skillText=e.GameInfo.reverse)),[2]):[2]
})})},Object.defineProperty(o.prototype,"popupGameInfoWindow",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),o.NAME="PopupGameInfoWindowMediator",o}(puremvc.Mediator);e.PopupGameInfoWindowMediator=t,__reflect(t.prototype,"game.PopupGameInfoWindowMediator",["puremvc.IMediator","puremvc.INotifier"])}(game||(game={}));var game;!function(e){var t=function(t){function o(i){var n=t.call(this,o.NAME,i)||this;return t.prototype.initializeNotifier.call(n,"ApplicationFacade"),n.proxy=n.facade().retrieveProxy(e.GameProxy.NAME),n.popupHandleWindow.confirmButton.addEventListener(egret.TouchEvent.TOUCH_TAP,n.confirmClick,n),n.popupHandleWindow.btnCreateRoom.addEventListener(egret.TouchEvent.TOUCH_TAP,n.createRoomClick,n),n.popupHandleWindow.sixButton.addEventListener(egret.TouchEvent.TOUCH_TAP,n.selectedSix,n),n.popupHandleWindow.sevenButton.addEventListener(egret.TouchEvent.TOUCH_TAP,n.selectedSeven,n),n.popupHandleWindow.eightButton.addEventListener(egret.TouchEvent.TOUCH_TAP,n.selectedEight,n),n}return __extends(o,t),o.prototype.confirmClick=function(){this.proxy.suspendRoom()},o.prototype.createRoomClick=function(t){this.sendNotification(e.GameCommand.CREATE_ROOM,this.selectedNumber)},o.prototype.selectedSix=function(e){this.popupHandleWindow.sixButton.selected=!0,this.popupHandleWindow.sevenButton.selected=this.popupHandleWindow.eightButton.selected=!1,this.selectedNumber=6},o.prototype.selectedSeven=function(e){this.popupHandleWindow.sevenButton.selected=!0,this.popupHandleWindow.sixButton.selected=this.popupHandleWindow.eightButton.selected=!1,this.selectedNumber=7},o.prototype.selectedEight=function(e){this.popupHandleWindow.eightButton.selected=!0,this.popupHandleWindow.sevenButton.selected=this.popupHandleWindow.sixButton.selected=!1,this.selectedNumber=8},Object.defineProperty(o.prototype,"popupHandleWindow",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),o.NAME="PopupHandleWindowMediator",o}(puremvc.Mediator);e.PopupHandleWindowMediator=t,__reflect(t.prototype,"game.PopupHandleWindowMediator",["puremvc.IMediator","puremvc.INotifier"])}(game||(game={}));var game;!function(e){var t=function(t){function o(e){var i=t.call(this,o.NAME,e)||this;return t.prototype.initializeNotifier.call(i,"ApplicationFacade"),i.popupNumberKeyboard.num1.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return i.numberClick(1)},i),i.popupNumberKeyboard.num2.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return i.numberClick(2)},i),i.popupNumberKeyboard.num3.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return i.numberClick(3)},i),i.popupNumberKeyboard.num4.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return i.numberClick(4)},i),i.popupNumberKeyboard.num5.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return i.numberClick(5)},i),i.popupNumberKeyboard.num6.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return i.numberClick(6)},i),i.popupNumberKeyboard.num7.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return i.numberClick(7)},i),i.popupNumberKeyboard.num8.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return i.numberClick(8)},i),i.popupNumberKeyboard.num9.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return i.numberClick(9)},i),i.popupNumberKeyboard.num0.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return i.numberClick(0)},i),i.popupNumberKeyboard.cancel.addEventListener(egret.TouchEvent.TOUCH_TAP,i.cancelClick,i),i.popupNumberKeyboard.confirm.addEventListener(egret.TouchEvent.TOUCH_TAP,i.confirmClick,i),i.popupNumberKeyboard["delete"].addEventListener(egret.TouchEvent.TOUCH_TAP,i.deleteClick,i),i}return __extends(o,t),o.prototype.numberClick=function(t){this.popupNumberKeyboard.roomName.length<6&&(this.popupNumberKeyboard.roomName+=t,this.sendNotification(e.GameProxy.INPUT_NUMBER,this.popupNumberKeyboard.roomName)),this.popupNumberKeyboard.showText=!this.popupNumberKeyboard.roomName},o.prototype.cancelClick=function(t){platform.hideAllBannerAds(),this.popupNumberKeyboard.roomName="",this.sendNotification(e.GameProxy.INPUT_NUMBER,this.popupNumberKeyboard.roomName),this.popupNumberKeyboard.showText=!0,this.popupNumberKeyboard.close()},o.prototype.confirmClick=function(t){this.popupNumberKeyboard.roomName="",this.sendNotification(e.GameProxy.FINISH_INPUT),this.popupNumberKeyboard.showText=!0,this.popupNumberKeyboard.close()},o.prototype.deleteClick=function(t){this.popupNumberKeyboard.roomName=this.popupNumberKeyboard.roomName.substr(0,this.popupNumberKeyboard.roomName.length-1),this.popupNumberKeyboard.showText=!this.popupNumberKeyboard.roomName,this.sendNotification(e.GameProxy.INPUT_NUMBER,this.popupNumberKeyboard.roomName)},Object.defineProperty(o.prototype,"popupNumberKeyboard",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),o.NAME="PopupNumberKeyboardMediator",o}(puremvc.Mediator);e.PopupNumberKeyboardMediator=t,__reflect(t.prototype,"game.PopupNumberKeyboardMediator",["puremvc.IMediator","puremvc.INotifier"])}(game||(game={}));var game;!function(e){var t=function(t){function o(i){var n=t.call(this,o.NAME,i)||this;return t.prototype.initializeNotifier.call(n,"ApplicationFacade"),n.proxy=n.facade().retrieveProxy(e.GameProxy.NAME),n.popupRoleWindow.confirmButton.addEventListener(egret.TouchEvent.TOUCH_TAP,n.confirmClick,n),n.popupRoleWindow.addEventListener(egret.Event.ADDED_TO_STAGE,n.initData,n),n}return __extends(o,t),o.prototype.initData=function(){var e=this;this.popupRoleWindow.promptInfo="",this.popupRoleWindow.role=this.proxy.rolesMap.get(this.popupRoleWindow.roleId.toString());var t=this.proxy.gameState.role.findIndex(function(t){return t&&t.actorNr==e.proxy.actorNr});if(-1!=t){var o=this.proxy.rolesMap.get(t.toString()).name;this.popupRoleWindow.promptInfo="你已经选择了"+o+",是否更换"+this.popupRoleWindow.role.name}},o.prototype.confirmClick=function(t){var o=this,i=this.proxy.gameState.role.findIndex(function(e){return e&&e.actorNr==o.proxy.actorNr});this.proxy.gameState.role[this.popupRoleWindow.roleId]?this.sendNotification(e.SceneCommand.SHOW_PROMPT_POPUP,"已经有人选择此身份，请重新选择"):-1!=i?this.sendNotification(e.GameCommand.CHOOSE_ROLE,{oldRoleId:i,newRoleId:this.popupRoleWindow.roleId}):this.sendNotification(e.GameCommand.CHOOSE_ROLE,{oldRoleId:null,newRoleId:this.popupRoleWindow.roleId}),this.popupRoleWindow.close()},Object.defineProperty(o.prototype,"popupRoleWindow",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),o.NAME="PopupRoleWindowMediator",o}(puremvc.Mediator);e.PopupRoleWindowMediator=t,__reflect(t.prototype,"game.PopupRoleWindowMediator",["puremvc.IMediator","puremvc.INotifier"])}(game||(game={}));var game;!function(e){var t=function(t){function o(){return t.call(this,"ApplicationFacade")||this}return __extends(o,t),o.getInstance=function(){return null==this.instance&&(this.instance=new o),this.instance},o.prototype.initializeController=function(){t.prototype.initializeController.call(this),this.registerCommand(o.STARTUP,e.StartupCommand)},o.prototype.startUp=function(t){this.sendNotification(o.STARTUP,t),this.removeCommand(o.STARTUP),this.sendNotification(e.SceneCommand.CHANGE,e.Scene.Start)},o.prototype.registerMediator=function(e){t.prototype.registerMediator.call(this,e)},o.STARTUP="startup",o}(puremvc.Facade);e.ApplicationFacade=t,__reflect(t.prototype,"game.ApplicationFacade",["puremvc.IFacade","puremvc.INotifier"])}(game||(game={}));var game;!function(e){var t=function(t){function o(i){var n=t.call(this,o.NAME,i)||this;return t.prototype.initializeNotifier.call(n,"ApplicationFacade"),n.proxy=n.facade().retrieveProxy(e.GameProxy.NAME),n.popupVoteRecordWindow.backButton.addEventListener(egret.TouchEvent.TOUCH_TAP,n.backButtonClick,n),n.popupVoteRecordWindow.addEventListener(egret.Event.ADDED_TO_STAGE,n.initData,n),n}return __extends(o,t),o.prototype.backButtonClick=function(e){this.popupVoteRecordWindow.close()},o.prototype.initData=function(){var t=this,o=["","shunwei_one_been","shunwei_two_been","shunwei_three_been"],i=["","toupiao","toupiao2","toupiao3"];[1,2,3].forEach(function(o){t.popupVoteRecordWindow["orderGroup"+o].dataProvider=new eui.ArrayCollection([]),t.popupVoteRecordWindow["orderGroup"+o].itemRenderer=e.VoteNumRenderer,t.popupVoteRecordWindow["roundGroup"+o].dataProvider=new eui.ArrayCollection([]),t.popupVoteRecordWindow["roundGroup"+o].itemRenderer=e.VoteAntiquesRenderer}),[1,2,3].forEach(function(n){if(!(n>t.proxy.gameState.lunci)){var a=[];t.proxy.gameState[o[n]].forEach(function(e,t){e&&a.push({voterColor:e.color.source})}),t.popupVoteRecordWindow["orderGroup"+n].dataProvider=new eui.ArrayCollection(a),t.popupVoteRecordWindow["orderGroup"+n].itemRenderer=e.VoteNumRenderer;for(var r=4*n-4,s=[],u=t.proxy.gameState["toupiaojieguo"+n],h=function(e){var o={bg:"",antRes:t.proxy.antiquesMap.get(t.proxy.gameState.baowulist[r+e]).source,isReal:"",voteDetail:[]};u.forEach(function(a,s){a.baowu==t.proxy.gameState.baowulist[r+e]&&(o.bg=2>s?"bg3":"bg2",o.isReal=s>1?null:s?"真"==a.zhenjia?"true":"false":"hide",t.proxy.gameState[i[n]].forEach(function(i,n){i&&+i.toString().substr(2*e,2)&&o.voteDetail.push({voterColor:t.proxy.gameState.seats[n].color.source,voteNum:+i.toString().substr(2*e,2)})}))}),t.proxy.gameState.lunci>=n&&s.push(o)},c=0;4>c;c++)h(c);t.popupVoteRecordWindow["roundGroup"+n].dataProvider=new eui.ArrayCollection(s),t.popupVoteRecordWindow["roundGroup"+n].itemRenderer=e.VoteAntiquesRenderer}})},Object.defineProperty(o.prototype,"popupVoteRecordWindow",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),o.NAME="PopupVoteRecordWindowMediator",o}(puremvc.Mediator);e.PopupVoteRecordWindowMediator=t,__reflect(t.prototype,"game.PopupVoteRecordWindowMediator",["puremvc.IMediator","puremvc.INotifier"])}(game||(game={}));var game;!function(e){var t=function(t){function o(i){var n=t.call(this,o.NAME,i)||this;return t.prototype.initializeNotifier.call(n,"ApplicationFacade"),n.proxy=n.facade().retrieveProxy(e.GameProxy.NAME),n.popupVoteResultWindow.addEventListener(egret.Event.ADDED_TO_STAGE,n.initData,n),n.popupVoteResultWindow.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){3==n.lunci&&n.sendNotification(e.GameProxy.AUTH_EDN)},n),n}return __extends(o,t),o.prototype.initData=function(){var t=this,o=["","toupiao","toupiao2","toupiao3"],i=4*this.proxy.gameState.lunci-4,n=this.proxy.gameState[o[this.proxy.gameState.lunci]];this.lunci=this.proxy.gameState.lunci,this.popupVoteResultWindow.round="round"+this.proxy.gameState.lunci;for(var a=this.proxy.gameState["toupiaojieguo"+this.proxy.gameState.lunci],r=[],s=function(e){a.forEach(function(o,a){if(o.baowu==t.proxy.gameState.baowulist[i+e]){var s={bg:2>a?"bg3":"bg2",antRes:t.proxy.antiquesMap.get(o.baowu).source,isReal:a>1?null:a?"真"==o.zhenjia?"true":"false":"hide",voteDetail:[]};n.forEach(function(o,i){o&&+o.toString().substr(2*e,2)&&s.voteDetail.push({voterColor:t.proxy.gameState.seats[i].color.source,voteNum:+o.toString().substr(2*e,2)})}),r.push(s)}})},u=0;4>u;u++)s(u);this.popupVoteResultWindow.voteGroup.dataProvider=new eui.ArrayCollection(r),this.popupVoteResultWindow.voteGroup.itemRenderer=e.VoteAntiquesRenderer},Object.defineProperty(o.prototype,"popupVoteResultWindow",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),o.NAME="PopupVoteResultWindowMediator",o}(puremvc.Mediator);e.PopupVoteResultWindowMediator=t,__reflect(t.prototype,"game.PopupVoteResultWindowMediator",["puremvc.IMediator","puremvc.INotifier"])}(game||(game={}));var game;!function(e){var t=function(t){function o(e){var i=t.call(this,o.NAME,e)||this;return t.prototype.initializeNotifier.call(i,"ApplicationFacade"),i.rankWindow.backButton.addEventListener(egret.TouchEvent.TOUCH_TAP,i.backButtonClick,i),i.initData(),i}return __extends(o,t),o.prototype.initData=function(){return __awaiter(this,void 0,void 0,function(){var t,o=this;return __generator(this,function(i){return t=[[{key:e.OrderType.winRate,name:"胜率榜"},{key:e.OrderType.countTotal,name:"场次榜"}],[{key:0,name:"全部人数"},{key:6,name:"六人局"},{key:7,name:"七人局"},{key:8,name:"八人局"}],[{key:0,name:"全部角色"},{key:1,name:"许愿"},{key:2,name:"方震"},{key:3,name:"姬云浮"},{key:4,name:"黄烟烟"},{key:5,name:"木户加奈"},{key:6,name:"老朝奉"},{key:7,name:"药不然"},{key:8,name:"郑国渠"}],[{key:0,name:"全部场次"},{key:10,name:"10场以上"},{key:30,name:"30场以上"},{key:50,name:"50场以上"},{key:100,name:"100场以上"}]],this.filterKeyList=[],this.nameList=["rateTime","gameType","role","other"],this.nameList.forEach(function(i,n){o.rankWindow[i+"Filter"].addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return o.showFilterGroup(n)},o),o.rankWindow[i+"List"].visible=!1,o.rankWindow[i+"List"].addEventListener(eui.ItemTapEvent.ITEM_TAP,function(){return o.selectedItem(n)},o),o.rankWindow[i+"List"].dataProvider=new eui.ArrayCollection(t[n]),o.rankWindow[i+"List"].itemRenderer=e.CityItemRenderer,o.rankWindow[i]=t[n][0].name,o.filterKeyList[n]=t[n][0].key}),this.rankWindow.rateTime=t[0][1].name,this.filterKeyList[0]=t[0][1].key,this.rankWindow.other=t[3][1].name,this.filterKeyList[3]=t[3][1].key,this.setRankList(),[2]})})},o.prototype.rankListSort=function(e){console.log(e)},o.prototype.backButtonClick=function(e){this.rankWindow.close()},o.prototype.showFilterGroup=function(e){var t=this;this.nameList.forEach(function(o,i){t.rankWindow[o+"List"].visible=i==e?!t.rankWindow[o+"List"].visible:!1})},o.prototype.selectedItem=function(e){var t=this.rankWindow[this.nameList[e]+"List"].selectedItem;this.filterKeyList[e]!=t.key&&(this.filterKeyList[e]=t.key,this.rankWindow[this.nameList[e]]=t.name,this.setRankList()),this.rankWindow[this.nameList[e]+"List"].visible=!1},o.prototype.setRankList=function(){var t=this;this.rankList=[];var o=this.facade().retrieveProxy(e.AccountProxy.NAME);o.loadRank(this.filterKeyList[0],this.filterKeyList[1],this.filterKeyList[2],this.filterKeyList[3]).then(function(o){t.rankList=o.map(function(e,o){return __assign({OrderType:t.filterKeyList[0],key:o+1},e)}),t.rankWindow.rankList.dataProvider=new eui.ArrayCollection(t.rankList),t.rankWindow.rankList.itemRenderer=e.RankListItemRenderer})},o.prototype.listNotificationInterests=function(){return[]},o.prototype.handleNotification=function(e){e.getBody()},Object.defineProperty(o.prototype,"rankWindow",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),o.NAME="RankWindowMediator",o}(puremvc.Mediator);e.RankWindowMediator=t,__reflect(t.prototype,"game.RankWindowMediator",["puremvc.IMediator","puremvc.INotifier"])}(game||(game={}));var game;!function(e){var t=function(t){function o(i){var n=t.call(this,o.NAME,i)||this;return n.isInit=!1,t.prototype.initializeNotifier.call(n,"ApplicationFacade"),n.proxy=n.facade().retrieveProxy(e.GameProxy.NAME),n.resultWindow.shareButton.addEventListener(egret.TouchEvent.TOUCH_TAP,n.shareClick,n),n.resultWindow.confirmButton.addEventListener(egret.TouchEvent.TOUCH_TAP,n.confirmClick,n),n.resultWindow.addEventListener(egret.Event.ADDED_TO_STAGE,n.initData,n),n.initData(),n}return __extends(o,t),o.prototype.shareClick=function(){platform.shareAppMessage()},o.prototype.confirmClick=function(){this.proxy.leaveRoom(),this.sendNotification(e.SceneCommand.CHANGE,e.Scene.Start),this.resultWindow.close()},o.prototype.initData=function(){var t=this;if(!this.isInit){this.isInit=!0,egret.setTimeout(function(){t.isInit=!1},this,300);var o=this.proxy.gameState.role.findIndex(function(e){return t.proxy.isActorLocal(e)}),i=this.proxy.rolesMap.get(o.toString()).camp;i==e.gameCamp.xuyuan?(this.resultWindow.campRes="share_team_xu",this.proxy.gameState.defen<6?(this.resultWindow.winRes="lose",this.resultWindow.borderRes="border_red",this.resultWindow.winResult="result2"):(this.resultWindow.winRes="victory",this.resultWindow.borderRes="border_black",this.resultWindow.winResult="result1")):(this.resultWindow.campRes="share_team_lao",this.proxy.gameState.defen<6?(this.resultWindow.winRes="victory",this.resultWindow.borderRes="border_black",this.resultWindow.winResult="result3"):(this.resultWindow.winRes="lose",this.resultWindow.borderRes="border_red",this.resultWindow.winResult="result4")),this.resultWindow.totalScore=this.proxy.gameState.defen,this.resultWindow.findPeopleScore=this.proxy.gameState.findPeopleScore,this.resultWindow.findAntiqueScore=this.resultWindow.totalScore-this.resultWindow.findPeopleScore;var n=["","toupiao","toupiao2","toupiao3"];if([1,2,3].forEach(function(o){for(var i=4*o-4,a=[],r=t.proxy.gameState["toupiaojieguo"+o],s=function(e){r.forEach(function(r,s){if(r.baowu==t.proxy.gameState.baowulist[i+e]){var u={bg:2>s?"bg3":"bg2",antRes:t.proxy.antiquesMap.get(r.baowu).source,isReal:"真"==r.zhenjia?"true":"false",voteDetail:[]};t.proxy.gameState[n[o]].forEach(function(o,i){o&&+o.toString().substr(2*e,2)&&u.voteDetail.push({voterColor:t.proxy.gameState.seats[i].color.source,voteNum:+o.toString().substr(2*e,2)})}),a.push(u)}})},u=0;4>u;u++)s(u);t.resultWindow["roundGroup"+o].dataProvider=new eui.ArrayCollection(a),t.resultWindow["roundGroup"+o].itemRenderer=e.VoteAntiquesRenderer}),this.resultWindow.showFindPeople=!0,this.resultWindow.totalScoreGroup.y=2320,3==this.proxy.gameState.lunci&&(this.resultWindow.showFindPeople=!1,this.resultWindow.totalScoreGroup.y=1510),this.resultWindow.roleXu=null,this.resultWindow.roleFang=null,this.resultWindow.roleLao=null,this.resultWindow.voteLao=null,this.resultWindow.voteYao=null,this.proxy.gameState.role[e.RoleId.XuYuan]){var a=this.proxy.gameState.seats.find(function(o){return o&&o.actorNr==t.proxy.gameState.role[e.RoleId.XuYuan].actorNr});this.resultWindow.roleXu={color:a&&a.color.source,url:a&&a.avatarUrl}}if(this.proxy.gameState.role[e.RoleId.FangZheng]){var r=this.proxy.gameState.seats.find(function(o){return o&&o.actorNr==t.proxy.gameState.role[e.RoleId.FangZheng].actorNr});this.resultWindow.roleFang={color:r&&r.color.source,url:r&&r.avatarUrl}}if(this.proxy.gameState.role[e.RoleId.LaoChaoFen]){var s=this.proxy.gameState.seats.find(function(o){return o&&o.actorNr==t.proxy.gameState.role[e.RoleId.LaoChaoFen].actorNr});this.resultWindow.roleLao={color:s&&s.color.source,url:s&&s.avatarUrl};var u=this.proxy.gameState.touren[e.RoleId.LaoChaoFen];s&&u&&(this.resultWindow.voteLao={voterColor:s.color.source,voterUrl:s.avatarUrl,votedColor:u.color.source,votedName:this.proxy.rolesMap.get(this.proxy.gameState.role.findIndex(function(e){return e&&e.actorNr==u.actorNr}).toString()).name,votedUrl:u.avatarUrl})}if(this.proxy.gameState.role[e.RoleId.YaoBuRan]){var h=this.proxy.gameState.seats.find(function(o){return o&&o.actorNr==t.proxy.gameState.role[e.RoleId.YaoBuRan].actorNr}),c=this.proxy.gameState.touren[e.RoleId.YaoBuRan];h&&c&&(this.resultWindow.voteYao={voterColor:h.color.source,voterUrl:h.avatarUrl,votedColor:c.color.source,votedName:this.proxy.rolesMap.get(this.proxy.gameState.role.findIndex(function(e){return e&&e.actorNr==c.actorNr}).toString()).name,votedUrl:c.avatarUrl})}try{console.log("轮次",this.proxy.gameState.lunci);var l=[];this.proxy.gameState.touren.forEach(function(e,o){if(6>o&&e){var i=t.proxy.gameState.seats.find(function(e){return e&&e.actorNr==t.proxy.gameState.role[o].actorNr});l.push({voterColor:i.color.source,voterName:t.proxy.rolesMap.get(t.proxy.gameState.role.findIndex(function(e){return e&&e.actorNr==i.actorNr}).toString()).name,voterUrl:i.avatarUrl,votedColor:e.color.source,votedName:t.proxy.rolesMap.get(t.proxy.gameState.role.findIndex(function(t){return t&&t.actorNr==e.actorNr}).toString()).name,votedUrl:e.avatarUrl})}}),this.resultWindow.voteGroup.dataProvider=new eui.ArrayCollection(l),this.resultWindow.voteGroup.itemRenderer=e.VotePeopleRenderer}catch(p){console.error(p)}}},Object.defineProperty(o.prototype,"resultWindow",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),o.NAME="ResultWindowMediator",o}(puremvc.Mediator);e.ResultWindowMediator=t,__reflect(t.prototype,"game.ResultWindowMediator",["puremvc.IMediator","puremvc.INotifier"])}(game||(game={}));var game;!function(e){var t=function(t){function o(e){var i=t.call(this,o.NAME,e)||this;return t.prototype.initializeNotifier.call(i,"ApplicationFacade"),i.settingWindow.shareButton.addEventListener(egret.TouchEvent.TOUCH_TAP,i.shareButtonClick,i),i.settingWindow.aboutButton.addEventListener(egret.TouchEvent.TOUCH_TAP,i.aboutButtonClick,i),i.settingWindow.backButton.addEventListener(egret.TouchEvent.TOUCH_TAP,i.backButtonClick,i),i}return __extends(o,t),o.prototype.backButtonClick=function(e){this.settingWindow.close()},o.prototype.shareButtonClick=function(e){platform.shareAppMessage()},o.prototype.aboutButtonClick=function(t){this.sendNotification(e.SceneCommand.SHOW_ABOUT_WINDOW)},Object.defineProperty(o.prototype,"settingWindow",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),o.NAME="SettingWindowMediator",o}(puremvc.Mediator);e.SettingWindowMediator=t,__reflect(t.prototype,"game.SettingWindowMediator",["puremvc.IMediator","puremvc.INotifier"])}(game||(game={}));var game;!function(e){var t=function(t){function o(e){var i=t.call(this,o.NAME,e)||this;return t.prototype.initializeNotifier.call(i,"ApplicationFacade"),i.startScreen.txtOpenId.addEventListener(egret.TouchEvent.TOUCH_TAP,function(e){e.stopImmediatePropagation()},i),i.startScreen.btnChangeOpenId.addEventListener(egret.TouchEvent.TOUCH_TAP,i.changeOpenIdClick,i),i.startScreen.btnCreateRoom.addEventListener(egret.TouchEvent.TOUCH_TAP,i.createRoomClick,i),i.startScreen.btnJoinRoom.addEventListener(egret.TouchEvent.TOUCH_TAP,i.joinRoomClick,i),i.startScreen.btnTanbao.addEventListener(egret.TouchEvent.TOUCH_TAP,i.gameTanbaoClick,i),i.startScreen.btnViewMore.addEventListener(egret.TouchEvent.TOUCH_TAP,i.viewMoreClick,i),i.startScreen.headGroup.addEventListener(egret.TouchEvent.TOUCH_TAP,i.showMyInfo,i),i.startScreen.btnNotice.addEventListener(egret.TouchEvent.TOUCH_TAP,i.noticeClick,i),i.startScreen.btnRank.addEventListener(egret.TouchEvent.TOUCH_TAP,i.rankClick,i),i.startScreen.btnGuide.addEventListener(egret.TouchEvent.TOUCH_TAP,i.guideClick,i),i.startScreen.btnSetting.addEventListener(egret.TouchEvent.TOUCH_TAP,i.settingClick,i),i.initData(),i}return __extends(o,t),o.prototype.initData=function(){return __awaiter(this,void 0,void 0,function(){var t,t;return __generator(this,function(o){switch(o.label){case 0:return console.log("StartScreen initData:"),this.accountProxy=this.facade().retrieveProxy(e.AccountProxy.NAME),this.gameProxy=this.facade().retrieveProxy(e.GameProxy.NAME),"DebugPlatform"!=platform.name?[3,1]:(console.log("DebugPlatform"),this.startScreen.isDebugPlatform=!0,this.startScreen.isWxPlatform=!1,this.startScreen.isNativePlatform=!1,[3,7]);case 1:return"wxgame"!=platform.name?[3,4]:(console.log("wxgame"),[4,AccountAdapter.loadUserInfo()]);case 2:return t=o.sent(),console.log("loadUserInfo completed.",t),this.startScreen.nickName=t.nickName,this.startScreen.avatarUrl=t.avatarUrl,this.startScreen.isDebugPlatform=!1,this.startScreen.isWxPlatform=!0,this.startScreen.isNativePlatform=!1,[4,this.gameProxy.initialize()];case 3:return o.sent(),[3,7];case 4:return"native"!=platform.name?[3,7]:(console.log("native"),[4,AccountAdapter.loadUserInfo()]);case 5:return t=o.sent(),console.log("loadUserInfo completed.",t),this.startScreen.nickName=t.nickName,this.startScreen.avatarUrl=t.avatarUrl,this.startScreen.isDebugPlatform=!1,this.startScreen.isWxPlatform=!1,this.startScreen.isNativePlatform=!0,[4,this.gameProxy.initialize()];case 6:o.sent(),o.label=7;case 7:return[2]}})})},o.prototype.changeOpenIdClick=function(t){return __awaiter(this,void 0,void 0,function(){var o,i;return __generator(this,function(n){switch(n.label){case 0:return t.stopImmediatePropagation(),o=this.startScreen.txtOpenId.text,e.CommonData.logon.unionId=o,[4,AccountAdapter.loadUserInfo()];case 1:return i=n.sent(),this.startScreen.nickName=i.nickName,[4,this.gameProxy.initialize()];case 2:return n.sent(),[2]}})})},o.prototype.createRoomClick=function(t){platform.showBannerAd("top"),this.sendNotification(e.SceneCommand.SHOW_HANDLE_POPUP)},o.prototype.joinRoomClick=function(t){platform.showBannerAd("top"),this.sendNotification(e.SceneCommand.SHOW_NUMBER_KEYBOARD)},o.prototype.gameTanbaoClick=function(e){platform.navigateToMiniProgram()},o.prototype.viewMoreClick=function(t){this.sendNotification(e.SceneCommand.SHOW_MORE_GAME)},o.prototype.noticeClick=function(t){this.sendNotification(e.SceneCommand.SHOW_NOTICE_WINDOW)},o.prototype.rankClick=function(t){this.sendNotification(e.SceneCommand.SHOW_RANK_WINDOW)},o.prototype.guideClick=function(t){this.sendNotification(e.SceneCommand.SHOW_BAR_WINDOW)},o.prototype.settingClick=function(t){this.sendNotification(e.SceneCommand.SHOW_SETTING_WINDOW)},o.prototype.showMyInfo=function(){e.CommonData.logon.userId&&this.sendNotification(e.SceneCommand.SHOW_USERINFO_WINDOW)},o.prototype.listNotificationInterests=function(){return[e.GameProxy.INPUT_NUMBER,e.GameProxy.FINISH_INPUT]},o.prototype.handleNotification=function(t){var o=t.getBody();switch(t.getName()){case e.GameProxy.INPUT_NUMBER:this.startScreen.roomNum=o;break;case e.GameProxy.FINISH_INPUT:var i=this.startScreen.roomNum;this.sendNotification(e.GameCommand.JOIN_ROOM,i),this.startScreen.roomNum=""}},Object.defineProperty(o.prototype,"startScreen",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),o.NAME="StartScreenMediator",o}(puremvc.Mediator);e.StartScreenMediator=t,__reflect(t.prototype,"game.StartScreenMediator",["puremvc.IMediator","puremvc.INotifier"])}(game||(game={}));var game;!function(e){var t=function(t){function o(e){var i=t.call(this,o.NAME,e)||this;return t.prototype.initializeNotifier.call(i,"ApplicationFacade"),i.userInfoWindow.addEventListener(egret.Event.ADDED_TO_STAGE,i.initData,i),i.userInfoWindow.backButton.addEventListener(egret.TouchEvent.TOUCH_TAP,i.backButtonClick,i),i}return __extends(o,t),o.prototype.initData=function(){return __awaiter(this,void 0,void 0,function(){var t,o,i,n,a,r,s,u,h,c,l,p,d,m;return __generator(this,function(g){switch(g.label){case 0:return t=this.facade().retrieveProxy(e.GameProxy.NAME),[4,AccountAdapter.loadUserGameRecords()];case 1:return o=g.sent(),i=o.gameRecords.countTotal,n=o.gameRecords.countWin,a=o.gameRecords.count6Total,r=o.gameRecords.count6Win,s=o.gameRecords.count7Total,u=o.gameRecords.count7Win,h=o.gameRecords.count8Total,c=o.gameRecords.count8Win,l=o.gameRecords.countXuyuanTotal,p=o.gameRecords.countXuYuanWin,d=o.gameRecords.countLaoChaofengTotal,m=o.gameRecords.countLaoChaofengWin,this.userInfoWindow.nickName=o.nickName,this.userInfoWindow.avatarUrl=o.avatarUrl,this.userInfoWindow.totalPlay="共"+i+"局",this.userInfoWindow.winPlay=n,this.userInfoWindow.failPlay=i-n,this.userInfoWindow.totalWinRate=Math.round(n/(i||1)*100)+"%",this.userInfoWindow.gameWinRate6=Math.round(r/(a||1)*100)+"%",this.userInfoWindow.gameWinRate7=Math.round(u/(s||1)*100)+"%",this.userInfoWindow.gameWinRate8=Math.round(c/(h||1)*100)+"%",this.userInfoWindow.campXuWinRate=Math.round(p/(l||1)*100)+"%",this.userInfoWindow.campLaoWinRate=Math.round(m/(d||1)*100)+"%",[2]}})})},o.prototype.backButtonClick=function(e){this.userInfoWindow.close()},Object.defineProperty(o.prototype,"userInfoWindow",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),o.NAME="UserInfoWindowMediator",o}(puremvc.Mediator);e.UserInfoWindowMediator=t,__reflect(t.prototype,"game.UserInfoWindowMediator",["puremvc.IMediator","puremvc.INotifier"])}(game||(game={}));var game;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.appVersion="",t.skinName="skins.AboutWindow",t.appVersion=platform.appVersion,t.addEventListener(eui.UIEvent.ADDED,t.createCompleteEvent,t),t.addEventListener(egret.TouchEvent.TOUCH_TAP,t.close,t),t}return __extends(t,e),t.prototype.createCompleteEvent=function(e){this.imgHeight=this.stage.stageHeight,this.removeEventListener(eui.UIEvent.ADDED,this.createCompleteEvent,this)},t.prototype.partAdded=function(t,o){e.prototype.partAdded.call(this,t,o)},t}(eui.Panel);e.AboutWindow=t,__reflect(t.prototype,"game.AboutWindow")}(game||(game={}));var game;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.data={avatarUrl:"",name:""},t.enabled=!1,t.color="",t.skinName="skins.ActorUI",t.addEventListener(eui.UIEvent.ADDED,t.createCompleteEvent,t),t}return __extends(t,e),t.prototype.createCompleteEvent=function(e){this.removeEventListener(eui.UIEvent.ADDED,this.createCompleteEvent,this)},t.prototype.update=function(e){this.data=e;var t=this.btnActor.getChildByName("content");t.source=this.data.avatarUrl;var o=this.btnActor.getChildByName("nickName");o.text=this.data.name;var i=this.btnActor.getChildByName("selfMark");i.visible=this.data.isLocal;var n=this.btnActor.getChildByName("normalBg");n.visible=!this.data.isMaster;var a=this.btnActor.getChildByName("masterBg");a.visible=this.data.isMaster,this.color=this.data.color.source||this.color;var r=this.btnActor.getChildByName("colorImage");r.source=this.color},t.prototype.partAdded=function(t,o){e.prototype.partAdded.call(this,t,o)},t}(eui.Component);e.ActorUI=t,__reflect(t.prototype,"game.ActorUI")}(game||(game={}));var game;!function(e){var t=function(t){function o(){var e=t.call(this)||this;return e.skinName="skins.BarWindow",e.addEventListener(eui.UIEvent.ADDED,e.createCompleteEvent,e),e}return __extends(o,t),o.prototype.createCompleteEvent=function(t){this.navigationBar.y=this.stage.stageHeight-this.navigationBar.height-10,this.contentScroller.height=this.stage.stageHeight-this.headGroup.height-this.navigationBar.height-20,this.removeEventListener(eui.UIEvent.ADDED,this.createCompleteEvent,this),e.ApplicationFacade.getInstance().registerMediator(new e.BarWindowMediator(this))},o.prototype.partAdded=function(e,o){t.prototype.partAdded.call(this,e,o)},o}(eui.Panel);e.BarWindow=t,__reflect(t.prototype,"game.BarWindow")}(game||(game={}));var AccountAdapter=function(){function e(){}return e.checkForUpdate=function(){return __awaiter(this,void 0,void 0,function(){var e,t,o=this;return __generator(this,function(i){switch(i.label){case 0:return"DebugPlatform"==platform.name?[2,{hasUpdate:!1}]:[4,platform.getVersion()];case 1:return e=i.sent()||0,console.log("Check version begin, current version is: "+e),t=new egret.HttpRequest,t.responseType=egret.HttpResponseType.TEXT,t.open(game.Constants.Endpoints.service+"version/check?version="+e,egret.HttpMethod.GET),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.send(),[2,new Promise(function(i,n){t.addEventListener(egret.Event.COMPLETE,function(t){var o=t.currentTarget,a=JSON.parse(o.response);return a.error?(console.error(a.message),n(a.message)):(console.log("Check version end, lastest version is: "+(a.data&&a.data.version||e)),i(a.data))},o)})]}})})},e.login=function(e){return __awaiter(this,void 0,void 0,function(){var t,o,i=this;return __generator(this,function(n){switch(n.label){case 0:return t=e,e&&(e.code||e.token)?[3,2]:[4,platform.login()];case 1:t=n.sent(),n.label=2;case 2:return console.log("Login app server begin, code: "+t.code+", token: "+t.token),o=new egret.HttpRequest,o.responseType=egret.HttpResponseType.TEXT,o.open(game.Constants.Endpoints.service+"users/"+("native"==platform.name?"login-native":"login-wxgame")+"?code="+(t.code||"")+"&token="+(t.token||""),egret.HttpMethod.POST),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.send(),[2,new Promise(function(e,t){o.addEventListener(egret.Event.COMPLETE,function(o){var i=o.currentTarget,n=JSON.parse(i.response);return n.error?(console.error(n.message),t(n.message)):(game.CommonData.logon=__assign({},game.CommonData.logon,n.data),console.log("Login app server end, unionId: "+(n.data&&n.data.unionId)+", wxgameOpenId: "+(n.data&&n.data.wxgameOpenId)),e())},i)})]}})})},e.loadUserInfo=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return console.log("platform.getUserInfo begin."),this.userInfo&&this.userInfo.userId?[2,this.userInfo]:game.CommonData.logon&&game.CommonData.logon.userId?(this.userInfo=game.CommonData.logon,"native"==platform.name&&platform.setSecurityStorageAsync(this.userInfo.anonymous?"anonymoustoken":"token",this.userInfo.token),[2,this.userInfo]):[4,platform.getUserInfo()["catch"](function(e){console.error(e)
})];case 1:return(e=t.sent())?[3,3]:(console.log("platform.getUserInfo failed now await authorizeUserInfo actively."),[4,platform.authorizeUserInfo()["catch"](function(e){console.error(e)})]);case 2:e=t.sent(),t.label=3;case 3:return e?(console.log("platform.getUserInfo end."),this.userInfo=__assign({},e,{session_key:game.CommonData.logon.session_key}),[4,this.authorizeUserInfoViaAppServer(this.userInfo)]):(console.log("platform.getUserInfo end, userInfo is null."),this.userInfo={gameRecords:{}},[2,this.userInfo]);case 4:return t.sent(),game.CommonData.logon.userId=this.userInfo.userId,game.CommonData.logon.unionId=this.userInfo.unionId,game.CommonData.logon.token=this.userInfo.token,console.log("userInfo after authorizeUserInfoViaAppServer",this.userInfo),[2,this.userInfo]}})})},e.authorizeUserInfoViaAppServer=function(e){return __awaiter(this,void 0,void 0,function(){var e,t=this;return __generator(this,function(o){return game.CommonData.logon&&game.CommonData.logon.wxgameOpenId?(console.log("load users/info via app server begin, openId: "+game.CommonData.logon.wxgameOpenId+"."),this.userInfo.wxgameOpenId=game.CommonData.logon.wxgameOpenId,e=new egret.HttpRequest,e.responseType=egret.HttpResponseType.TEXT,e.open(game.Constants.Endpoints.service+"users/authorize-wxgame/?wxgameOpenId="+game.CommonData.logon.wxgameOpenId,egret.HttpMethod.POST),e.setRequestHeader("Content-Type","application/json"),e.send(JSON.stringify(this.userInfo)),[2,new Promise(function(o,i){e.addEventListener(egret.Event.COMPLETE,function(e){console.log("load users/info via app server end.");var n=e.currentTarget,a=JSON.parse(n.response);if(a.error)return console.error(a.message),i(a.message);var r=a.data;return t.userInfo.userId=r.userId,t.userInfo.unionId=r.unionId,t.userInfo.nativeOpenId=r.nativeOpenId,t.userInfo.wxgameOpenId=r.wxgameOpenId,t.userInfo.token=r.token,platform.setStorage("token",r.token),o(t.userInfo)},t)})]):(console.log("We don't have wxgameOpenId now, skip."),[2,this.userInfo])})})},e.loadUserGameRecords=function(){return __awaiter(this,void 0,void 0,function(){var e,t=this;return __generator(this,function(o){return game.CommonData.logon&&game.CommonData.logon.userId?(console.log("loadUserGameRecords via app server begin, userId: "+game.CommonData.logon.userId+"."),e=new egret.HttpRequest,e.responseType=egret.HttpResponseType.TEXT,e.open(game.Constants.Endpoints.service+"records/?token="+game.CommonData.logon.token,egret.HttpMethod.POST),e.setRequestHeader("Content-Type","application/json"),e.send(),[2,new Promise(function(o,i){e.addEventListener(egret.Event.COMPLETE,function(e){console.log("loadUserGameRecords via app server end.");var n=e.currentTarget,a=JSON.parse(n.response);return a.error?(console.error(a.message),i(a.message)):(console.log("update current userInfo object"),t.userInfo.gameRecords=a.data,o(t.userInfo))},t)})]):(console.log("We don't have unionId now, skip."),[2,this.userInfo])})})},e.saveUserGameRecords=function(e){if(game.CommonData.logon&&game.CommonData.logon.userId){console.log("saveUserGameRecords via app server begin, userId: "+game.CommonData.logon.userId+".");var t=new egret.HttpRequest;t.responseType=egret.HttpResponseType.TEXT,t.open(game.Constants.Endpoints.service+"records/create/?token="+game.CommonData.logon.token,egret.HttpMethod.POST),t.setRequestHeader("Content-Type","application/json"),t.send(JSON.stringify(e)),t.addEventListener(egret.Event.COMPLETE,function(e){console.log("saveUserGameRecords via app server end.");var t=e.currentTarget,o=JSON.parse(t.response);o.error&&console.error(o.message)},this)}else console.log("We don't have openId now, skip.")},e}();__reflect(AccountAdapter.prototype,"AccountAdapter");var game;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.skinName="skins.CityItemRenderer",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this)},t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this)},t}(eui.ItemRenderer);e.CityItemRenderer=t,__reflect(t.prototype,"game.CityItemRenderer")}(game||(game={}));var game;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.skinName="skins.ClubListItemRenderer",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this)},t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this)},t}(eui.ItemRenderer);e.ClubListItemRenderer=t,__reflect(t.prototype,"game.ClubListItemRenderer")}(game||(game={}));var game;!function(e){var t=function(t){function o(){var e=t.call(this)||this;return e.roomName="",e.isNotFangZhen=!0,e.isFangZhen=!1,e.isYaoBuran=!1,e.isZhengGuoqu=!1,e.isMasterClient=!1,e.isNormalClient=!0,e.currentPlayers=0,e.maxPlayers=0,e.isInitial=!1,e.isWaiting=!1,e.isAllReady=!1,e.isAllRolesReady=!1,e.canChooseSeat=!0,e.isChoosingRole=!1,e.isChoosingRoleandEight=!1,e.isChoosingRoleandSeven=!1,e.isChoosingRoleOrMasterClient=!1,e.isAllRolesReadyAndNormalClient=!1,e.isFirstRound=!1,e.isSecondRound=!1,e.isThirdRound=!1,e.isMyTurn=!1,e.isOthersTurn=!1,e.isAuthing=!1,e.isSkilling=!1,e.isChoosingSkillingTarget=!1,e.isChoosingNext=!1,e.isVotingPerson=!1,e.isChoosingNextOrVotingPerson=!1,e.isSpeaking=!1,e.isPhasePreparing=!1,e.isPhaseChoosingRole=!1,e.isPhaseGameInProgress=!1,e.isLastPlayer=!1,e.isVoteEnd=!1,e.isWaitNextTurn=!1,e.isWaitTouRen=!1,e.isChoosingNextText=!1,e.isWaitOthersTouRen=!1,e.isWaitNextTurnOrWaitTouRen=!1,e.processingPlayer={name:"",colorName:""},e.name="gameScreen",e.skinName="skins.GameScreen",e.addEventListener(eui.UIEvent.ADDED,e.createCompleteEvent,e),e.startjs.visible=!1,e.startgame.visible=!1,e.shunwei1.visible=!1,e.shunwei2.visible=!1,e.shunwei3.visible=!1,e.shunwei4.visible=!1,e.shunwei5.visible=!1,e.shunwei6.visible=!1,e.shunwei7.visible=!1,e.shunwei8.visible=!1,e.onegameend.visible=!1,e.onespeakend.visible=!1,e}return __extends(o,t),o.prototype.createCompleteEvent=function(t){this.navigationBar.y=this.stage.stageHeight-this.navigationBar.height,this.removeEventListener(eui.UIEvent.ADDED,this.createCompleteEvent,this),e.ApplicationFacade.getInstance().registerMediator(new e.GameScreenMediator(this))},o.prototype.partAdded=function(e,o){t.prototype.partAdded.call(this,e,o)},o}(eui.Component);e.GameScreen=t,__reflect(t.prototype,"game.GameScreen")}(game||(game={}));var game;!function(e){var t=function(t){function o(){var o=t.call(this)||this;return o.skinName="skins.GuideGameProcessWindow",o.addEventListener(eui.UIEvent.CREATION_COMPLETE,o.createCompleteEvent,o),o.winJudgeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.ApplicationFacade.getInstance().sendNotification(e.SceneCommand.SHOW_GUIDE_WINJUDGE)},o),o}return __extends(o,t),o.prototype.createCompleteEvent=function(e){this.navigationBar.y=this.stage.stageHeight-this.navigationBar.height-10,this.contentScroller.height=this.stage.stageHeight-this.headGroup.height-this.navigationBar.height-20,this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.createCompleteEvent,this)},o.prototype.partAdded=function(e,o){t.prototype.partAdded.call(this,e,o)},o}(eui.Panel);e.GuideGameProcessWindow=t,__reflect(t.prototype,"game.GuideGameProcessWindow")}(game||(game={}));var game;!function(e){var t=function(t){function o(){var e=t.call(this)||this;return e.skinName="skins.GuideGameTermWindow",e.addEventListener(eui.UIEvent.CREATION_COMPLETE,e.createCompleteEvent,e),e}return __extends(o,t),o.prototype.createCompleteEvent=function(t){this.navigationBar.y=this.stage.stageHeight-this.navigationBar.height-10,this.contentScroller.height=this.stage.stageHeight-this.headGroup.height-this.navigationBar.height-20,this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.createCompleteEvent,this),e.ApplicationFacade.getInstance().registerMediator(new e.GuideGameTermWindowMediator(this))},o.prototype.partAdded=function(e,o){t.prototype.partAdded.call(this,e,o)},o}(eui.Panel);e.GuideGameTermWindow=t,__reflect(t.prototype,"game.GuideGameTermWindow")}(game||(game={}));var game;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.skinName="skins.GuideRoleSkillWindow",t.addEventListener(eui.UIEvent.CREATION_COMPLETE,t.createCompleteEvent,t),t}return __extends(t,e),t.prototype.createCompleteEvent=function(e){this.navigationBar.y=this.stage.stageHeight-this.navigationBar.height-10,this.contentScroller.height=this.stage.stageHeight-this.headGroup.height-this.navigationBar.height-20,this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.createCompleteEvent,this)},t.prototype.partAdded=function(t,o){e.prototype.partAdded.call(this,t,o)},t}(eui.Panel);e.GuideRoleSkillWindow=t,__reflect(t.prototype,"game.GuideRoleSkillWindow")}(game||(game={}));var game;!function(e){var t=function(t){function o(){var o=t.call(this)||this;return o.skinName="skins.GuideVideoWindow",o.addEventListener(eui.UIEvent.CREATION_COMPLETE,o.createCompleteEvent,o),o.btnVideo1.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){o.video&&o.video.destroy(),o.video=platform.playVideo(e.Constants.ResourceEndpoint+"resource/assets/guide/video1.mp4"),o.video.poster="resource/assets/guide/video1.png",o.video.x=15,o.video.y=50,o.video.requestFullScreen().then(function(){return o.video.play()}),o.video.onEnded(function(){o.video.destroy()})},o),o.btnVideo2.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){o.video&&o.video.destroy(),o.video=platform.playVideo(e.Constants.ResourceEndpoint+"resource/assets/guide/video2.mp4"),o.video.x=15,o.video.y=50,o.video.requestFullScreen().then(function(){return o.video.play()}),o.video.onEnded(function(){o.video.destroy()})},o),o.btnVideo3.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){o.video&&o.video.destroy(),o.video=platform.playVideo(e.Constants.ResourceEndpoint+"resource/assets/guide/video3.mp4"),o.video.poster="resource/assets/guide/video3.png",o.video.x=15,o.video.y=50,o.video.requestFullScreen().then(function(){return o.video.play()}),o.video.onEnded(function(){o.video.destroy()})},o),o.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){o.video&&o.video.destroy()},o),o}return __extends(o,t),o.prototype.onLoadErr=function(e){console.log("video load error happened")},o.prototype.createCompleteEvent=function(e){this.navigationBar.y=this.stage.stageHeight-this.navigationBar.height-10,this.contentScroller.height=this.stage.stageHeight-this.headGroup.height-this.navigationBar.height-20,this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.createCompleteEvent,this)},o.prototype.partAdded=function(e,o){t.prototype.partAdded.call(this,e,o)},o}(eui.Panel);e.GuideVideoWindow=t,__reflect(t.prototype,"game.GuideVideoWindow")}(game||(game={}));var game;!function(e){var t=function(t){function o(){var e=t.call(this)||this;return e.skinName="skins.GuideWindow",e.addEventListener(eui.UIEvent.CREATION_COMPLETE,e.createCompleteEvent,e),e}return __extends(o,t),o.prototype.createCompleteEvent=function(t){this.navigationBar.y=this.stage.stageHeight-this.navigationBar.height-10,this.contentScroller.height=this.stage.stageHeight-this.headGroup.height-this.navigationBar.height-20,this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.createCompleteEvent,this),e.ApplicationFacade.getInstance().registerMediator(new e.GuideWindowMediator(this))},o.prototype.partAdded=function(e,o){t.prototype.partAdded.call(this,e,o)},o}(eui.Panel);e.GuideWindow=t,__reflect(t.prototype,"game.GuideWindow")}(game||(game={}));var game;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.skinName="skins.GuideWinJudgeWindow",t.addEventListener(eui.UIEvent.CREATION_COMPLETE,t.createCompleteEvent,t),t}return __extends(t,e),t.prototype.createCompleteEvent=function(e){this.navigationBar.y=this.stage.stageHeight-this.navigationBar.height-10,this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.createCompleteEvent,this)},t.prototype.partAdded=function(t,o){e.prototype.partAdded.call(this,t,o)},t}(eui.Panel);e.GuideWinJudgeWindow=t,__reflect(t.prototype,"game.GuideWinJudgeWindow")}(game||(game={}));var game;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.skinName="skins.MoreGameWindow",t.addEventListener(eui.UIEvent.ADDED,t.createCompleteEvent,t),t.backButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.close,t),t.backItem1.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return t.viewMoreClick(0)},t),t.backItem2.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return t.viewMoreClick(1)},t),t}return __extends(t,e),t.prototype.createCompleteEvent=function(e){this.navigationBar.y=this.stage.stageHeight-this.navigationBar.height-10,this.contentScroller.height=this.stage.stageHeight-this.headGroup.height-this.navigationBar.height-20,this.removeEventListener(eui.UIEvent.ADDED,this.createCompleteEvent,this)},t.prototype.viewMoreClick=function(e){var t=["https://gdjzj.hzsdgames.com:8084/miniGame/resource/assets/start/qrcode-tk2048.jpg","https://gdjzj.hzsdgames.com:8084/miniGame/resource/assets/start/qrcode-img.jpg"];platform.showPreImage(t,e)},t.prototype.partAdded=function(t,o){e.prototype.partAdded.call(this,t,o)},t}(eui.Panel);e.MoreGameWindow=t,__reflect(t.prototype,"game.MoreGameWindow")}(game||(game={}));var game;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.skinName="skins.NoticeWindow",t.addEventListener(eui.UIEvent.ADDED,t.createCompleteEvent,t),t.backButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.close,t),t}return __extends(t,e),t.prototype.createCompleteEvent=function(e){this.navigationBar.y=this.stage.stageHeight-this.navigationBar.height-10,this.contentScroller.height=this.stage.stageHeight-this.headGroup.height-this.navigationBar.height-20,this.removeEventListener(eui.UIEvent.ADDED,this.createCompleteEvent,this)},t.prototype.partAdded=function(t,o){e.prototype.partAdded.call(this,t,o)},t}(eui.Panel);e.NoticeWindow=t,__reflect(t.prototype,"game.NoticeWindow")}(game||(game={}));var game;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.skinName="skins.PopupAppraisalWindow",t.addEventListener(eui.UIEvent.CREATION_COMPLETE,t.createCompleteEvent,t),t}return __extends(t,e),t.prototype.createCompleteEvent=function(e){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.createCompleteEvent,this)},t.prototype.setData=function(e){console.log(e),this.result={source:e[0].source,name:e[0].name,resultRes:"",resultLabel:""},this.result2=null,"真"==e[0].result?this.result.resultRes="true":"假"==e[0].result?this.result.resultRes="false":this.result.resultLabel=e[0].result,e.length>1&&(this.result2={source:e[1].source,name:e[1].name,resultRes:"",resultLabel:""},"真"==e[1].result?this.result2.resultRes="true":"假"==e[1].result?this.result2.resultRes="false":this.result2.resultLabel=e[1].result)},t.prototype.partAdded=function(t,o){e.prototype.partAdded.call(this,t,o)},t}(e.BasePanel);e.PopupAppraisalWindow=t,__reflect(t.prototype,"game.PopupAppraisalWindow")}(game||(game={}));var game;!function(e){var t=function(t){function o(){var e=t.call(this)||this;return e.skinName="skins.PopupFangWindow",e.addEventListener(eui.UIEvent.CREATION_COMPLETE,e.createCompleteEvent,e),e}return __extends(o,t),o.prototype.createCompleteEvent=function(t){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.createCompleteEvent,this),e.ApplicationFacade.getInstance().registerMediator(new e.PopupFangWindowMediator(this))},o.prototype.setSeat=function(e){this.seatNum=e},o.prototype.partAdded=function(e,o){t.prototype.partAdded.call(this,e,o)},o}(e.BasePanel);e.PopupFangWindow=t,__reflect(t.prototype,"game.PopupFangWindow")}(game||(game={}));var game;!function(e){var t=function(t){function o(){var e=t.call(this)||this;return e.skinName="skins.PopupGameInfoWindow",e.addEventListener(eui.UIEvent.CREATION_COMPLETE,e.createCompleteEvent,e),e}return __extends(o,t),o.prototype.createCompleteEvent=function(t){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.createCompleteEvent,this),e.ApplicationFacade.getInstance().registerMediator(new e.PopupGameInfoWindowMediator(this))},o.prototype.partAdded=function(e,o){t.prototype.partAdded.call(this,e,o)},o}(e.BasePanel);e.PopupGameInfoWindow=t,__reflect(t.prototype,"game.PopupGameInfoWindow")}(game||(game={}));var game;!function(e){var t=function(t){function o(){var e=t.call(this)||this;return e.skinName="skins.PopupHandleWindow",e.addEventListener(eui.UIEvent.CREATION_COMPLETE,e.createCompleteEvent,e),e}return __extends(o,t),o.prototype.createCompleteEvent=function(t){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.createCompleteEvent,this),e.ApplicationFacade.getInstance().registerMediator(new e.PopupHandleWindowMediator(this))},o.prototype.setMessage=function(e){this.message=e?"确定要退出游戏么？":null,this.isCreate=e?!1:!0},o.prototype.partAdded=function(e,o){t.prototype.partAdded.call(this,e,o)},o.prototype.onCloseButtonClick=function(e){t.prototype.onCloseButtonClick.call(this,e),platform.hideAllBannerAds()},o}(e.BasePanel);e.PopupHandleWindow=t,__reflect(t.prototype,"game.PopupHandleWindow")}(game||(game={}));var game;!function(e){var t=function(t){function o(){var e=t.call(this)||this;return e.roomName="",e.showText=!0,e.skinName="skins.PopupNumberKeyboard",e.addEventListener(eui.UIEvent.CREATION_COMPLETE,e.createCompleteEvent,e),e}return __extends(o,t),o.prototype.createCompleteEvent=function(t){this.height=this.stage.stageHeight,this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.createCompleteEvent,this),e.ApplicationFacade.getInstance().registerMediator(new e.PopupNumberKeyboardMediator(this))},o.prototype.show=function(){this.container.bottom=-600,this.container.visible=!0,egret.Tween.get(this.container).to({bottom:0},300)},o.prototype.partAdded=function(e,o){t.prototype.partAdded.call(this,e,o)},o}(e.BasePanel);e.PopupNumberKeyboard=t,__reflect(t.prototype,"game.PopupNumberKeyboard")}(game||(game={}));var game;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.skinName="skins.PopupPromptWindow",t.addEventListener(eui.UIEvent.CREATION_COMPLETE,t.createCompleteEvent,t),t}return __extends(t,e),t.prototype.createCompleteEvent=function(e){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.createCompleteEvent,this)},t.prototype.setMessage=function(e){this.message=e,this.isStart=e?!1:!0},t.prototype.partAdded=function(t,o){e.prototype.partAdded.call(this,t,o)},t}(e.BasePanel);e.PopupPromptWindow=t,__reflect(t.prototype,"game.PopupPromptWindow")}(game||(game={}));var game;!function(e){var t=function(t){function o(){var e=t.call(this)||this;return e.skinName="skins.PopupRoleWindow",e.addEventListener(eui.UIEvent.CREATION_COMPLETE,e.createCompleteEvent,e),e}return __extends(o,t),o.prototype.createCompleteEvent=function(t){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.createCompleteEvent,this),e.ApplicationFacade.getInstance().registerMediator(new e.PopupRoleWindowMediator(this))},o.prototype.setRole=function(e){this.roleId=e},o.prototype.partAdded=function(e,o){t.prototype.partAdded.call(this,e,o)},o}(e.BasePanel);e.PopupRoleWindow=t,__reflect(t.prototype,"game.PopupRoleWindow")}(game||(game={}));var game;!function(e){var t=function(t){function o(){var e=t.call(this)||this;return e.skinName="skins.PopupRoundWindow",e.addEventListener(eui.UIEvent.CREATION_COMPLETE,e.createCompleteEvent,e),e}return __extends(o,t),o.prototype.createCompleteEvent=function(t){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.createCompleteEvent,this),e.ApplicationFacade.getInstance().registerMediator(new e.PopupRoundWindowMediator(this))},o.prototype.partAdded=function(e,o){t.prototype.partAdded.call(this,e,o)},o}(e.BasePanel);e.PopupRoundWindow=t,__reflect(t.prototype,"game.PopupRoundWindow")}(game||(game={}));var game;!function(e){var t=function(t){function o(){var e=t.call(this)||this;return e.skinName="skins.PopupVoteRecordWindow",e.addEventListener(eui.UIEvent.CREATION_COMPLETE,e.createCompleteEvent,e),e}return __extends(o,t),o.prototype.createCompleteEvent=function(t){this.navigationBar.y=this.stage.stageHeight-this.navigationBar.height-10,this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.createCompleteEvent,this),e.ApplicationFacade.getInstance().registerMediator(new e.PopupVoteRecordWindowMediator(this))},o.prototype.partAdded=function(e,o){t.prototype.partAdded.call(this,e,o)},o}(eui.Panel);e.PopupVoteRecordWindow=t,__reflect(t.prototype,"game.PopupVoteRecordWindow")}(game||(game={}));var game;!function(e){var t=function(t){function o(){var e=t.call(this)||this;return e.skinName="skins.PopupVoteResultWindow",e.addEventListener(eui.UIEvent.CREATION_COMPLETE,e.createCompleteEvent,e),e}return __extends(o,t),o.prototype.createCompleteEvent=function(t){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.createCompleteEvent,this),e.ApplicationFacade.getInstance().registerMediator(new e.PopupVoteResultWindowMediator(this))},o.prototype.partAdded=function(e,o){t.prototype.partAdded.call(this,e,o)},o}(e.BasePanel);e.PopupVoteResultWindow=t,__reflect(t.prototype,"game.PopupVoteResultWindow")}(game||(game={}));var game;!function(e){var t=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onCloseButtonClick=function(e){this.parent&&this.parent.close()},t}(eui.Panel);e.PopupWindowWrapper=t,__reflect(t.prototype,"game.PopupWindowWrapper")}(game||(game={}));var game;!function(e){var t=function(t){function o(){var e=t.call(this)||this;return e.skinName="skins.RankListItemRenderer",e}return __extends(o,t),o.prototype.createChildren=function(){t.prototype.createChildren.call(this)},o.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data.key>3?(this.isNotTopThree=!0,this.rankRes=null):(this.isNotTopThree=!1,this.rankRes="rank"+this.data.key),this.data.OrderType==e.OrderType.winRate?(this.col1=this.data.winRate+"%",this.col2=this.data.countTotal+"场"):(this.col2=this.data.winRate+"%",this.col1=this.data.countTotal+"场")},o}(eui.ItemRenderer);e.RankListItemRenderer=t,__reflect(t.prototype,"game.RankListItemRenderer")}(game||(game={}));var game;!function(e){var t=function(t){function o(){var e=t.call(this)||this;return e.skinName="skins.RankWindow",e.addEventListener(eui.UIEvent.ADDED,e.createCompleteEvent,e),e}return __extends(o,t),o.prototype.createCompleteEvent=function(t){this.navigationBar.y=this.stage.stageHeight-this.navigationBar.height-10,this.contentScroller.height=this.stage.stageHeight-this.headGroup.height-this.navigationBar.height-20,this.removeEventListener(eui.UIEvent.ADDED,this.createCompleteEvent,this),e.ApplicationFacade.getInstance().registerMediator(new e.RankWindowMediator(this))},o.prototype.partAdded=function(e,o){t.prototype.partAdded.call(this,e,o)},o}(eui.Panel);e.RankWindow=t,__reflect(t.prototype,"game.RankWindow")}(game||(game={}));var game;!function(e){var t=function(t){function o(){var e=t.call(this)||this;return e.skinName="skins.ResultWindow",e.addEventListener(eui.UIEvent.CREATION_COMPLETE,e.createCompleteEvent,e),e}return __extends(o,t),o.prototype.createCompleteEvent=function(t){this.navigationBar.y=this.stage.stageHeight-this.navigationBar.height-50,this.contentScroller.height=this.stage.stageHeight-this.navigationBar.height-100,this.borderBg.height=this.stage.stageHeight+40,this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.createCompleteEvent,this),e.ApplicationFacade.getInstance().registerMediator(new e.ResultWindowMediator(this))},o.prototype.partAdded=function(e,o){t.prototype.partAdded.call(this,e,o)},o}(eui.Panel);e.ResultWindow=t,__reflect(t.prototype,"game.ResultWindow")}(game||(game={}));var game;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.skinName="skins.RoleItemRenderer",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this)},t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this)},t}(eui.ItemRenderer);e.RoleItemRenderer=t,__reflect(t.prototype,"game.RoleItemRenderer")}(game||(game={}));var game;!function(e){var t=function(t){function o(){var e=t.call(this)||this;return e.skinName="skins.SettingWindow",e.addEventListener(eui.UIEvent.ADDED,e.createCompleteEvent,e),e}return __extends(o,t),o.prototype.createCompleteEvent=function(t){this.navigationBar.y=this.stage.stageHeight-this.navigationBar.height-10,this.removeEventListener(eui.UIEvent.ADDED,this.createCompleteEvent,this),e.ApplicationFacade.getInstance().registerMediator(new e.SettingWindowMediator(this))},o.prototype.partAdded=function(e,o){t.prototype.partAdded.call(this,e,o)},o}(eui.Panel);e.SettingWindow=t,__reflect(t.prototype,"game.SettingWindow")}(game||(game={}));var game;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.skinName="skins.Shade",t.addEventListener(eui.UIEvent.ADDED_TO_STAGE,t.createCompleteEvent,t),t}return __extends(t,e),t.prototype.childrenCreated=function(){this.rect.x=this.rect.y=0,this.rect.width=egret.lifecycle.stage.stageWidth,this.rect.height=egret.lifecycle.stage.stageHeight,this.removeEventListener(eui.UIEvent.ADDED_TO_STAGE,this.createCompleteEvent,this)},t.prototype.createCompleteEvent=function(e){},t.addMask=function(e){var t=new eui.Group;t.touchEnabled=!0,t.verticalCenter=0;var o=egret.lifecycle.stage,i=new eui.Rect(o.stageWidth,o.stageHeight,0);i.x=0,i.y=0,i.alpha=.8,t.addChild(i),e.addChildAt(t,0)},t}(eui.Component);e.Shade=t,__reflect(t.prototype,"game.Shade")}(game||(game={}));var game;!function(e){var t=function(t){function o(){var e=t.call(this)||this;return e.nickName="",e.avatarUrl="btn-share",e.isDebugPlatform=!1,e.isWxPlatform=!0,e.isNativePlatform=!1,e.roomNum="",e.skinName="skins.StartScreen",e.addEventListener(eui.UIEvent.ADDED,e.createCompleteEvent,e),e}return __extends(o,t),o.prototype.createCompleteEvent=function(t){this.navigationBar.y=this.stage.stageHeight-this.navigationBar.height-10,this.contentScroller.height=this.stage.stageHeight-this.navigationBar.height-this.headGroup.height-40,this.removeEventListener(eui.UIEvent.ADDED,this.createCompleteEvent,this),e.ApplicationFacade.getInstance().registerMediator(new e.StartScreenMediator(this))},o.prototype.partAdded=function(e,o){t.prototype.partAdded.call(this,e,o)},o}(eui.Component);e.StartScreen=t,__reflect(t.prototype,"game.StartScreen")}(game||(game={}));var game;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.skinName="skins.TermItemRenderer",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this)},t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this)},t}(eui.ItemRenderer);e.TermItemRenderer=t,__reflect(t.prototype,"game.TermItemRenderer")}(game||(game={}));var game;!function(e){var t=function(t){function o(){var e=t.call(this)||this;return e.skinName="skins.UserInfoWindow",e.addEventListener(eui.UIEvent.ADDED,e.createCompleteEvent,e),e}return __extends(o,t),o.prototype.createCompleteEvent=function(t){this.navigationBar.y=this.stage.stageHeight-this.navigationBar.height-10,this.content.height=this.stage.stageHeight-this.navigationBar.height-this.headGroup.height-15,this.removeEventListener(eui.UIEvent.ADDED,this.createCompleteEvent,this),e.ApplicationFacade.getInstance().registerMediator(new e.UserInfoWindowMediator(this))},o.prototype.partAdded=function(e,o){t.prototype.partAdded.call(this,e,o)},o}(eui.Panel);e.UserInfoWindow=t,__reflect(t.prototype,"game.UserInfoWindow")}(game||(game={}));var game;!function(e){var t=function(t){function o(){var e=t.call(this)||this;return e.skinName="skins.VoteAntiquesRenderer",e}return __extends(o,t),o.prototype.createChildren=function(){t.prototype.createChildren.call(this)},o.prototype.dataChanged=function(){this.voteDetail.dataProvider=new eui.ArrayCollection(this.data.voteDetail),this.voteDetail.itemRenderer=e.VoteNumRenderer,t.prototype.dataChanged.call(this)},o}(eui.ItemRenderer);e.VoteAntiquesRenderer=t,__reflect(t.prototype,"game.VoteAntiquesRenderer")}(game||(game={}));var game;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.skinName="skins.VoteNumRenderer",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this)},t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this)},t}(eui.ItemRenderer);e.VoteNumRenderer=t,__reflect(t.prototype,"game.VoteNumRenderer")}(game||(game={}));var game;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.skinName="skins.VotePeopleRenderer",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this)},t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this)},t}(eui.ItemRenderer);e.VotePeopleRenderer=t,__reflect(t.prototype,"game.VotePeopleRenderer")}(game||(game={}));